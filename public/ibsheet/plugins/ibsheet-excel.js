/**
 * 제 품: IBSheet8 - Excel Plugin
 * 버 전: v0.0.10-DEV.1 (20220318-1131)
 * 회 사: (주)아이비리더스
 * 주 소: https://www.ibsheet.com
 * 전 화: (02) 2621-2288~9
 */
Q1pp[370798]=(function(){var D=2;for(;D !== 9;){switch(D){case 2:D=typeof globalThis === '\x6f\x62\x6a\x65\x63\u0074'?1:5;break;case 1:return globalThis;break;case 5:var Q;try{var V=2;for(;V !== 6;){switch(V){case 3:throw "";V=9;break;case 9:delete Q['\x5f\x47\u004e\u006a\u0039'];var l=Object['\x70\x72\u006f\x74\u006f\u0074\u0079\x70\x65'];delete l['\u0062\x35\u0059\x54\x6d'];V=6;break;case 4:V=typeof _GNj9 === '\u0075\u006e\u0064\x65\u0066\x69\u006e\x65\u0064'?3:9;break;case 2:Object['\u0064\x65\x66\x69\u006e\x65\u0050\x72\u006f\u0070\u0065\x72\x74\u0079'](Object['\x70\x72\u006f\u0074\u006f\x74\x79\x70\x65'],'\u0062\u0035\x59\x54\x6d',{'\x67\x65\x74':function(){var o=2;for(;o !== 1;){switch(o){case 2:return this;break;}}},'\x63\x6f\x6e\x66\x69\x67\x75\x72\x61\x62\x6c\x65':true});Q=b5YTm;Q['\u005f\x47\u004e\x6a\u0039']=Q;V=4;break;}}}catch(M){Q=window;}return Q;break;}}})();Q1pp[416124]=102;Q1pp[370798].w9uu=Q1pp;Q1pp[588937]="Yky";Q1pp[415206]=333;Q1pp[323110]="XcD";Q1pp[610015]="xk4";Q1pp[570163]=Q1pp[370798];Q1pp[17341]=Q1pp[370798];Q1pp[37932]="F4s";function Q1pp(){}!(function(o,V){var u3t="InvalidTextFileExtension";var f3Q="IBSheetLoadExcelFrame";var E9Q="getTheme";var S8t="_Span";var h9Q="getRHeight";var m5t="Html";var j6Q="setLoadExcelUrl";var B5t="DirectDown2Excel";var J9t="#008080";var Z3Q=", ";var f0t="width:0px;";var v9Q="GetOrgType";var P7t="RowHeights";var i3t="message";var w1Q="YmdFormat";var K3t="#c0c0c0";var k3t="^";var l6Q="GetColIndexInfo";var v5t="Down2Pdf";var N4t="toLower";var f9Q="CutText";var j3t="=";var p3Q="LoadText.jsp";var v6Q="SetDown2PdfUrl";var N6t=" ";var G0t="body";var b1t=1;var j8t="Type";var u9Q="GetStatusValue";var k9t=/^\s+/;var z2Q="SetLoadTextConfig";var c9t="div";var Q2t="SaveName";var C6Q="setLoadExcelConfig";var T1t=16;var u6t="DataFormat";var f6Q="down2Pdf";var o4t="portrait";var y6t="1";var F3t="TEXT";var R5t="Pass";var r2t="FileName";var l2t="RecordType";var v2t="_GroupTree";var C3t="#808080";var f2t="FormulaRow";var A9Q="GetHeaderBackColor";var e9t="\n";var m3Q="file";var K8t="Combo";var N3t="";var T6t="Mode";var a3t="ibexcel";var B6t="DateStrictMode";var K9Q="GetDataRowHeight";var a2t="/";var J6Q="LoadExcelBuffer";var v1t=4;var l3t=100;var S2t="OrgCol";var S9t="//";var J0t=";";var i6Q="GetDown2ExcelConfig";var H5t="input";var C6t="UserSaveName";var d5t="DateFormat";var X0t="display:none;";var T9Q="getSheetFontName";var v3t="U";var P6Q="loadExcelBuffer";var y6Q="loadText";var H9Q="getExcelRowHeight";var J2t="DirectLoadExcel.jsp";var B9t="string";var t6t="UnMatchColHidden";var e0t="undefined";var s0t=" !important }</style>";var f6t="center";var x2t="BaseDir";var u6Q="GetDown2HmlUrl";var Z8t="Float";var w5t="Format";var Q9t="#800000";var v6t="ExtendParam";var I7t="RecordTypes";var Y6Q="getLoadTextUrl";var m6Q="SetDown2TextUrl";var f5t="Date";var p6Q="GetDown2ExcelUrl";var q9Q="txt";var n9t="0";var A3Q="ExceedFileSize";var O9Q="getFirstColA";var Y9t='"';var z5t="SEQ";var X1Q="YmdHmFormat";var R2t="LoadExcelUrl";var H6Q="setDown2HmlUrl";var e6t="StartCol";var d2t="Background";var k6Q="down2Text";var l1Q="1|";var H6t="EndRow";var i6t="WorkSheetName";var y9Q="FillRight";var d6Q="down2Hml";var v4t="fontTo";var n2t="LoadExcelError";var I5t="Filter";var D6Q="GetAutoSumPosition";var M9t="#800080";var R6t="*";var R0t="html";var z0t="className";var a6t="HeaderRows";var f9t=",";var p4t="forEach";var Y3Q="MB";var a9Q="getStatusValue";var f4t="pdf";var N3Q="columnTag";var E9t="function";var r5t="post";var N0t="head";var p5t="H";var l6t="return ";var Z6Q="setDown2TextUrl";var C5t="0px";var V9t="#008000";var x3t="#ffffff";var L6Q="GetDown2TextUrl";var j4t="ibsheet";var P3t="[ibsheet-excel] undefined global object: IBSheet";var z6Q="down2ExcelBuffer";var F9Q="getOrgType";var n7t="DownHeader";var u5t="form";var c4t="isArray";var N2t="Status";var G2t="SubSum";var s6t="\r\n";var W3t="0.0.10-20220318-1131-DEV-1";var o3Q="OrgTextHidden";var n6Q="LoadFile";var b9Q="getSumBackColor";var d0t="CollapseLeft";var j6t="|";var R1Q="MdFormat";var J3t=null;var O6Q="getDown2TextUrl";var q9t="#000080";var M5t="TitleAlign";var H1t=10;var o2t="Merge";var G9t="object";var s4t="keys";var Q6t=/^[^\<\{]*\{/;var N8t="Panel";var h6Q="setDown2ExcelConfig";var z1Q="center|";var q5t="LegacyFormat";var I9t="#ffff00";var w6Q="directLoadExcel";var H3t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var u2t="downloadTokenValue";var l0t="<";var s2t="C";var b8t="Header";var r0t="ANY";var w9t="#0000ff";var m3t="IBSheetLoadTextFileFinder";var q6Q="down2Excel";var V9Q="csv";var U2t="Span";var i5t="?";var n3Q="LoadExcel";var Q6Q="getColName";var o0t="dir";var t3t="InvalidExcelFileExtension";var b5t="Down2Excel";var x5t="SheetWork=";var W1t=8;var s5t="Bool";var Q3Q="_ConstWidth";var w7t="RecordOrgFormats";var R4t="set";var G8t="left";var c6Q="SetDown2ExcelUrl";var l9t="#ff0000";var j9Q="doSearchScript";var o2Q="getLoadTextConfig";var r9Q="getSheetFontSize";var r4t="extendParam";var I2t="ServerFile";var G6Q="getDown2ExcelUrl";var S0t='<style type="text/css">* { font-family: ';var G7t="CumulateRow";var V7t="ColAlign";var B6Q="SetLoadTextUrl";var M2t="RecordFormat";var d3Q="LoadText";var F1t=5;var p1Q="HmFormat";var a8t="LegacyType";var m9Q="GetNextColA";var P9Q="ColLength";var u8t="Int";var F6Q="setDown2PdfUrl";var d9t="#";var U4t="map";var d4t="has";var R6Q="loadExcel";var S6Q="GetLoadExcelUrl";var N6Q="SetLoadExcelUrl";var S5t="HH:mm:ss";var a6Q="getDown2HmlUrl";var q0t='="';var a5t="POST";var k6t="ExportFile";var l5t="TitleText";var g3t="#fffffe";var F6t="MaxCols";var k2t="SheetID";var Q4t="none";var t6Q="GetDown2PdfUrl";var x9Q="GetSheetFontSize";var y1Q="YmdHmsFormat";var T3t="onmessage";var Q0t="Malgun Gothic";var L6t="||";var K6Q="SetLoadExcelConfig";var x6Q="GetLoadExcelConfig";var E6t="SearchMode";var V0t="attrs";var t5t="Down2Text";var k0t="<br>";var o6Q="Down2ExcelBuffer";var J1Q="YmFormat";var B9Q="GetSumBackColor";var w9Q="Deli";var g6Q="loadExcelError";var W9Q="GetExcelRowHeight";var y0t="gi";var b6t="Append";var q7t="RecordFormats";var l4t="blob";var g9Q="GetColName";var k5t="Radio";var E5t="PDF";var P2t="LoadExcel.jsp";var q2t="SkipEmptyRow";var Y6t="HeaderMatch";var N9Q="DoSearchScript";var O8t="Visible";var z2t="UseJsonAttribute";var B1t=0;var e9Q="GetRHeight";var D0t="</";var E1t=3;var P0t="<br/>";var L9Q="GetFirstColA";var p2t="Color";var Y9Q="getHeaderBackColor";var D4t="a";var g9t="{";var W6Q="SetDown2HmlUrl";var V6Q="getAutoSumPosition";var J9Q="Encoding";var c3Q="IBSheetLoadTextFrame";var T5t="&";var C4t="debugMode";var V6t="-";var o6t=".";var X6Q="loadFile";var R9Q="ColLength2Byte";var g6t="HeaderText";var j2t="DelCheck";var M6Q="getColIndexInfo";var t9Q="GetTheme";var U6Q="setDown2ExcelUrl";var m6t="xlsx";var p9t="[object Array]";var p0t="ExpandLeft";var T6Q="getDown2ExcelConfig";var s6Q="getLoadExcelUrl";var k9Q="EmptyChar";var o9t="#00ff00";var y9t=/\s+$/;var c8t="isNumeric";var y5t="Enum";var W6t="StartRow";var G4t="isString";var h4t="Url";var X2t="Data";var b3t="EXCEL";var X6t="Sheet";var J5t="HML";var I2Q="setLoadTextConfig";var C9t="}";var M7t="WordWrap";var y3Q="DirectLoadExcel";var V2Q="GetLoadTextConfig";var D2Q="setDown2TextConfig";var Z6t="fileDownloadToken";var u9t="boolean";var j5t="Img";var v9t="number";var O3t="IBSheetLoadExcelFileFinder";var h5t="get";var D2t="DatePattern";var c2t="RowSpan";var r6t="ColumnMapping";var D9t="#ff00ff";var I6Q="directDown2Excel";var l2Q="getDown2TextConfig";var b6Q="setLoadTextUrl";var J7t="ColWidths";var O5t="Link";var h6t="WorkSheetNo";var P9t="#00ffff";var K5t="iframe";function w(L){var G3t='"Message":';var n3t=/(Result( )?:)/;var Z3t="IBSheetLoadExcelShowProcessDlg";var B3t="IBSheetLoadFileExtError";var Y3t="IBSheetLoadFileSelect";var s3t="\\$1";var p3t=/(Message( )?:)/;var A3t="UploadFile";var X3t='"Result":';var U3t='"data":[[';var L3t="IBSheetOnLoadFullExcel";var c3t=/(data( )?:( )?\[\[)/;var S3t="\\\\t";var y3t="IBSheetOnLoadExcel";var d3t='"Code":';var f3t=/(Code( )?:)/;try{var G,s,N,X=L.data.split(R3t),n=X[B1t].split(k3t),d={};if(o[n[b1t]].HasLoadedExcelData)return !b1t;if((F1t == n.length && (X[b1t]=o[n[b1t]].ConvertAscNumbertoChar(X[b1t])),F1t == n.length && y3t == n[B1t]))return ((G=JSON.parse(X[b1t].replace(n3t,X3t).replace(f3t,d3t).replace(p3t,G3t).replace(c3t,U3t).replace(/	/g,S3t).replace(/\\(n|'|"|&|r|t|b|f)?/g,s3t).replace(/([\u0000-\u0019]+)/g,N3t).replace(/([\u001A-\u001F]+)/g,N3t)).data).length && b1t === G.length && G[B1t].length && (G=G[B1t]),N=t1t == (s=n[v1t].split(j3t)).length?IBSheet[n[b1t]]._getBooleanValue(s[b1t],B1t):N3t,d.append=N,o[n[b1t]].CheckLoadExcel=n[E1t],void o[n[b1t]].loadSearchData({data:G,append:d.append}));(F1t == n.length && L3t == n[B1t] && (N=t1t == (s=n[v1t].split(j3t)).length?IBSheet[n[b1t]]._getBooleanValue(s[b1t],B1t):N3t,X[b1t],d.type=n[E1t],d.append=N,d.dialogType=IBSheet[n[b1t]]._uploadDialogLoadType,IBSheet[n[b1t]].hideMessage(),IBSheet[n[b1t]].uploadDialogLoad && IBSheet[n[b1t]].uploadDialogLoad(X[b1t],d)),b1t == n.length && (O3t == n[B1t] || m3t == n[B1t]?V.getElementById(n[B1t]).click():Z3t == n[B1t] && this.showMessage(this.getMessage(A3t))),E1t == n.length && (Y3t == n[B1t]?IBSheet.OnLoadFileSelect && IBSheet.OnLoadFileSelect(IBSheet[n[t1t]],n[b1t],X[b1t]):B3t == n[B1t] && (b3t == n[b1t]?IBSheet[n[t1t]].ShowAlert(IBSheet[n[t1t]].getMessage(t3t,E3t),v3t):F3t == n[b1t] && IBSheet[n[t1t]].ShowAlert(IBSheet[n[t1t]].getMessage(u3t,E3t),v3t))));}catch(O){}}var i9Q="GetSheetFontName";var M2Q="SetDown2TextConfig";var e5t="hidden";var W5t="multipart/form-data";var Z9Q="getNextColA";var s8t="Index";var d1Q="HmsFormat";var y2t="UseDOM";var c0t="Baekmuk Gulim";var n5t="EnumKeys";var V3t=1024;var A6t="float";var t1t=2;var r6Q="getLoadExcelConfig";var w2t="WorkbookPassword";var e6Q="SetDown2ExcelConfig";var F2t="Foot";var n0t="&#160;";var I0t="class";var R3t="";var z9Q="\t";var M0t=">";var x6t="StatusCol";var A6Q="GetLoadTextUrl";var K6t="SaveNames";var i3Q="Down2Hml";var r3t="#000000";var E6Q="getDown2PdfUrl";var E3t="Alert";var S4t="includes";var j0t='lang="ko"';var V2t="IBSheetID";var z9t="#808000";var U8t="_RowSpan";var Q2Q="GetDown2TextConfig";var e4t="url";var A5t="Text";var C9Q="getDataRowHeight";var Q=o.IBSheet;if(J3t == Q)throw new Error(P3t);var z,q,J,P,M=Q.Plugins;(M.PluginVers || (M.PluginVers={}),M.PluginVers.ibexcel={name:a3t,version:W3t},z=H3t,o.btoa=o.btoa || (function(Z){var C1t=63;var i1t=15;var e3t=/[^\x00-\xFF]/;var h3t="InvalidCharacterError";var g1t=64;var u1t=6;Z=String(Z);var E,F,B,A,Y=B1t,b=[];if(e3t.test(Z))throw new Error(h3t);for(;Y < Z.length;)(F=(E1t & (E=Z.charCodeAt(Y++))) << v1t | (A=Z.charCodeAt(Y++)) >> v1t,B=(i1t & A) << t1t | (A=Z.charCodeAt(Y++)) >> u1t,A=C1t & A,Y === Z.length + t1t?A=B=g1t:Y === Z.length + b1t && (A=g1t),b.push(z.charAt(E >> t1t),z.charAt(F),z.charAt(B),z.charAt(A)));return b.join(N3t);}),o.addEventListener?o.addEventListener(i3t,w,!b1t):o.attachEvent && o.attachEvent(T3t,w),M.GetFnLib=function(u){return Q.__[u] || void B1t;},Q.g_isDown2ExcelBuffer=!b1t,Q.g_down2ExcelBuffer=N3t,Q.g_isDirectDown2Excel=!b1t,Q.g_isLoadExcelBuffer=!b1t,Q.g_isDirectLoadExcel=!b1t,Q.g_targetExcelSheetID=N3t,Q.g_LoadExcelSheetID=[],Q.g_LoadExcelBuffer=[],Q.g_LoadExcelBufferExt=N3t,Q.g_targetTextSheetID=N3t,Q.g_Multipart=!B1t,Q._ibsUtil=(q={},J={transparent:x3t,black:r3t,silver:K3t,gray:C3t,white:g3t,maroon:Q9t,red:l9t,purple:M9t,fuchsia:D9t,green:V9t,lime:o9t,olive:z9t,yellow:I9t,navy:q9t,blue:w9t,teal:J9t,aqua:P9t},({init:function(){var R9t="init";return ((this.elem.parent=this).delProperty(this,R9t),this);},trim:function(W){return W=(W+=N3t).replace(k9t,N3t).replace(y9t,N3t);},delProperty:function(K,g){try{delete K[g];}catch(Q1){K[g]=void B1t;}},isEmpty:function(l1){return l1 || B1t === l1?B1t:b1t;},isZero:function(M1){return B1t !== M1 && n9t !== M1?B1t:b1t;},isNumberValue:function(D1){var V1=B1t;return (D1=this.trim(D1),this.isEmpty(D1)?V1=B1t:+D1 + N3t != D1 + N3t && isNaN(+D1) || (V1=b1t),V1);},getCacheGroup:function(z1){return (void B1t === q[z1] && (q[z1]={}),q[z1]);},getCache:function(q1,w1){var I1=N3t;return I1=this.isEmpty(q1) || this.isEmpty(w1)?I1:this.getCacheGroup(q1)[w1];},setCache:function(J1,P1,R1){this.isEmpty(J1) || this.isEmpty(P1) || this.isEmpty(R1) || (this.getCacheGroup(J1)[P1]=R1);},padLeft:function(y1,d1,n1){var X1=B1t,k1=N3t,f1=(k1=y1=this.isEmpty(y1)?N3t:y1 + N3t).length;if(this.isEmpty(n1))return y1;for((n1=(n1 + N3t).substring(B1t,b1t),X1=f1);X1 < d1;X1++)k1=n1 + k1;return k1;},padRight:function(G1,N1,c1){var U1=B1t,S1=N3t,s1=(S1=G1=this.isEmpty(G1)?N3t:G1 + N3t).length;if(this.isEmpty(c1))return G1;for((c1=(c1 + N3t).substring(B1t,b1t),U1=s1);U1 < N1;U1++)S1+=c1;return S1;},getWebColor:function(Y1,O1){var a1t=7;var X9t="WebColors";var L1=-b1t,j1=Y1,m1=B1t,Z1=B1t,A1=B1t;return O1 && N3t === j1?N3t:void B1t !== (O1=this.getCache(X9t,Y1))?O1:(j1=(j1 + N3t).toLowerCase(),J[j1]?L1=J[j1]:(B1t < j1.indexOf(f9t)?E1t <= (j1=(j1=j1.replace(/[^\d\,\-]/g,N3t)).split(f9t)).length && (m1=+j1[B1t],Z1=+j1[b1t],A1=+j1[t1t],L1=isNaN(m1) || isNaN(Z1) || isNaN(A1)?-b1t:(L1=d9t,(L1=(L1+=this.padLeft(m1.toString(T1t),t1t,n9t)) + this.padLeft(Z1.toString(T1t),t1t,n9t)) + this.padLeft(A1.toString(T1t),t1t,n9t))):d9t === j1.charAt(B1t)?L1=j1:j1.search(/[^0-9a-f]/gi) < B1t && (L1=d9t + j1),-b1t !== L1 && v1t !== (O1=L1.length) && a1t !== O1 && (L1=-b1t)),this.setCache(X9t,Y1,L1),L1);},elem:{setValue:function(B1,b1){void B1t !== B1 && (void B1t !== B1.value?B1.value=b1:void B1t !== B1.textContent?B1.textContent=b1:B1.innerText=b1);},select:function(t1){var o3t=9999;t1 && (Q.BIPAD && !Q.BAndroid?t1.setSelectionRange(B1t,o3t):t1.select());}},isArray:function(E1){return Array.isArray?Array.isArray(E1):p9t === Object.prototype.toString.call(E1);},distinctArray:function(F1){var H1,v1=B1t,u1=N3t,a1={},W1=[];if(!this.isArray(F1))return F1;for((v1=B1t,H1=F1.length);v1 < H1;v1++)a1[u1=this.isArray(F1[v1])?F1[v1].join(k3t):F1[v1]] || (a1[u1]=b1t,W1.push(F1[v1]));return W1;},cloneArray:function(i1){var h1,T1=this.isArray(i1)?[]:{};for(h1 in i1)i1[h1] && G9t == typeof i1[h1]?T1[h1]=this.cloneArray(i1[h1]):T1[h1]=i1[h1];return T1;},getFullPath:function(K1){var U9t="<a></a>";var x1=V.createElement(c9t);return (x1.innerHTML=U9t,x1.firstChild.href=K1,x1.innerHTML=x1.innerHTML,x1.firstChild.href);},getDomain:function(){var C1=V.location,g1=N3t;return (g1+=C1.protocol + S9t) + C1.host;},escapeRegExp:function(l3){var s9t="\\$&";var Q3=N3t;return Q3=this.isEmpty(l3)?Q3:(l3 + N3t).replace(/[\^\$\.\*\+\?\=\!\:\|\\\/\(\)\[\]\{\}\/]/g,s9t);},jsonStringify:function(o3){var N9t="\\b";var j9t="\\t";var L9t="\\n";var m9t="\\r";var O9t="\\f";var A9t="\\\\";var Z9t='\\"';var M3,D3=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,V3={"\b":N9t,"\t":j9t,"\n":L9t,"\f":O9t,"\r":m9t,'"':Z9t,"\\":A9t};return (function z3(k3,X3){var W9t="[\n";function n3(f3){return (D3.lastIndex=B1t,D3.test(f3)?Y9t + f3.replace(D3,function(p3){var t9t="0000";var b9t="\\u";var d3=V3[p3];return B9t == typeof d3?d3:b9t + (t9t + p3.charCodeAt(B1t).toString(T1t)).slice(-v1t);}) + Y9t:Y9t + f3 + Y9t);}var H9t=",\n";var x9t=":";var T9t=": ";var K9t="{\n";var a9t="[]";var r9t="{}";var h9t="]";var i9t="[";var F9t="null";var J3,R3,w3,y3,q3,P3=M3,I3=X3[k3];switch(typeof (I3=I3 && G9t == typeof I3 && E9t == typeof I3.toJSON?I3.toJSON(k3):I3)){case B9t:return n3(I3);case v9t:return isFinite(I3)?String(I3):F9t;case u9t:case F9t:return String(I3);case G9t:if(!I3)return F9t;if((M3+=void B1t,q3=[],p9t === Object.prototype.toString.apply(I3))){for((y3=I3.length,J3=B1t);J3 < y3;J3+=b1t)q3[J3]=z3(J3,I3) || F9t;return (w3=B1t === q3.length?a9t:M3?W9t + M3 + q3.join(H9t + M3) + e9t + P3 + h9t:i9t + q3.join(f9t) + h9t,M3=P3,w3);}for(R3 in I3)Object.prototype.hasOwnProperty.call(I3,R3) && (w3=z3(R3,I3)) && q3.push(n3(R3) + (M3?T9t:x9t) + w3);return (w3=B1t === q3.length?r9t:M3?K9t + M3 + q3.join(H9t + M3) + e9t + P3 + C9t:g9t + q3.join(f9t) + C9t,M3=P3,w3);}})(N3t,{"":o3});},toJson:function(c3){var G3=J3t;if(B9t == typeof c3 && B1t <= c3.search(Q6t))try{try{G3=JSON.parse(c3);}catch(U3){G3=(G3=new Function(l6t + c3))();}}catch(S3){G3=J3t;}else G3=G9t == typeof c3?c3:J3t;return G3;},toObject:function(N3){var M6t=/\}[^\}]*$/;var s3=J3t;if(B9t == typeof N3 && B1t <= N3.search(Q6t))try{s3=(s3=new Function(l6t + N3.replace(Q6t,g9t).replace(M6t,C9t)))();}catch(j3){s3=J3t;}else s3=G9t == typeof N3?N3:J3t;return s3;},exponentToNumberString:function(A3){var I6t=/^\-/;var D6t=/[eE]/;var z6t="0.";var O3=(A3 + N3t).split(D6t),L3=N3t,m3=N3t,Z3=N3t;if(b1t == O3.length)return O3[B1t];if((A3=A3 < B1t?V6t:N3t,m3=O3[B1t].replace(o6t,N3t),(Z3=+O3[b1t] + b1t) < B1t)){for(L3=A3 + z6t;Z3++;)L3+=n9t;return L3 + m3.replace(I6t,N3t);}for(Z3-=m3.length;Z3--;)L3+=n9t;return m3 + L3;},getFileName:function(Y3,B3){return Y3=(Y3 + N3t).indexOf(o6t) < B1t?Y3 + o6t + B3:Y3;},getTableBody:function(t3){var w6t="tbody";var q6t="table";var E3,F3,v3=J3t,b3=B1t;if(G9t != typeof t3)return J3t;if(q6t !== t3.tagName.toLowerCase())return t3.firstChild;for((v3=(E3=t3.getElementsByTagName(w6t))[B1t],b3=B1t,F3=E3.length);b3 < F3;b3++)if(B1t < E3[b3].childNodes.length){v3=E3[b3];break;}return v3;},removeHTMLTag:function(u3,a3){if(J3t == u3 || B9t != typeof u3)return N3t;switch(a3){case b1t:return u3.replace(/<([^>]*)>/gi,N3t);case t1t:return u3.replace(/<(\/)?([a-zA-Z]*)(\s[a-zA-Z]*[^>]*)?(\s)*(\/)?>/gi,N3t);default:return u3.replace(/<(\/)?([a-zA-Z]*)(\s[a-zA-Z]*=[^>]*)?(\s)*(\/)?>/gi,N3t);}},convert2ByteChar2:function(h3){var I3t=65248;var w3t=65305;var q3t=65290;for(var i3=new String(),T3=h3.length,W3=B1t;W3 < T3;W3++){var H3=h3.charCodeAt(W3);i3+=q3t <= H3 && H3 <= w3t?String.fromCharCode(H3 - I3t):h3.charAt(W3);}return i3;},wrapUp:function(r3,x3){return x3 + r3 + x3;},getElementsByClassName:function(Q9,K3){var P6t="( |$)";var J6t="(^| )";if((K3=K3 || V).getElementsByClassName)return K3.getElementsByClassName(Q9);if(K3.querySelectorAll)return K3.querySelectorAll(o6t + Q9);for(var M9=new RegExp(J6t + Q9 + P6t),l9=new Array(),C3=K3.body.getElementsByTagName(R6t),D9=C3.length,g3=B1t;g3 < D9;g3++)M9.test(C3[g3].className) && l9.push(C3[g3]);return (C3=J3t,l9);}}).init()),M.DirectDown2Excel=function(V9){var o9=this.Down2Excel(V9,!B1t);if(V9 && V9.debugMode)return o9;},M.DirectLoadExcel=function(z9){return (Q.g_isDirectLoadExcel=!B1t,this.LoadExcel(z9));},M.Down2Excel=function(I9,q9){var w9;if((Q.g_isDown2ExcelBuffer5 || Q.g_isDown2ExcelBuffer || this.showMessage(this.getMessage(k6t)),void B1t === I9 && (I9={}),Q.g_isDown2ExcelBuffer || I9.debugMode))return (w9=this._delayedDown2Excel(I9,q9),I9.debugMode && this.hideMessage(),w9);setTimeout((function(){this._delayedDown2Excel(I9,q9);}).bind(this),l3t);},M._delayedDown2Excel=function(P9,R9){var S6t="-1";var U6t="auto";var G6t="&lt";var d6t=/^\s*((http(s?))\:\/\/)/i;var O6t="Down2Excel.jsp";var p6t="Post";var n6t="Excel";var c6t="&gt";this._prepareExportSetting();var J9,n9,X9,f9,y9=N3t,d9=this,k9=N3t;if((Q.g_isDirectDown2Excel=b1t == R9,void B1t === (J9=Q._ibsUtil.cloneArray(P9)) && (J9=[]),P9=this.Down2ExcelConfig,J9.downHeader=this._getDefault(void B1t !== J9.downHeader?J9.downHeader:J9.DownHeader,this._getDefault((P9=void B1t === P9?{}:P9).downHeader,!B1t)),J9.downSum=this._getDefault(void B1t !== J9.downSum?J9.downSum:J9.DownSum,this._getDefault(P9.downSum,!B1t)),J9.RequiredMark=this._getDefault((J9.RequiredMark,J9.RequiredMark),this._getDefault(P9.RequiredMark,!B1t)),J9.multipart=this._getDefault(void B1t !== J9.multipart?J9.multipart:J9.Multipart,this._getDefault(P9.multipart,!B1t)),J9.textToGeneral=this._getDefault(void B1t !== J9.textToGeneral?J9.textToGeneral:J9.TextToGeneral,this._getDefault(P9.textToGeneral,!B1t)),J9.wordWrap=this._getDefault(void B1t !== J9.wordWrap?J9.wordWrap:J9.WordWrap,this._getDefault(P9.wordWrap,!B1t)),J9.allTypeToText=this._getDefault(void B1t !== J9.allTypeToText?J9.allTypeToText:J9.AllTypeToText,this._getDefault(P9.allTypeToText,!b1t)),J9.appendPrevSheet=this._getDefault(void B1t !== J9.appendPrevSheet?J9.appendPrevSheet:J9.AppendPrevSheet,this._getDefault(P9.appendPrevSheet,!b1t)),J9.autoSizeColumn=this._getDefault(void B1t !== J9.autoSizeColumn?J9.autoSizeColumn:J9.AutoSizeColumn,this._getDefault(P9.autoSizeColumn,!b1t)),J9.checkBoxOffValue=this._getDefault(void B1t !== J9.checkBoxOffValue?J9.checkBoxOffValue:J9.CheckBoxOffValue,this._getDefault(P9.checkBoxOffValue,n9t)),J9.checkBoxOnValue=this._getDefault(void B1t !== J9.checkBoxOnValue?J9.checkBoxOnValue:J9.CheckBoxOnValue,this._getDefault(P9.checkBoxOnValue,y6t)),J9.comboValidation=this._getDefault(void B1t !== J9.comboValidation?J9.comboValidation:J9.ComboValidation,this._getDefault(P9.comboValidation,!b1t)),J9.debugMode=this._getDefault(void B1t !== J9.debugMode?J9.debugMode:J9.DebugMode,this._getDefault(P9.debugMode,!b1t)),J9.downCols=this._getDefault(void B1t !== J9.downCols?J9.downCols:J9.DownCols,this._getDefault(P9.downCols,N3t)),J9.downCombo=this._getDefault(void B1t !== J9.downCombo?J9.downCombo:J9.DownCombo,this._getDefault(P9.downCombo,F3t)).toUpperCase(),J9.downRows=this._getDefault(void B1t !== J9.downRows?J9.downRows:J9.DownRows,this._getDefault(P9.downRows,N3t)),J9.downTreeHide=this._getDefault(void B1t !== J9.downTreeHide?J9.downTreeHide:J9.DownTreeHide,this._getDefault(P9.downTreeHide,! !this.ExcelTreeMode)),J9.excelFontSize=this._getDefault(void B1t !== J9.excelFontSize?J9.excelFontSize:J9.ExcelFontSize,this._getDefault(P9.excelFontSize,B1t)),J9.excelRowHeight=this._getDefault(void B1t !== J9.excelRowHeight?J9.excelRowHeight:J9.ExcelRowHeight,this._getDefault(P9.excelRowHeight,N3t)),J9.excludeSubSum=this._getDefault(void B1t !== J9.excludeSubSum?J9.excludeSubSum:J9.ExcludeSubSum,this._getDefault(P9.excludeSubSum,B1t)),J9.extendParam=this._getDefault(void B1t !== J9.extendParam?J9.extendParam:J9.ExtendParam,this._getDefault(P9.extendParam,N3t)),J9.extendParamMethod=this._getDefault(void B1t !== J9.extendParamMethod?J9.extendParamMethod:J9.ExtendParamMethod,this._getDefault(P9.extendParamMethod,N3t)),J9.fileName=this._getDefault(void B1t !== J9.fileName?J9.fileName:J9.FileName,this._getDefault(P9.fileName,n6t)),J9.hiddenColumn=this._getDefault(void B1t !== J9.hiddenColumn?J9.hiddenColumn:J9.HiddenColumn,this._getDefault(P9.hiddenColumn,!b1t)),J9.merge=this._getDefault(void B1t !== J9.merge?J9.merge:J9.Merge,this._getDefault(P9.merge,this.MultiRecord && b1t & this.MultiRecordShape?b1t:B1t)),J9.mode=this._getDefault(void B1t !== J9.mode?J9.mode:J9.Mode,n9t),J9.numberFormatMode=this._getDefault(void B1t !== J9.numberFormatMode?J9.numberFormatMode:J9.NumberFormatMode,this._getDefault(P9.numberFormatMode,B1t)),J9.numberTypeToText=this._getDefault(void B1t !== J9.numberTypeToText?J9.numberTypeToText:J9.NumberTypeToText,this._getDefault(P9.numberTypeToText,!b1t)),J9.onlyHeaderMerge=this._getDefault(void B1t !== J9.onlyHeaderMerge?J9.onlyHeaderMerge:J9.OnlyHeaderMerge,this._getDefault(P9.onlyHeaderMerge,!b1t)),J9.reportXML=this._getDefault(void B1t !== J9.reportXML?J9.reportXML:J9.ReportXML,this._getDefault(P9.reportXML,N3t)),J9.reportXMLURL=this._getDefault(void B1t !== J9.reportXMLURL?J9.reportXMLURL:J9.ReportXMLURL,this._getDefault(P9.reportXMLURL,N3t)),J9.sheetDesign=this._getDefault(void B1t !== J9.sheetDesign?J9.sheetDesign:J9.SheetDesign,this._getDefault(P9.sheetDesign,b1t)),J9.sheetName=this._getDefault(void B1t !== J9.sheetName?J9.sheetName:J9.SheetName,this._getDefault(P9.sheetName,X6t)),J9.sheetNo=this._getDefault(void B1t !== J9.sheetNo?J9.sheetNo:J9.SheetNo,this._getDefault(P9.sheetNo,B1t)),J9.startCol=this._getDefault(void B1t !== J9.startCol?J9.startCol:J9.StartCol,this._getDefault(P9.startCol,B1t)),J9.startRow=this._getDefault(void B1t !== J9.startRow?J9.startRow:J9.StartRow,this._getDefault(P9.startRow,B1t)),J9.tempFile=this._getDefault(void B1t !== J9.tempFile?J9.tempFile:J9.TempFile,this._getDefault(P9.tempFile,N3t)),J9.titleAlign=this._getDefault(void B1t !== J9.titleAlign?J9.titleAlign:J9.TitleAlign,this._getDefault(P9.titleAlign,f6t)),J9.titleText=this._getDefault(void B1t !== J9.titleText?J9.titleText:J9.TitleText,this._getDefault(P9.titleText,N3t)),J9.treeLevel=this._getDefault(void B1t !== J9.treeLevel?J9.treeLevel:J9.TreeLevel,this._getDefault(P9.treeLevel,!b1t)),J9.url=this._getDefault(void B1t !== J9.url?J9.url:J9.URL,this._getDefault(P9.url,N3t)),J9.userMerge=this._getDefault(void B1t !== J9.userMerge?J9.userMerge:J9.UserMerge,this._getDefault(P9.userMerge,N3t)),J9.workbookPassword=this._getDefault(void B1t !== J9.workbookPassword?J9.workbookPassword:J9.WorkbookPassword,this._getDefault(P9.workbookPassword,N3t)),J9.numberExMode=this._getDefault(void B1t !== J9.numberExMode?J9.numberExMode:J9.NumberExMode,this._getDefault(P9.numberExMode,!b1t)),J9.useFormula=this._getDefault(void B1t !== J9.useFormula?J9.useFormula:J9.UseFormula,this._getDefault(P9.useFormula,!b1t)),J9.excelHeaderRowHeight=this._getDefault(void B1t !== J9.excelHeaderRowHeight?J9.excelHeaderRowHeight:J9.ExcelHeaderRowHeight,this._getDefault(P9.excelHeaderRowHeight,N3t)),J9.imageProcessType=this._getDefault(void B1t !== J9.imageProcessType?J9.imageProcessType:J9.ImageProcessType,this._getDefault(P9.imageProcessType,B1t)),J9.excludeFooterRow=this._getDefault(void B1t !== J9.excludeFooterRow?J9.excludeFooterRow:J9.ExcludeFooterRow,this._getDefault(P9.excludeFooterRow,!b1t)),J9.timeout=this._getDefault(void B1t !== J9.timeout?J9.timeout:J9.Timeout,this._getDefault(P9.timeout,B1t)),J9.useXhr=this._getDefault((J9.useXhr,J9.useXhr),this._getDefault(P9.useXhr,!b1t)),J9.reqHeader=J9.reqHeader || P9.reqHeader,J9.sendParam=J9.sendParam || P9.sendParam,J9.downRowSpan=J9.downRowSpan || B1t,void B1t === J9.header && (J9.header=P9.header),void B1t === J9.footer && (J9.footer=P9.footer),this._autoExcelModeCheck(J9,this.AutoExcelMode,b3t,!B1t,R9)))return ((J9.tempFile || J9.TempFile) && (J9.sheetDesign=B1t),J9.sheetName=J9.sheetName.replace(/\//gi,N3t).replace(/\?/gi,N3t).replace(/\\/gi,N3t).replace(/\*/gi,N3t).replace(/\[/gi,N3t).replace(/\]/gi,N3t).replace(/\:/gi,N3t),N3t == J9.sheetName && (J9.sheetName=X6t),J9.reportXML?y9=J9.reportXML:N3t != J9.reportXMLURL && ((J9.reportXMLURL + N3t).toLowerCase().search(d6t) < B1t && (J9.reportXMLURL=Q._ibsUtil.getFullPath(J9.reportXMLURL)),B9t == typeof (P9=AjaxCall({Url:J9.reportXMLURL,Method:p6t})) && (y9=P9)),J9.reportXML=y9.replace(/\</gi,G6t).replace(/\>/gi,c6t),U6t == (J9.excelRowHeight + N3t).toLowerCase() && (J9.excelRowHeight=S6t),N3t == J9.excelHeaderRowHeight?J9.excelHeaderRowHeight=J9.excelRowHeight:U6t == (J9.excelHeaderRowHeight + N3t).toLowerCase() && (J9.excelHeaderRowHeight=S6t),N3t != J9.downRows && J9.downTreeHide && (J9.downTreeHide=B1t),s6t == J9.titleText.substring(J9.titleText.length - t1t) && (J9.titleText+=N6t),J9.downRows=j6t + J9.downRows + j6t,J9.merge=this._getNumberValue(J9.merge,B1t,B1t,B1t,t1t),L6t != (R9=J9.downCols) && (j6t == (R9=j6t == R9.substring(B1t,b1t)?R9.substring(b1t):R9).substring(R9.length - b1t) && (R9=R9.substring(B1t,R9.length - b1t)),J9.downCols=R9),b1t == Q.g_isDirectDown2Excel?(J9.downSum=B1t,J9.onlyHeaderMerge=B1t,J9.treeLevel=B1t):(void B1t !== this.Source.Down2Excel.Url && N3t != this.Source.Down2Excel.Url || (this.Source.Down2Excel.Url=O6t),k9=this.Source.Down2Excel.Url),N3t != J9.url && (k9=J9.url,Q.g_isDown2ExcelBuffer && (Q.g_DirectDownUrl=k9)),n9=J9.extendParam,X9=J9.extendParamMethod,f9=Q._ibsUtil.getFileName(J9.fileName,m6t),this.Down2ExcelBufferInfo.extendParam=n9,this.Down2ExcelBufferInfo.extendParamMethod=X9,this.Down2ExcelBufferInfo.timeout=J9.timeout,this.Down2ExcelBufferInfo.useXhr=J9.useXhr,this.Down2ExcelBufferInfo.fileName=f9,this.Down2ExcelBufferInfo.sendParam=J9.sendParam,this.Down2ExcelBufferInfo.reqHeader=J9.reqHeader,this._getDown2Excel(J9,function(p9){d9._sendDown(p9,k9,n9,X9,J9.multipart,b3t,J9.debugMode,J9.timeout,J9.useXhr,f9,J9.sendParam,J9.reqHeader);}));void B1t === Q.g_isDown2ExcelBuffer5 && setTimeout(function(){d9.hideMessage();},H1t);},M.Down2ExcelBuffer=function(G9,N9){this._prepareExportSetting();var c9,U9=N3t,S9=this.IB_DELIMITER_SHEET.length,s9=this._autoExcelModeCheck(N3t,this.AutoExcelMode,b3t,!B1t,!b1t,G9);if(s9)return G9?(Q.g_isDown2ExcelBuffer=G9,this.showMessage(this.getMessage(k6t)),void (Q.g_isDown2ExcelBufferQueue=!B1t)):!G9 && this.Source.Down2Excel && N3t != Q.g_down2ExcelBuffer?(Q.g_isDown2ExcelBuffer=G9,this.fileDownloadCheckToken=Q.g_isDown2ExcelBufferToken,Q.g_isDown2ExcelBufferToken=J3t,c9=this,Q.fileDownloadCheckTimer=o.setInterval(function(){c9._getCookie(Z6t) == c9.fileDownloadCheckToken && (c9.fileDownloadCheckToken=J3t,c9._finishDownload());},l3t),U9=Q.g_isDirectDown2Excel?Q.g_DirectDownUrl:this.Source.Down2Excel.Url,this._sendDown(Q.g_down2ExcelBuffer.substring(B1t,Q.g_down2ExcelBuffer.length - S9),U9,this.Down2ExcelBufferInfo.extendParam,this.Down2ExcelBufferInfo.extendParamMethod,Q.g_Multipart,b3t,N9,this.Down2ExcelBufferInfo.timeout,this.Down2ExcelBufferInfo.useXhr,this.Down2ExcelBufferInfo.fileName,this.Down2ExcelBufferInfo.sendParam,this.Down2ExcelBufferInfo.reqHeader)):void B1t;},M.GetDown2ExcelConfig=function(){return this.Down2ExcelConfig;},M.GetDown2ExcelUrl=function(){var j9=N3t;return j9=this.Source.Down2Excel.Url?this.Source.Down2Excel.Url:j9;},M.GetLoadExcelConfig=function(){return this.LoadExcelConfig || ({});},M.GetLoadExcelUrl=function(){var L9=N3t;return L9=this.Source.LoadExcel.Url?this.Source.LoadExcel.Url:L9;},M.LoadExcel=function(O9){this.LoadFileType=b3t;var b9,E9,v9,F9,u9,A9,t9=(this.LoadExcelExecute=b1t) & this.MultiRecordShape,O9=(this.MultiRecordShape=B1t,this.HasLoadedExcelData && delete this.HasLoadedExcelData,this._prepareExportSetting(),Q._ibsUtil.cloneArray(O9)),Z9={},m9=N3t,Y9=[],B9=N3t;if((Q.g_targetExcelSheetID=this.id,Q.g_isLoadExcelBuffer || (Q.g_LoadExcelSheetID=[]),Q.g_LoadExcelSheetID.push(this.id),void B1t !== this.LoadExcelConfig && (Z9=this.LoadExcelConfig),(O9=void B1t === O9?[]:O9).append=this._getDefault(void B1t !== O9.append?O9.append:O9.Append,this._getDefault(Z9.append,!b1t)),O9.columnMapping=this._getDefault(void B1t !== O9.columnMapping?O9.columnMapping:O9.ColumnMapping,this._getDefault(Z9.columnMapping,N3t)),O9.debugMode=this._getDefault(void B1t !== O9.debugMode?O9.debugMode:O9.DebugMode,this._getDefault(Z9.debugMode,!b1t)),O9.endRow=this._getDefault(void B1t !== O9.endRow?O9.endRow:O9.EndRow,this._getDefault(Z9.endRow,B1t)),O9.extendParam=this._getDefault(void B1t !== O9.extendParam?O9.extendParam:O9.ExtendParam,this._getDefault(Z9.extendParam,N3t)),O9.fileExt=this._getDefault(void B1t !== O9.fileExt?O9.fileExt:O9.FileExt,this._getDefault(Z9.fileExt,N3t)),O9.maxFileSize=this._getDefault(void B1t !== O9.maxFileSize?O9.maxFileSize:O9.MaxFileSize,this._getDefault(Z9.maxFileSize,B1t,A6t),A6t),O9.merge=this._getDefault(void B1t !== O9.merge?O9.merge:O9.Merge,this._getDefault(Z9.merge,b1t)),O9.mode=this._getDefault(void B1t !== O9.mode?O9.mode:O9.Mode,this._getDefault(Z9.mode,Y6t)),O9.serverFile=this._getDefault(void B1t !== O9.serverFile?O9.serverFile:O9.ServerFile,this._getDefault(Z9.serverFile,N3t)),O9.startCol=this._getDefault(void B1t !== O9.startCol?O9.startCol:O9.StartCol,this._getDefault(Z9.startCol,b1t)),O9.startRow=this._getDefault(void B1t !== O9.startRow?O9.startRow:O9.StartRow,this._getDefault(Z9.startRow,b1t)),O9.unMatchColHidden=this._getDefault(void B1t !== O9.unMatchColHidden?O9.unMatchColHidden:O9.UnMatchColHidden,this._getDefault(Z9.unMatchColHidden,N3t)),O9.useDOM=this._getDefault(void B1t !== O9.useDOM?O9.useDOM:O9.UseDOM,this._getDefault(Z9.useDOM,!b1t)),O9.workSheetName=this._getDefault(void B1t !== O9.workSheetName?O9.workSheetName:O9.WorkSheetName,this._getDefault(Z9.workSheetName,N3t)),O9.workSheetNo=this._getDefault(void B1t !== O9.workSheetNo?O9.workSheetNo:O9.WorkSheetNo,this._getDefault(Z9.workSheetNo,b1t)),O9.skipEmptyRow=this._getDefault(void B1t !== O9.skipEmptyRow?O9.skipEmptyRow:O9.SkipEmptyRow,this._getDefault(Z9.skipEmptyRow,!B1t)),O9.useXhr=this._getDefault((O9.useXhr,O9.useXhr),this._getDefault(Z9.useXhr,!b1t)),O9.reqHeader=O9.reqHeader || Z9.reqHeader,O9.sendParam=O9.sendParam || Z9.sendParam,O9.workbookPassword=this._getDefault((O9.workbookPassword,O9.workbookPassword),this._getDefault(Z9.workbookPassword,N3t)),this._uploadDialogLoadType=O9.dialogType || O9.DialogType,this._autoExcelModeCheck(O9,this.AutoExcelMode,b3t,!b1t,!b1t)))return (this.GetLoadColNames(Y9,O9),Z9=this._getHeaderText(Y9),b9=(A9=this._getColInfo(O9,Y9,!b1t)).name,E9=A9.saveName,v9=A9.type,F9=A9.format,u9=A9.datePattern,dataFormat=A9.dataFormat,m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9=(m9+=this._makeColumnTag(B6t,O9.DateStrictMode?b1t:B1t)) + this._makeColumnTag(b6t,O9.append?b1t:B1t)) + this._makeColumnTag(t6t,O9.unMatchColHidden)) + this._makeColumnTag(E6t,this.SearchMode)) + this._makeColumnTag(v6t,O9.extendParam)) + this._makeColumnTag(F6t,Y9.length)) + this._makeColumnTag(u6t,dataFormat)) + this._makeColumnTag(a6t,this.getHeaderRows().length)) + this._makeColumnTag(W6t,O9.startRow)) + this._makeColumnTag(H6t,O9.endRow)) + this._makeColumnTag(e6t,O9.startCol)) + this._makeColumnTag(h6t,O9.workSheetNo)) + this._makeColumnTag(i6t,O9.workSheetName)) + this._makeColumnTag(T6t,O9.mode.replace(/ /g,N3t).toUpperCase())) + this._makeColumnTag(x6t,void B1t !== this.StatusCol?this.StatusCol:N3t)) + this._makeColumnTag(r6t,O9.columnMapping)) + this._makeColumnTag(K6t,b9)) + this._makeColumnTag(C6t,E9)) + this._makeColumnTag(g6t,Z9)) + this._makeColumnTag(Q2t,b9)) + this._makeColumnTag(l2t,v9)) + this._makeColumnTag(M2t,F9)) + this._makeColumnTag(D2t,u9)) + this._makeColumnTag(V2t,this.id)) + this._makeColumnTag(o2t,O9.merge)) + this._makeColumnTag(z2t,this.UseJsonAttribute)) + this._makeColumnTag(I2t,O9.serverFile)) + this._makeColumnTag(q2t,O9.skipEmptyRow?b1t:B1t)) + this._makeColumnTag(w2t,this._encodeBase64(O9.workbookPassword)),B9=Q.g_isDirectLoadExcel?this._getDefault(this.Source.DirectLoadExcel.Url,J2t):this._getDefault(this.Source.LoadExcel.Url,P2t),B9=Q._ibsUtil.getFullPath(B9),m9+=this._makeColumnTag(R2t,B9),E9t != typeof o.postMessage && G9t != typeof o.postMessage || (m9+=this._makeColumnTag(k2t,this.id)),m9+=this._makeColumnTag(y2t,O9.useDOM?b1t:B1t),Q.g_isLoadExcelBuffer?(Q.g_LoadExcelBuffer.push(m9),Q.g_LoadExcelBufferExt=O9.fileExt,Q.g_LoadExcelBufferMaxFileSize=O9.maxFileSize,this.g_LoadExcelBufferCfg.useXhr=O9.useXhr,this.g_LoadExcelBufferCfg.sendParam=O9.sendParam,void (this.g_LoadExcelBufferCfg.reqHeader=O9.reqHeader)):O9.debugMode?m9:(O9.useXhr || O9.reqHeader && G9t == typeof O9.reqHeader?this._makeLoadXhr(b3t,m9,O9.maxFileSize,O9.sendParam,O9.fileExt,O9.reqHeader):this._makeLoadForm(b3t,Q.g_isDirectLoadExcel,O9.fileExt,m9,O9.maxFileSize,O9.serverFile,O9.sendParam),void (t9 && (this.MultiRecordShape=t9))));},M.LoadExcelBuffer=function(a9,h9){(this.HasLoadedExcelData && delete this.HasLoadedExcelData,this._prepareExportSetting());var a9=this._getBooleanValue(a9,B1t),H9=this.g_LoadExcelBufferCfg && this.g_LoadExcelBufferCfg.useXhr,e9=this.g_LoadExcelBufferCfg && this.g_LoadExcelBufferCfg.sendParam,W9=this.g_LoadExcelBufferCfg && this.g_LoadExcelBufferCfg.reqHeader;if(this._autoExcelModeCheck({},this.AutoExcelMode,b3t,!b1t,!b1t,a9)){if((Q.g_isLoadExcelBuffer=a9,h9))return Q.g_LoadExcelBuffer.join(this.IB_DELIMITER_SHEET);!a9 && B1t < Q.g_LoadExcelBuffer.length?(H9 || W9 && G9t == typeof W9?this._makeLoadXhr(b3t,Q.g_LoadExcelBuffer.join(this.IB_DELIMITER_SHEET),Q.g_LoadExcelBufferMaxFileSize,e9,Q.g_LoadExcelBufferExt,W9,!B1t):this._makeLoadForm(b3t,Q.g_isDirectLoadExcel,Q.g_LoadExcelBufferExt,Q.g_LoadExcelBuffer.join(this.IB_DELIMITER_SHEET),Q.g_LoadExcelBufferMaxFileSize),Q.g_LoadExcelBuffer=[]):Q.g_LoadExcelSheetID=[];}},M.LoadExcelError=function(T9){this._prepareExportSetting();var i9=B1t,x9=Q.g_LoadExcelSheetID.length,r9=(this.getMessage(n2t,E3t),B1t),K9=N3t,C9=J3t;if(!(x9 < b1t))for((void B1t !== T9 && (r9=T9.Code || B1t,(K9=T9.Msg || N3t) && B1t),i9=B1t);i9 < x9;i9++)((C9=Q[Q.g_LoadExcelSheetID[i9]]).hideMessage(),Q.OnLoadExcelError && Q.OnLoadExcelError(C9,b3t,r9,K9));},M.SetDown2ExcelConfig=function(g9){(this.Down2ExcelConfig=Q._ibsUtil.cloneArray(g9),void B1t !== this.Down2ExcelConfig.appendPrevSheet && (y6t === this.Down2ExcelConfig.appendPrevSheet?this.Down2ExcelConfig.appendPrevSheet=!B1t:n9t === this.Down2ExcelConfig.appendPrevSheet && (this.Down2ExcelConfig.appendPrevSheet=!b1t)),void B1t !== this.Down2ExcelConfig.autoSizeColumn && (y6t === this.Down2ExcelConfig.autoSizeColumn?this.Down2ExcelConfig.autoSizeColumn=!B1t:n9t === this.Down2ExcelConfig.autoSizeColumn && (this.Down2ExcelConfig.autoSizeColumn=!b1t)),void B1t !== this.Down2ExcelConfig.comboValidation && (y6t === this.Down2ExcelConfig.comboValidation?this.Down2ExcelConfig.comboValidation=!B1t:n9t === this.Down2ExcelConfig.comboValidation && (this.Down2ExcelConfig.comboValidation=!b1t)),void B1t !== this.Down2ExcelConfig.downHeader && (y6t === this.Down2ExcelConfig.downHeader?this.Down2ExcelConfig.downHeader=!B1t:n9t === this.Down2ExcelConfig.downHeader && (this.Down2ExcelConfig.downHeader=!b1t)),void B1t !== this.Down2ExcelConfig.downSum && (y6t === this.Down2ExcelConfig.downSum?this.Down2ExcelConfig.downSum=!B1t:n9t === this.Down2ExcelConfig.downSum && (this.Down2ExcelConfig.downSum=!b1t)),void B1t !== this.Down2ExcelConfig.hiddenColumn && (y6t === this.Down2ExcelConfig.hiddenColumn?this.Down2ExcelConfig.hiddenColumn=!B1t:n9t === this.Down2ExcelConfig.hiddenColumn && (this.Down2ExcelConfig.hiddenColumn=!b1t)),void B1t !== this.Down2ExcelConfig.RequiredMark && (y6t === this.Down2ExcelConfig.RequiredMark?this.Down2ExcelConfig.RequiredMark=!B1t:n9t === this.Down2ExcelConfig.RequiredMark && (this.Down2ExcelConfig.RequiredMark=!b1t)),void B1t !== this.Down2ExcelConfig.multipart && (y6t === this.Down2ExcelConfig.multipart?this.Down2ExcelConfig.multipart=!B1t:n9t === this.Down2ExcelConfig.multipart && (this.Down2ExcelConfig.multipart=!b1t)),void B1t !== this.Down2ExcelConfig.numberTypeToText && (y6t === this.Down2ExcelConfig.numberTypeToText?this.Down2ExcelConfig.numberTypeToText=!B1t:n9t === this.Down2ExcelConfig.numberTypeToText && (this.Down2ExcelConfig.numberTypeToText=!b1t)),void B1t !== this.Down2ExcelConfig.onlyHeaderMerge && (y6t === this.Down2ExcelConfig.onlyHeaderMerge?this.Down2ExcelConfig.onlyHeaderMerge=!B1t:n9t === this.Down2ExcelConfig.onlyHeaderMerge && (this.Down2ExcelConfig.onlyHeaderMerge=!b1t)),void B1t !== this.Down2ExcelConfig.textToGeneral && (y6t === this.Down2ExcelConfig.textToGeneral?this.Down2ExcelConfig.textToGeneral=!B1t:n9t === this.Down2ExcelConfig.textToGeneral && (this.Down2ExcelConfig.textToGeneral=!b1t)),void B1t !== this.Down2ExcelConfig.treeLevel && (y6t === this.Down2ExcelConfig.treeLevel?this.Down2ExcelConfig.treeLevel=!B1t:n9t === this.Down2ExcelConfig.treeLevel && (this.Down2ExcelConfig.treeLevel=!b1t)),void B1t !== this.Down2ExcelConfig.wordWrap && (y6t === this.Down2ExcelConfig.wordWrap?this.Down2ExcelConfig.wordWrap=!B1t:n9t === this.Down2ExcelConfig.wordWrap && (this.Down2ExcelConfig.wordWrap=!b1t)),void B1t !== this.Down2ExcelConfig.numberExMode && (y6t === this.Down2ExcelConfig.numberExMode?this.Down2ExcelConfig.numberExMode=!B1t:n9t === this.Down2ExcelConfig.numberExMode && (this.Down2ExcelConfig.numberExMode=!b1t)),void B1t !== this.Down2ExcelConfig.useFormula && (y6t === this.Down2ExcelConfig.useFormula?this.Down2ExcelConfig.useFormula=!B1t:n9t === this.Down2ExcelConfig.useFormula && (this.Down2ExcelConfig.useFormula=!b1t)),void B1t !== this.Down2ExcelConfig.excludeFooterRow && (y6t === this.Down2ExcelConfig.excludeFooterRow?this.Down2ExcelConfig.excludeFooterRow=!B1t:n9t === this.Down2ExcelConfig.excludeFooterRow && (this.Down2ExcelConfig.excludeFooterRow=!b1t)));},M.SetDown2ExcelUrl=function(Q6){(this.Source.Down2Excel || (this.Source.Down2Excel={}),this.Source.Down2Excel.Url=Q6);},M.SetLoadExcelConfig=function(l6){(this.LoadExcelConfig=Q._ibsUtil.cloneArray(l6),void B1t !== this.LoadExcelConfig.append && (y6t === this.LoadExcelConfig.append?this.LoadExcelConfig.append=!B1t:n9t === this.LoadExcelConfig.append && (this.LoadExcelConfig.append=!b1t)),void B1t !== this.LoadExcelConfig.useDOM && (y6t === this.LoadExcelConfig.useDOM?this.LoadExcelConfig.useDOM=!B1t:n9t === this.LoadExcelConfig.useDOM && (this.LoadExcelConfig.useDOM=!b1t)));},M.SetLoadExcelUrl=function(M6){(this.Source.LoadExcel || (this.Source.LoadExcel={}),this.Source.LoadExcel.Url=M6);},M._addCellColor=function(z6,D6,o6){var V6;return z6?(o6 && X2t == D6.Kind && f2t !== D6.id && (this.Cols[o6].Background || this.Cols[o6].Color) && (V6=this.Cols[o6].Background || this.Cols[o6].Color),(D6.Background || D6.Color || D6.Def && D6.Def.Color) && (V6=D6.Background || D6.Color || D6.Def && D6.Def.Color),(D6[o6 + d2t] || D6[o6 + p2t]) && (V6=D6[o6 + d2t] || D6[o6 + p2t]),f2t === D6.id && void B1t === V6 && (V6=this.GetSumBackColor(o6)),(V6=X2t == D6.Kind && G2t === D6.Name?D6.Background || D6.Color:V6) && -b1t !== V6?(-b1t < (V6+=N3t).indexOf(d9t)?E1t == (V6=V6.replace(d9t,N3t)).length && (V6=(z6=V6.substr(B1t,b1t)) + z6 + (o6=V6.substr(b1t,b1t)) + o6 + (D6=V6.substr(t1t,b1t)) + D6):-b1t < V6.indexOf(f9t) && (V6=Q._ibsUtil.getWebColor(V6)),this._addExcelPaletteList(V6),this.IB_DELIMITER_COLOR + V6):N3t):N3t;},M._addExcelPaletteList=function(I6){(I6=N6t + I6.toLowerCase(),-b1t == this.g_excelPaletteList.indexOf(I6) && (this.g_excelPaletteList+=I6));},M._excelDataFixedMergeRange=function(){var w6,k6,P6=B1t,J6=B1t,R6=B1t,q6=B1t;for((void B1t === this.FixedMergeTemplate && this._setFixedMergeTemplate(),w6=this.FixedMergeTemplate,J6=B1t);J6 < this.ExcelXB.length;J6++){for((this.ExcelXB[J6],q6=B1t,k6=w6.length);q6 < k6;q6++)P6 == w6[q6][B1t] && (R6=w6[q6][t1t]?J6 + w6[q6][t1t] - b1t:J6,this.ExcelColsMap[w6[q6][b1t]] && this.ExcelColsMap[w6[q6][E1t]] && this._excelSpanRange(this.ExcelXB,J6,this.ExcelColsMap[w6[q6][b1t]],this.ExcelXB[R6],this.ExcelColsMap[w6[q6][E1t]],B1t));++P6 == this.DataRows && (P6=B1t);}},M._excelDataMergeRange=function(){var f6,X6,G6,S6,c6,s6,n6,y6,d6,p6,U6;if(!this.MainCol){if(b1t < this.DataRows)for((f6=B1t,S6=this.ExcelXB.length);f6 < S6;f6++)for((n6=this.ExcelXB[f6],X6=B1t,G6=this.ExcelCol.length);X6 < G6;X6++)(d6=n6) != (d6=(n6[(p6=y6=this.ExcelCol[X6]) + c2t] || B1t == n6[y6 + c2t]) && b1t != n6[y6 + c2t]?d6:this._excelMergeTypeExtendBottom(n6,y6,this.XB,f6)) && this._excelSpanRange(this.ExcelXB,f6,y6,d6,y6,B1t);if(this.DataMergeAction){for((U6=[],X6=B1t,G6=this.ExcelCol.length);X6 < G6;X6++)(y6=this.ExcelCol[X6],this.ExcelColMerge[X6] && U6.push(y6));for(f6=B1t;f6 < this.ExcelXB.length;f6++)for((n6=this.ExcelXB[f6],c6=-b1t,X6=B1t,s6=this.ExcelCol.length);X6 < s6;X6++)(d6=n6,p6=y6=this.ExcelCol[X6],this.ExcelColMerge[X6] && c6++,B1t == n6[y6 + U2t] || (n6[y6 + c2t] || B1t == n6[y6 + c2t]) && b1t != n6[y6 + c2t] || (d6=this._excelMergeExtendBottom(n6,y6,this.ExcelXB,c6,U6,f6)),!this.DataRowMerge && !n6.RowMerge || B1t === n6[y6 + c2t] || B1t == n6[y6 + c2t] || (n6[y6 + U2t] || B1t == n6[y6 + U2t]) && b1t != n6[y6 + U2t] || (p6=this._excelMergeExtendRight(n6,y6,d6,J3t,this.ExcelXB,f6)),n6 == d6 && y6 == p6 || this._excelSpanRange(this.ExcelXB,f6,y6,d6,p6,B1t));}}},M._excelHeaderMergeRange=function(){var L6,O6,A6,N6,m6,Z6,j6;if(this.HeaderMergeAction)for(L6=B1t;L6 < this.ExcelXH.length;L6++)for((N6=this.ExcelXH[L6],O6=B1t,A6=this.ExcelCol.length);O6 < A6;O6++)(Z6=this.ExcelCol[O6],B1t == (m6=N6)[(j6=this.ExcelCol[O6]) + U2t] || (N6[j6 + c2t] || B1t == N6[j6 + c2t]) && b1t != N6[j6 + c2t] || (m6=this._excelMergeExtendBottom(N6,j6,this.ExcelXH,B1t,B1t,L6)),B1t == N6[j6 + c2t] || (N6[j6 + U2t] || B1t == N6[j6 + U2t]) && b1t != N6[j6 + U2t] || (Z6=this._excelMergeExtendRight(N6,j6,m6,this.ExcelXH,this.ExcelXH,L6)),N6 == m6 && j6 == Z6 || this._excelSpanRange(this.ExcelXH,L6,j6,m6,Z6,B1t));},M._excelMergeExtendBottom=function(Y6,t6,E6,v6,W6,e6){var F6,u6,h6,B6,a6=Y6,H6=(Y6[t6],t1t),b6=this.DataMergeAction;if((t1t !== b6 && v1t !== b6 || this.PreColumnMergeMode || (H6=b1t),!this.Cols[Y6[t6 + S2t]].ColMerge && (E6 != this.ExcelXH || b1t == this.HeaderMergeMode)))return a6;if(G2t === Y6.Name || Y6.CumulateRow)return a6;for((h6=(F6=this.GetSheetPageLength()) && t1t == H6?parseInt(e6 / F6) * F6 + F6:E6.length,u6=e6 + b1t);u6 < h6 && (Y6=E6[u6]);u6++)if(f2t !== Y6.id){if(G2t === Y6.Name || Y6.CumulateRow)break;if(b1t < this.DataRows && E6 != this.ExcelXH && !Y6.UnitPos)break;if((Y6[t6],t1t !== b6 && v1t !== b6 || X2t != Y6.Kind))break;if((B6=J3t,W6?B1t < v6 && (B6=t1t === b6?W6[v6 - b1t]:W6[B1t]):b1t < (v6=parseInt(t6.substring(b1t))) && (B6=s2t + (v6 - b1t)),B6)){if(!Y6[B6 + c2t] && B1t != Y6[B6 + c2t])break;if(Y6[B6 + c2t] && b1t < Y6[B6 + c2t])break;}}return a6;},M._excelMergeExtendRight=function(T6,i6,z2,P2,g6,J2){var L2t="I";for(var Q2,I2,q2,x6=i6,M2=T6[i6],l2=N3t,r6=T6[i6 + S2t],D2=this.Cols[r6].Section,K6=b1t,w2=this.getType(T6,i6),V2=[N2t,j2t],C6=B1t;C6 < V2.length;C6++)if(w2 == V2[C6])return x6;if((!this.DataRowMerge || g6) && !T6.RowMerge)return x6;if(!this.Cols[r6].RowMerge && !g6)return x6;if(L2t == T6.Status)return x6;for((Q2=i6.substr(b1t,i6.length),I2=this.ExcelCol.length);Q2 <= I2;Q2++){if((r6=T6[(i6=s2t + Q2) + S2t],K6=b1t,D2 != this.Cols[r6].Section)){K6=B1t;break;}if(!this.Cols[r6].RowMerge && !g6){K6=B1t;break;}if(T6 != z2)for(C6=J2;;C6++){if(M2 != (l2=(q2=g6[C6])[i6])){K6=B1t;break;}if(q2 == z2)break;}else (l2=T6[i6],B1t != T6[i6 + c2t] && M2 == l2 || (K6=B1t));if(!K6)break;(x6=i6,D2=this.Cols[r6].Section);}return x6;},M._excelMergeTypeExtendBottom=function(R2,X2,G2,p2){var f2,d2,y2=R2,k2=B1t,n2=this.getType(R2,R2[X2 + S2t]);if(!({Status:b1t,Seq:b1t,DelCheck:b1t,Result:b1t})[n2])return y2;for((f2=n2,k2=p2 + b1t,d2=this.ExcelXB.length);k2 < d2 && (R2=this.ExcelXB[k2]).UnitPos;k2++)if(f2t !== R2.id){if(f2 != this.getType(R2,R2[X2 + S2t]))break;y2=R2;}return y2;},M._excelSpanRange=function(U2,s2,m2,t2,B2){var j2,c2,S2,b2,Z2,L2=B1t,Y2=B1t,A2=B1t,N2=parseInt(m2.substring(b1t)),O2=parseInt(B2.substring(b1t));if(void B1t !== U2[s2][m2] && void B1t !== U2[s2][B2]){if(b1t == U2[s2][m2 + c2t] && B1t == U2[s2][m2 + U2t])for(c2=N2;B1t <= c2;c2--)if(b1t < U2[s2][s2t + c2 + U2t]){U2[s2][s2t + c2 + U2t]=U2[s2][s2t + c2 + U2t] - b1t;break;}for(c2=N2;c2 <= O2;c2++)if(B1t == U2[Z2=s2][s2t + c2 + c2t]){for((L2=B1t,S2=Z2 - b1t);B1t <= S2;S2--)if((L2++,B1t < U2[S2][s2t + c2 + c2t])){U2[S2][s2t + c2 + c2t]=L2;break;}if(B1t == U2[Z2 + b1t][s2t + c2 + c2t])for((L2=B1t,S2=Z2 + b1t,b2=U2.length);S2 < b2 && B1t == U2[S2][s2t + c2 + c2t];S2++)(this.DelProperty(U2[S2],[s2t + c2 + c2t]),this.DelProperty(U2[S2],[s2t + c2 + U2t]));}for((A2=B1t,j2=s2);;j2++){for((A2++,c2=N2);c2 <= O2;c2++)(Y2=c2 == N2?O2 - N2 + b1t:B1t,U2[j2][s2t + c2 + c2t]=B1t,U2[j2][s2t + c2 + U2t]=Y2);if(U2[j2] == t2)break;}for(c2=N2;c2 <= O2;c2++)U2[s2][s2t + c2 + c2t]=A2;}},M._getDown2Excel=function(v2,V5){var k7t="SumStartRow";var X7t="SheetDesign";var W7t="TopBackColor";var m7t="NumberExMode";var i7t="BottomHeight";var y7t="SumEndRow";var Q7t="ReportXML";var O2t="|visible|";var H2t="SheetFontName";var u7t="TopFontName";var c7t="FootRow";var d7t="SumRow";var b7t="TopAlign";var B7t="TopText";var S7t="DownRowSpan";var j7t="AppendPrevSheet";var t2t="color";var i2t="SumBackColor";var o7t="MergeMode";var L7t="NumberFormatMode";var T7t="BottomFontSize";var z7t="Palette";var W2t="ExcelFontSize";var E2t="16777215";var E7t="TopFontSize";var A2t=" .";var Z2t="_IBCT";var v7t="TopFontBold";var e2t="SheetFontSize";var x7t="BottomFontBold";var r7t="BottomFontUnder";var g7t="BottomBackColor";var h2t="HeaderBackColor";var D5t="UserMerge";var e7t="BottomText";var Y7t="ImageProcessType";var V5t="PrintSetup";var D7t="AutoSizeColumn";var T2t="HeaderFontColor";var h7t="BottomAlign";var K7t="BottomFontName";var B2t="background-color";var a7t="TopFontColor";var Q5t="BottomBorder";var m2t="_IBCC";var s7t="ColMerge";var l7t="TextToGeneral";var C7t="BottomFontColor";var g2t="DownCombo";var D3t=255;var f7t="ComboValidation";var N7t="SheetNo";var F7t="TopFontUnder";var O7t="ImageList";var R7t="ColVisibles";var p7t="SubSumRow";var t7t="TopHeight";var U7t="TempFile";var b2t="SumCell";var A7t="ExcelHeaderRowHeight";var H7t="TopBorder";var Y2t="CellHeader";var Z7t="UseFormula";var o5t="CellFormula";var C2t="SheetName";var K2t="ExcelRowHeight";var T2,M7,W2,o5,z5,I5,g2,L7,q5,O7,p7,w5,P7,C2=[],m7=N3t,G7=[],R7=b1t,E2=N3t,k7=N3t,H2=!b1t,Q7=this,c7=B1t,D7=!b1t,r2=N3t,U7=N3t,K2=[],V7=B1t,S7=B1t,Z7=B1t,l7=L6t != v2.downRows,o7=O2t == (v2.downRows + N3t).toLowerCase(),s7=v2.downHeader && v2.merge,y7=!v2.onlyHeaderMerge,n7=v2.treeLevel,F2=B1t,i2=B1t,z7=B1t,A7=[],Y7=[],B7=[],b7=[],h2=N3t,a2=N3t,I7=N3t,q7=N3t,J5=(this.Cols,this.ImageList),t7=[],u2={},E7=N3t,v7=N3t,F7=N3t,u7=N3t,x2=N3t,a7=N3t,W7=N3t,H7=N3t,h2=N3t,e7=N3t,h7=N3t,i7=N3t,T7=N3t,x7=N3t,r7=N3t,K7=N3t,C7=N3t,g7=N3t,X7=N3t,X7=N3t,Q5=N3t,N7=B1t,j7=B1t,w7=[];for((this.g_excelPaletteList=N3t,b1t != v2.sheetDesign && t1t != v2.sheetDesign || (H2=!B1t),M7=(K2=this.MultiRecord && b1t & this.MultiRecordShape?this._DownMultiMap[B1t]:this._getDownColNames(v2)).length,F2=B1t);F2 < this.DataRows;F2++)for((g2=this.Cols,i2=B1t);i2 < M7;i2++)(r2=(T2=(this.MultiRecord && b1t & this.MultiRecordShape?this._DownMultiMap[F2]:K2)[i2]) && g2[T2] && g2[T2].EnumKeys?(N3t + g2[T2].EnumKeys).substring(b1t):void B1t,U7+=this._makeColumnTag(c7 + m2t,void B1t !== r2?r2:N3t),void B1t !== r2 && D3t < r2.length && (z7=b1t),r2=T2 && g2[T2] && g2[T2].Enum?(N3t + g2[T2].Enum).substring(b1t):void B1t,U7+=this._makeColumnTag(c7 + Z2t,void B1t !== r2?r2:N3t),c7++,void B1t !== r2 && D3t < r2.length && (z7=b1t));if((E2+=U7,b1t === z7 && (v2.comboValidation=B1t),B1t == M7))return (this.hideMessage(),IBSheet.OnDownFinish && IBSheet.OnDownFinish(this,b3t,!b1t),-b1t);if((h2=this.GetHeaderBackColor(),a2=this.GetSumBackColor(),x2=this.GetHeaderFontColor(),N3t == h2 && (h2=-b1t == (h2=Q._ibsUtil.getWebColor(this._getCCSStylesheetRuleStyle(A2t + this.GetTheme() + Y2t,B2t)))?N3t:h2),N3t == a2 && (a2=-b1t == (a2=Q._ibsUtil.getWebColor(this._getCCSStylesheetRuleStyle(A2t + this.GetTheme() + b2t,B2t)))?N3t:a2),N3t == x2 && (x2=-b1t == (x2=Q._ibsUtil.getWebColor(this._getCCSStylesheetRuleStyle(A2t + this.GetTheme() + Y2t,t2t)))?N3t:x2),h2=h2.replace(/#/g,N3t),a2=a2.replace(/#/g,N3t),x2=x2.replace(/#/g,N3t),I7=parseInt(h2,T1t),q7=parseInt(a2,T1t),headerFontColorInt=parseInt(x2,T1t),I7=isNaN(I7)?E2t:I7,q7=isNaN(q7)?E2t:q7,headerFontColorInt=isNaN(headerFontColorInt)?E2t:headerFontColorInt,this._addExcelPaletteList(a2),this._addExcelPaletteList(h2),this._addExcelPaletteList(x2),this.ExcelXH=[],this.ExcelXB=[],this.ExcelXF=[],this.ExcelColsMap={},a2={from:b3t,cfg:v2,sheetDesign:H2,isTreeLevel:n7,isDownRows:l7,isDownRowVisible:o7,rowHeights:G7,downColNames:K2,downColNamesLength:M7,data:C2,p:R7,headerRows:S7,isHeaderMerge:s7},v2.merge)){for((F2=B1t,z7=this.getCols().length);F2 < z7;F2++){if((D7=!b1t,T2=this.getCols()[F2],this.Cols[T2].Visible))for(i2=B1t;i2 < M7;i2++)T2 == K2[i2] && (D7=!B1t);else for((D7=!B1t,i2=B1t);i2 < M7;i2++)if(T2 == K2[i2]){D7=!b1t;break;}if(!(L7=D7))break;}if(((Q.g_isDirectDown2Excel || l7 && !o7 || v2.downRowSpan) && (y7=!b1t),v2t == this.MainCol && (y7=!b1t),V7=B1t,v2.downHeader || (V7=this.getHeaderRows().length),this.Rows.FormulaRow && F2t == this.Rows.FormulaRow.Fixed && this.Rows.FormulaRow.Visible && !v2.downSum && V7++,this.Rows.Filter && this.Rows.Filter.Visible && V7++,(a2.isSameDownColAndVisible=L7) && (B1t != this.SearchMode || l7 && !o7 || !this.MergeVisibleDom && (B1t != this.RowIndexMap.length || this.MainTag.offsetHeight && this.MainTag.offsetWidth)) || (this.MergeAllRanges=!B1t),s7 && this.MergeAllRanges))for(var l5=this.getHeaderRows(),F2=B1t;F2 < l5.length;F2++)this.SetRowAutoMerge(l5[F2],this.HeaderMerge,K2);if(!Q.g_isDirectDown2Excel && this.MergeAllRanges){if((!this.ExLoad || !this.CalcMergeMode && (B1t != this.RowIndexMap.length || this.MainTag.offsetHeight && this.MainTag.offsetWidth) || (P7=this.RowIndexMap,this.UpdateRowIndex()),y7)){(B1t != this.SearchMode || this.MergeVisibleDom || this.SplitDataAutoMerge(),this.MergeAllRanges && !l7 && (this.RowsMergeRow=this.getDataRows()));for(var J7=o7?this.getFirstVisibleRow():this.getFirstRow(J3t,W1t);J7;J7=o7?this.getNextVisibleRow(J7):this.getNextRow(J7))this.SetRowAutoMerge(J7,this.DataMerge,K2);B1t != this.SearchMode || this.MergeVisibleDom || (Q7=this,setTimeout(function(){(this.MergeAllRanges=!B1t,Q7.SetDataAutoMerge(),delete this.MergeAllRanges);},l3t));}(J3t != P7 && (this.RowIndexMap=P7),delete this.RowsMergeRow);}}for((v2.downHeader && (W2=this._getHeaderData(a2),a2.p=W2.p,R7=W2.p,a2.headerRows=W2.headerRows,Z7=W2.headerRows),b1t != Q.g_isDirectDown2Excel && (R7=(W2=this._getBodyData(a2)).p,C2=W2.data,S7=W2.headerRows,G7=W2.rowHeights,A7=W2.sumRow,Y7=W2.subSumRow,B7=W2.cumulateRow,b7=W2.footRow,w7=W2.formulas),l7=(H2=this._getColInfo(v2,K2,n7)).saveName,P7=H2.align,a2=H2.type,W2=H2.format,n7=H2.orgFormat,o5=H2.width,z5=H2.visible,I5=H2.datePattern,w5=H2.formulaRow,H2=H2.colMerge,v2.merge && (m7=this._getExcelMergeInfo(K2,s7,y7,S7,L7,V7,v2.downSum)),F2=B1t,q5=J5.length);F2 < q5;F2++)(O7=F2,-b1t != (p7=this.GetImageList(O7)) && (p7=Q._ibsUtil.getFullPath(p7),t7.push(O7 + j3t + p7)));(v2.header && G9t == typeof v2.header && (E7=(u2=this._getTitleConfig(v2.header)).text,v7=u2.align,F7=u2.height,u7=u2.fontBold,x2=u2.fontColor,a7=u2.fontName,W7=u2.fontSize,H7=u2.fontUnderline,h2=u2.backColor,e7=u2.border,N7=!B1t),v2.footer && G9t == typeof v2.footer && (h7=(u2=this._getTitleConfig(v2.footer)).text,i7=u2.align,T7=u2.height,x7=u2.fontBold,r7=u2.fontColor,K7=u2.fontName,C7=u2.fontSize,g7=u2.fontUnderline,X7=u2.backColor,Q5=u2.border,j7=!B1t),this.ExcelXH=J3t,this.ExcelXB=J3t,this.ExcelXF=J3t,this.fileDownloadCheckToken=new Date().getTime(),Q.g_isDown2ExcelBuffer?Q.g_isDown2ExcelBufferToken?this.fileDownloadCheckToken=Q.g_isDown2ExcelBufferToken:Q.g_isDown2ExcelBufferToken=this.fileDownloadCheckToken:Q.fileDownloadCheckTimer=o.setInterval(function(){Q7._getCookie(Z6t) == Q7.fileDownloadCheckToken && (Q7.fileDownloadCheckToken=J3t,Q7._finishDownload());},l3t),E2+=this._makeColumnTag(u2t,this.fileDownloadCheckToken),(k7=location.href.substring(location.href.indexOf(S9t) + t1t).split(a2t))[B1t]=N3t,k7[k7.length - b1t]=N3t,B1t < v2.excelFontSize && (E2+=this._makeColumnTag(W2t,v2.excelFontSize)),b1t != v2.sheetDesign && t1t != v2.sheetDesign || (E2=(E2=(E2=(E2=(E2+=this._makeColumnTag(H2t,this.GetSheetFontName())) + this._makeColumnTag(e2t,this.GetSheetFontSize())) + this._makeColumnTag(h2t,I7)) + this._makeColumnTag(i2t,q7)) + this._makeColumnTag(T2t,headerFontColorInt)),E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2+=this._makeColumnTag(x2t,k7.join(a2t))) + this._makeColumnTag(r2t,Q._ibsUtil.getFileName(v2.fileName,m6t))) + this._makeColumnTag(v6t,v2.extendParam)) + this._makeColumnTag(K2t,v2.excelRowHeight)) + this._makeColumnTag(C2t,v2.sheetName)) + this._makeColumnTag(g2t,v2.downCombo)) + this._makeColumnTag(Q7t,v2.reportXML)) + this._makeColumnTag(l7t,v2.textToGeneral?b1t:B1t)) + this._makeColumnTag(M7t,v2.wordWrap?b1t:B1t)) + this._makeColumnTag(D7t,v2.autoSizeColumn?b1t:B1t)) + this._makeColumnTag(V7t,P7)) + this._makeColumnTag(o2t,m7)) + this._makeColumnTag(o7t,v2.merge)) + this._makeColumnTag(K6t,l7)) + this._makeColumnTag(z7t,this.g_excelPaletteList)) + this._makeColumnTag(a6t,Z7)) + this._makeColumnTag(I7t,a2)) + this._makeColumnTag(q7t,W2)) + this._makeColumnTag(w7t,n7)) + this._makeColumnTag(D2t,I5)) + this._makeColumnTag(f2t,w5)) + this._makeColumnTag(J7t,o5)) + this._makeColumnTag(P7t,G7.join(j6t))) + this._makeColumnTag(R7t,z5)) + this._makeColumnTag(k7t,B1t)) + this._makeColumnTag(y7t,B1t)) + this._makeColumnTag(n7t,v2.downHeader?b1t:B1t)) + this._makeColumnTag(X7t,B1t < v2.sheetDesign && v2.sheetDesign < v1t?v2.sheetDesign:B1t)) + this._makeColumnTag(f7t,v2.comboValidation?b1t:B1t)) + this._makeColumnTag(d7t,A7.join(f9t))) + this._makeColumnTag(p7t,Y7.join(f9t))) + this._makeColumnTag(G7t,B7.join(f9t))) + this._makeColumnTag(c7t,b7.join(f9t))) + this._makeColumnTag(U7t,v2.tempFile)) + this._makeColumnTag(S7t,v2.downRowSpan)) + this._makeColumnTag(s7t,H2),v2.tempFile && (E2=(E2=(E2+=this._makeColumnTag(N7t,v2.sheetNo)) + this._makeColumnTag(W6t,v2.startRow)) + this._makeColumnTag(e6t,v2.startCol)),E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2+=this._makeColumnTag(w2t,this._encodeBase64(v2.workbookPassword))) + this._makeColumnTag(j7t,v2.appendPrevSheet)) + this._makeColumnTag(L7t,v2.numberFormatMode)) + this._makeColumnTag(O7t,t7.join(j6t))) + this._makeColumnTag(j7t,v2.appendPrevSheet)) + this._makeColumnTag(m7t,v2.numberExMode?b1t:B1t)) + this._makeColumnTag(Z7t,v2.useFormula?b1t:B1t)) + this._makeColumnTag(A7t,v2.excelHeaderRowHeight)) + this._makeColumnTag(Y7t,v2.imageProcessType),N7 || j7?(N7 && (E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2+=this._makeColumnTag(B7t,E7)) + this._makeColumnTag(b7t,v7)) + this._makeColumnTag(t7t,F7)) + this._makeColumnTag(E7t,W7)) + this._makeColumnTag(v7t,u7)) + this._makeColumnTag(F7t,H7)) + this._makeColumnTag(u7t,a7)) + this._makeColumnTag(a7t,x2 || GetStyle(this.getCell(this.Header,this.GetFirstColA())).color)) + this._makeColumnTag(W7t,h2)) + this._makeColumnTag(H7t,e7)),j7 && (E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2=(E2+=this._makeColumnTag(e7t,h7)) + this._makeColumnTag(h7t,i7)) + this._makeColumnTag(i7t,T7)) + this._makeColumnTag(T7t,C7)) + this._makeColumnTag(x7t,x7)) + this._makeColumnTag(r7t,g7)) + this._makeColumnTag(K7t,K7)) + this._makeColumnTag(C7t,r7)) + this._makeColumnTag(g7t,X7)) + this._makeColumnTag(Q5t,Q5))):E2=(E2=(E2+=this._makeColumnTag(l5t,v2.titleText.replace(/\r\n/g,this.IB_DELIMITER_TITLE_NEWLINE).replace(/\|/g,this.IB_DELIMITER_TITLE_BACKSLASH))) + this._makeColumnTag(M5t,v2.titleAlign.toLowerCase())) + this._makeColumnTag(D5t,v2.userMerge));var M5=N3t;if(v2.printSetup && G9t == typeof v2.printSetup){var f7,D5=B1t;for(f7 in v2.printSetup)(M5+=(B1t < D5?j6t:N3t) + (f7.charAt(B1t).toUpperCase() + f7.slice(b1t,f7.length)) + j3t + v2.printSetup[f7] + N3t,D5+=b1t);}E2+=this._makeColumnTag(V5t,M5);var d7=N3t;if(v2.useFormula && B1t < w7.length)for(F2=B1t;F2 < w7.length;F2++)(B1t < F2 && (d7+=d9t),d7=(d7+=w7[F2].SaveName) + (this.IB_DELIMITER_COL + w7[F2].Formula));if((E2=(E2+=this._makeColumnTag(o5t,d7)) + this.IB_DELIMITER_ROW,C2[B1t]=E2,Q.g_isDown2ExcelBuffer))(C2[R7++]=this.IB_DELIMITER_SHEET,Q.g_down2ExcelBuffer+=C2.join(N3t),Q.g_Multipart=v2.multipart);else {if(v2.debugMode)return C2.join(N3t);V5 && V5(C2.join(N3t));}delete this.MergeAllRanges;},M._getExcelMergeInfo=function(j5,B5,b5,m5,t5,v5,E5){var P5,X5,d5,k5,G5,L5,y5=[],Z5={},p5=B1t,c5=B1t,s5=[],A5={};(this.Rows.FormulaRow && this.Rows.FormulaRow.Visible && this.Rows.FormulaRow.Fixed,this.Rows.Filter.Visible,this.getHeaderRows().length);(this.ExcelCol=[],this.ExcelColMerge=[],s5=this.getCols(),this.Cols[this.RowIndex || z5t].Visible || s5.shift());for(p5=B1t;p5 < s5.length;p5++)A5[s5[p5]]=p5;for((P5=B1t,d5=j5.length);P5 < d5;P5++)(this.ExcelCol.push(s2t + (P5 + b1t)),this.ExcelColMerge.push(j5[P5]?this.Cols[j5[P5]].ColMerge:void B1t),Z5[j5[P5]]=P5);if(B5)for((this._excelHeaderMergeRange(),P5=B1t,d5=this.ExcelXH.length);P5 < d5;P5++)if(f2t !== (k5=this.ExcelXH[P5]).id && I5t != k5.id)for((X5=B1t,c5=this.ExcelCol.length);X5 < c5;X5++){var R5,f5=P5,n5=(R5=this.ExcelCol[X5]).substr(b1t,R5.length) - b1t,U5=k5[R5 + c2t],S5=k5[R5 + U2t];B1t < U5 && B1t < S5?(y5.push(f5 + f9t + n5),y5.push(f5 + U5 - b1t + f9t + (n5 + S5 - b1t) + j6t)):this.MultiRecord && b1t & this.MultiRecordShape && (b1t < k5[R5 + c2t] || b1t < k5[R5 + U2t]) && (y5.push(f5 + f9t + n5),y5.push(f5 + (b1t < k5[R5 + c2t]?k5[R5 + c2t] - b1t:B1t) + f9t + (n5 + (b1t < k5[R5 + U2t]?k5[R5 + U2t] - b1t:B1t)) + j6t));}if(b5)for((b1t < this.DataRows && E1t == this.DataMergeAction?this._excelDataFixedMergeRange():this._excelDataMergeRange(),P5=G5=B1t,d5=this.ExcelXB.length);P5 < d5;P5++)if(f2t !== (k5=this.ExcelXB[P5]).id && I5t != k5.id){for((X5=B1t,c5=this.ExcelCol.length);X5 < c5;X5++){(f5=G5 + m5,n5=(R5=this.ExcelCol[X5]).substr(b1t,R5.length) - b1t);(U5=k5[R5 + c2t],S5=k5[R5 + U2t]);B1t < U5 && B1t < S5?(y5.push(f5 + f9t + n5),y5.push(f5 + U5 - b1t + f9t + (n5 + S5 - b1t) + j6t)):this.MultiRecord && b1t & this.MultiRecordShape && (b1t < U5 || b1t < S5) && (y5.push(f5 + f9t + n5),y5.push(f5 + (b1t < U5?U5 - b1t:B1t) + f9t + (n5 + (b1t < S5?S5 - b1t:B1t)) + j6t));}G5++;}if(E5)if((L5=(L5=B1t) == this.GetAutoSumPosition()?m5 - b1t:this.ExcelXB.length + m5,t5))for((P5=G5=B1t,d5=this.ExcelXF.length);P5 < d5;P5++){for((k5=this.ExcelXF[P5],X5=B1t,c5=this.ExcelCol.length);X5 < c5;X5++)if((f5=G5 + L5,n5=(R5=this.ExcelCol[X5]).substr(b1t,R5.length) - b1t,B1t < k5[R5 + c2t] && B1t < k5[R5 + U2t])){var N5=k5[R5 + U2t],Y5=n5 + N5;if(B1t < k5[R5 + U2t])for(p5=t1t;p5 <= k5[R5 + U2t];p5++){var O5=k5[s2t + (n5 + p5) + S2t];O5 && O5.substr(b1t,O5.length) > Y5 && N5--;}B1t < k5[R5 + c2t] && B1t < N5 && (y5.push(f5 + f9t + n5),y5.push(f5 + k5[R5 + c2t] - b1t + f9t + (n5 + N5 - b1t) + j6t));}G5++;}else for((P5=G5=B1t,d5=this.ExcelXF.length);P5 < d5;P5++){for((k5=this.ExcelXF[P5],X5=B1t,c5=this.ExcelCol.length);X5 < c5;X5++)(f5=G5 + L5,n5=(R5=this.ExcelCol[X5]).substr(b1t,R5.length) - b1t,B1t < k5[R5 + c2t] && B1t < k5[R5 + U2t] && (y5.push(f5 + f9t + n5),y5.push(f5 + k5[R5 + c2t] - b1t + f9t + (n5 + k5[R5 + U2t] - b1t) + j6t)));G5++;}for(P5=B1t;P5 < y5.length;P5+=t1t)y5[P5].replace(/\|/g,N3t) == y5[P5 + b1t].replace(/\|/g,N3t) && y5.splice(P5,t1t);return ((y5=(y5=y5.join(f9t)).replace(/\|\,/g,N6t)) && j6t == y5.substring(y5.length - b1t) && (y5=y5.substring(B1t,y5.length - b1t)),this.ExcelXH=J3t,this.ExcelXB=J3t,this.ExcelXF=J3t,this.ExcelCol=J3t,this.ExcelColMerge=J3t,y5);},M._getExcelRowHeight=function(F5,u5){F5=this.GetExcelRowHeight(F5,u5);return F5=B1t != F5 && F5 != this.InvalidValue?F5:this.GetDataRowHeight();},M._getStringExcel=function(W5,H5,Q4,r5,T5){var c5t=/\-/;var N5t="CODE";var X5t="***";var P5t="BLANK";var Z5t="GR";var U5t=/\:/;var L5t="g";var G5t=/\-|\/|\./;var l4,e5,K5=B1t,C5=N3t,a5=N3t,g5=!b1t,i5=this.getAttribute(W5,H5,q5t) || this.getAttribute(W5,H5,w5t),h5=this.getType(W5,H5);if(J5t == T5)return x5(this._getCellText(W5,H5));if(this._isNumberType(h5) && !r5.numberTypeToText && (a5=this._getCellValue(W5,H5),H5 && H5 == (this.RowIndex || z5t) && !a5 && (!W5.Visible || W5.Hidden?a5=P5t:J3t != this.ExLoadSEQ && (a5=++this.ExLoadSEQ)),a5=x5(a5),this.MainCol !== H5))return a5;if(Q4){if(R5t === (h5=k5t == h5 && (this.getAttribute(W5,H5,y5t) || this.getAttribute(W5,H5,n5t))?y5t:h5))return X5t;if((f5t == h5 && (T5=J3t,e5=a5=this._getCellValue(W5,H5),(N3t + (i5=(i5=i5 || this.getAttribute(W5,H5,d5t) || this.DateFormat || this.getAttribute(W5,H5,u6t) || this.DataFormat) && i5.replace(/[h]/g,p5t))).match(G5t) && (T5=i5.replace(/\-|\/|\./gi,N3t),e5=e5.replace(/\-|\/|\./gi,N3t)),e5=Q.stringToDate(N3t + e5,a5.match(c5t) || !T5 && e5.match(U5t)?J3t:T5 || i5),B9t == typeof (a5=isNaN(e5)?a5:e5) && a5.match(U5t) && (e5=Q.stringToDate(a5,S5t),isNaN(e5) || (a5=e5)),B9t == typeof (a5=Q.dateToString(a5,i5)) && (a5=this._removeHTMLTag(a5))),s5t === h5))return this.Grouped && this.GroupTreeCols && this.GroupTreeCols[H5] && !W5.Def.Group?N3t:y6t == this.getValue(W5,H5)?r5.checkBoxOnValue:r5.checkBoxOffValue;if((y5t === h5 && (N5t == r5.downCombo?(a5=x5(this._getCellValue(W5,H5)),g5=!B1t):a5=x5(this._getCellText(W5,H5))),j5t === h5))if((a5=this._getCellText(W5,H5),!Q._ibsUtil.isEmpty(a5)))return (T5=a5.charAt(B1t),a5=a5.split(T5)[b1t],(a5=Q._ibsUtil.getFullPath(a5)).replace(new RegExp(Q._ibsUtil.escapeRegExp(Q._ibsUtil.getDomain()),L5t),N3t));if(O5t === h5)return this._getCellText(W5,H5);if(m5t === h5)return this._removeHTMLTag(this._getCellText(W5,H5));}if((B1t == W5.id.indexOf(Z5t) && H5 == this.GroupMain && X2t == W5.Kind?(e5=E9t == typeof this.getSpanned?this.getSpanned(W5,H5):this.getMergeRange(W5,H5),a5=this._getCellText(e5[B1t],e5[b1t])):g5 || (a5=this._getCellText(W5,H5)),N3t == a5 && (W5.SubSumRow || W5.CumulateRow) && A5t == this.Cols[H5].Type))return x5(W5[H5]);if(Q4 && this.MainCol == H5){for((K5=B1t,l4=+W5.Level);K5 <= l4;K5++)C5+=this.IB_DELIMITER_TREE_INDENT;a5=C5 + a5;}function x5(M4){return M4=B9t == typeof M4?M4.replace(/[\x00]/g,N3t):M4;}return x5(a5);},M._sendDown=function(n4,y4,J4,P4,c4,z4,R4,G4,X4,U4,S4,f4){var F5t="IBSheetDown2ExcelFrm";var Y5t="IBSheetDown2ExcelFrame";var g5t="load";var V4,D4,o4,d4,p4,I4=Y5t,k4=B1t,q4=N3t,w4=!b1t;if((Q.g_down2ExcelBuffer=J3t,R4))return (this.hideMessage(),n4 + this.IB_DELIMITER_END);if((b3t == z4?q4=b1t == Q.g_isDirectDown2Excel?B5t:b5t:F3t == z4?q4=t5t:E5t == z4 && (q4=v5t),X4 || f4 && G9t == typeof f4))this._xhrSendDown(n4,y4,U4,z4,q4,S4,f4);else {if(((D4=V.getElementById(F5t)) && V.body.removeChild(D4),(D4=V.createElement(u5t)).id=F5t,D4.method=a5t,c4 && (D4.encoding=W5t,D4.enctype=W5t),(o4=V.createElement(H5t)).type=e5t,o4.name=X2t,o4.value=n4 + this.IB_DELIMITER_END,D4.appendChild(o4),P4=void B1t === (P4=void B1t === J4?N3t:P4)?h5t:P4.toLowerCase(),R4=y4,R4+=(B1t <= y4.indexOf(i5t)?T5t:i5t) + x5t + q4,r5t == P4)){if((D4.action=R4,J4))for((p4=J4.split(T5t),k4=B1t);k4 < p4.length;k4++)(d4=(p4[k4] + j3t).split(j3t),(o4=V.createElement(H5t)).type=e5t,o4.name=d4[B1t],o4.value=d4[b1t],D4.appendChild(o4));}else D4.action=R4 + (N3t != J4?T5t:N3t) + J4;((V4=V.createElement(K5t)).name=I4,V4.id=I4,V4.width=C5t,V4.height=C5t,V4.addEventListener(g5t,(function(){G4 && o.setTimeout((function(){Q.fileDownloadCheckTimer && (o.clearInterval(Q.fileDownloadCheckTimer),Q.fileDownloadCheckTimer=J3t,V4.parentNode.removeChild(V4),this.hideMessage(),this.showMessageTime(this.Lang.Alert.ResultErrUnknown));}).bind(this),G4);}).bind(this)),D4.target=I4,D4.appendChild(V4),V.body.appendChild(D4),D4.style.display=Q4t,D4.style.width=C5t,D4.style.height=C5t,o.frames[I4].name=I4,X4=this._checkCrossDomain(y4),(w4=Q.OnBeforeDownload?Q.OnBeforeDownload(this,z4,D4):w4) || b3t != z4 || Q.OnReadyExcelDown && (w4=Q.OnReadyExcelDown(this,D4)),w4 || D4.submit(),!Q.fileDownloadCheckTimer || this.fileDownloadCheckToken && !X4 || (o.clearInterval(Q.fileDownloadCheckTimer),Q.fileDownloadCheckTimer=J3t,this.hideMessage(),!w4 && IBSheet.OnDownFinish && IBSheet.OnDownFinish(this,z4,!B1t)));}},M._xhrSendDown=function(Y4,Z4,A4,B4,b4,j4,L4){var N4=new FormData(),m4=!b1t,O4=Z4,s4=(O4+=(B1t <= Z4.indexOf(i5t)?T5t:i5t) + x5t + b4,j4 && G9t == typeof j4 && Object.keys(j4).forEach(function(t4,E4){N4.append(t4,j4[t4]);}),new XMLHttpRequest());(s4.open(r5t.toUpperCase(),O4),L4 && G9t == typeof L4 && Object.keys(L4).forEach(function(v4,F4){s4.setRequestHeader(v4,L4[v4]);}),s4.responseType=l4t,s4.onload=function(W4){var V4t="tempAnchor";var M4t="#tempAnchor";var u4,a4=s4.response;IBSheet.BIEA10 || IBSheet.BIEA11?o.navigator.msSaveBlob(a4,A4):(a4=URL.createObjectURL(a4),u4=J3t,(u4=V.querySelector(M4t)?V.querySelector(M4t):V.createElement(D4t)).id=V4t,u4.style.display=Q4t,V.body.append(u4),u4.href=a4,u4.download=A4,u4.click(),u4.href=N3t,u4.download=N3t,URL.revokeObjectURL(O4));},s4.onerror=function(H4){(this.hideMessage(),this.showMessageTime(this.Lang.Alert.ResultErrUnknown));},N4.append(X2t,Y4),Q.OnBeforeDownload && (m4=Q.OnBeforeDownload(this,B4,N4)));try{m4?this.hideMessage():s4.send(N4);}catch(e4){}},M.Down2Hml=function(h4){var I4t="landscape";var z4t="_IBSheet";var q4t="Down2Hml.jsp";var i4,K4=this,r4=N3t,T4=N3t,x4=f6t;return (this.showMessage(this.getMessage(k6t)),h4=Q._ibsUtil.cloneArray(h4),i4=this.Down2HmlConfig || ({}),this._prepareExportSetting(),G9t == typeof h4.title && (T4=h4.title.text,x4=h4.title.align),h4.title || G9t != typeof h4.Title || (T4=h4.Title.Text,x4=h4.Title.Align),h4.docOrientation=this._getDefault(h4.docOrientation || h4.DocOrientation,i4.docOrientation || o4t),h4.downCols=this._getDefault(h4.downCols || h4.DownCols,i4.downCols || N3t),h4.downSum=this._getDefault(h4.downSum || h4.DownSum,i4.downSum || b1t),h4.extendParam=this._getDefault(h4.extendParam || h4.ExtendParam,i4.extendParam || N3t),h4.fileName=this._getDefault(h4.fileName || h4.FileName,i4.fileName || z4t),h4.titleAlign=this._getDefault(x4,i4.titleAlign || f6t),h4.titleText=this._getDefault(T4,i4.titleText || N3t),I4t !== h4.docOrientation.toLowerCase() && (h4.docOrientation=o4t),h4.downTreeHide=!b1t,r4=void B1t !== this.Source.Down2Hml.Url?this.Source.Down2Hml.Url:q4t,this._getDown2Hml(h4,function(C4){K4._sendDown(C4,r4,h4.extendParam,r5t,b1t,J5t);}));},M.GetDown2HmlUrl=function(){var g4=N3t;return g4=this.Source.Down2Hml.Url?this.Source.Down2Hml.Url:g4;},M.SetDown2HmlUrl=function(Q0){(this.Source.Down2Hml || (this.Source.Down2Hml={}),this.Source.Down2Hml.Url=Q0);},M._getDown2Hml=function(V0,J0){var J4t="DocOrientation";var w4t="hml";var P0,R0,k0,y0,z0,D0,o0=[],w0=[],l0=N3t,I0=N3t,q0=this,M0={};return B1t == (D0=(z0=this._getDownColNames(V0)).length)?(this.hideMessage(),IBSheet.OnDownFinish && IBSheet.OnDownFinish(this,J5t,!b1t),-b1t):(D0=this._getHeaderData(M0={from:J5t,cfg:V0,sheetDesign:B1t,isTreeLevel:B1t,isDownRows:B1t,isDownRowVisible:B1t,rowHeights:[],downColNames:z0,downColNamesLength:D0,data:o0,p:b1t,headerRows:B1t,isHeaderMerge:B1t}),M0.p=D0.p,D0.p,M0.headerRows=D0.headerRows,P0=D0.headerRows,(D0=this._getBodyData(M0)).p,o0=D0.data,w0=D0.rowHeights,D0=(M0=this._getColInfo(V0,z0,B1t)).type,z0=M0.format,R0=M0.orgFormat,y0=M0.width,k0=M0.align,M0=M0.datePattern,this.fileDownloadCheckToken=new Date().getTime(),Q.fileDownloadCheckTimer=o.setInterval(function(){q0._getCookie(Z6t) == q0.fileDownloadCheckToken && (q0.fileDownloadCheckToken=J3t,q0._finishDownload(J5t));},l3t),l0+=this._makeColumnTag(u2t,this.fileDownloadCheckToken),(I0=location.href.substring(location.href.indexOf(S9t) + t1t).split(a2t))[B1t]=N3t,I0[I0.length - b1t]=N3t,l0=(l0=(l0=(l0=(l0=(l0=(l0=(l0=(l0=(l0=(l0=(l0=(l0=(l0=(l0+=this._makeColumnTag(x2t,I0.join(a2t))) + this._makeColumnTag(r2t,Q._ibsUtil.getFileName(V0.fileName,w4t))) + this._makeColumnTag(v6t,V0.extendParam)) + this._makeColumnTag(a6t,P0)) + this._makeColumnTag(I7t,D0)) + this._makeColumnTag(q7t,z0)) + this._makeColumnTag(w7t,R0)) + this._makeColumnTag(D2t,M0)) + this._makeColumnTag(V7t,k0)) + this._makeColumnTag(J7t,y0)) + this._makeColumnTag(P7t,w0.join(j6t))) + this._makeColumnTag(l5t,V0.titleText.replace(/\r\n/g,this.IB_DELIMITER_TITLE_NEWLINE).replace(/\|/g,this.IB_DELIMITER_TITLE_BACKSLASH))) + this._makeColumnTag(M5t,V0.titleAlign.toLowerCase())) + this._makeColumnTag(J4t,V0.docOrientation.toLowerCase())) + this.IB_DELIMITER_ROW,o0[B1t]=l0,V0.debugMode || V0.DebugMode?(this.hideMessage(),o0.join(N3t)):void (E9t == typeof J0 && J0(o0.join(N3t))));},M.Down2Pdf=function(X0){var X4t="wkhtmltopdf";var k4t="unset";var n4t="itextpdf";var P4t="clone";var y4t="converter";X0=X0 || ({});var n0=this.GetFnLib(P4t),f0=this.GetFnLib(h5t),p0=this.GetFnLib(R4t),d0=this.GetFnLib(k4t),n0=n0(X0) || ({}),f0=f0(n0,y4t) || n4t;return (d0(n0,y4t),d0=X4t === f0?this.GetWKHtml2PDF(n0):this.GetITextHtml2PDF(n0),n0.finish=d0,p0(X0=new Object(),f4t,n0),this.doPrint(X0));},M.GetDown2PdfUrl=function(){var G0=N3t;return G0=this.Source.Down2Pdf.Url?this.Source.Down2Pdf.Url:G0;},M.GetITextHtml2PDF=function(U0){var Y4t="Paper";function b0(r0,K0,C0){return s0(r0,K0)?H0(r0,K0):J3t != C0?C0:void B1t;}var E4t="DPI";function x0(I8){var q8=b0(I8,V0t),w8=u0([o0t,[z0t,I0t]],function(P8){e0(P8) && (P8=[P8,P8]);var R8=b0(q8,P8[B1t]);return J3t == R8?N3t:(F0(R8) && (R8=R8.join(N6t)),P8[b1t] + q0t + R8 + Y9t);}),J8=(function(){var w0t='style="font-family:';var k8=j0(u4t);if(J3t == k8)return N3t;var y8=j0(W4t,N3t);return v0(k8,c9t,[w0t + Y0 + J0t + y8 + Y9t]) + P0t;})(),I8=b0(I8,R0t,N3t);return v0(J8+=I8=I8.length?I8.replace(new RegExp(k0t,y0t),P0t).replace(new RegExp(n0t,y0t),N6t).replace(new RegExp(X0t,y0t),f0t).replace(new RegExp(c0.Style + d0t,y0t),N3t).replace(new RegExp(c0.Style + p0t,y0t),N3t):I8,G0t,w8);}var T4t="extendParamMethod";var A4t="paper";var i4t="URL";var t4t="Dpi";var Z4t="wordWrap";var x4t="ExtendParamMethod";var K1t=50;var K4t="ExtendParam]";var m4t="mode";var F4t="FontTo";var B4t="fileName";var a4t="Title";var O4t="DownCols";var W4t="titleStyle";var b4t="dpi";var L4t="downCols";var g4t=2e3;function v0(z8,o8,V8){return l0t + o8 + (V8=J3t != V8?N6t + (V8=F0(V8)?V8.join(N6t).replace(/\s+/g,N6t):V8):N3t) + M0t + z8 + D0t + o8 + M0t;}var z3t=32800;var H4t="TitleStyle";var u4t="title";var c0=this,H0=this.GetFnLib(h5t),N0=this.GetFnLib(R4t),s0=this.GetFnLib(d4t),S0=this.GetFnLib(p4t),e0=this.GetFnLib(G4t),F0=this.GetFnLib(c4t),u0=this.GetFnLib(U4t),h0=this.GetFnLib(S4t),i0=this.GetFnLib(s4t),B0=this.GetFnLib(N4t);var t0=new Object(),m0=B1t,Z0=(c0._prepareExportSetting(),J3t == U0 && (U0={FileName:j4t,objReturn:b1t}),S0([[L4t,O4t],[m4t,T6t],[Z4t,M7t],[A4t,Y4t],[B4t,r2t],[b4t,t4t,E4t],[v4t,F4t],[u4t,a4t],[W4t,H4t],[e4t,h4t,i4t],[T4t,x4t],[r4t,K4t]],function(M8){for(var D8,l8=b1t;l8 < M8.length;l8+=b1t)(D8=M8[l8],s0(U0,D8) && (U0[M8[B1t]]=U0[D8]));}),s0(U0,C4t) && U0.debugMode);function j0(g0,Q8){return b0(U0,g0,Q8);}if((Z0 && this.showMessage(this.getMessage(k6t)),s0(U0,L4t)?m0=b1t:U0.downCols=N3t,s0(U0,m4t) || (U0.mode=B1t),m0)){for(var A0=c0.getCols(),a0=c0._getDownColNames(U0),O0=B1t;O0 < A0.length;O0++){t0[A0[O0]]=!b1t;for(var E0=B1t;E0 < a0.length;E0++)if(A0[O0] === a0[E0]){t0[A0[O0]]=!B1t;break;}}N0(U0,L4t,t0);}var S0=j0(Z4t),S0=c0._getBooleanValue(S0,B1t),T0=(N0(U0,Z4t,S0),c0.PdfWordWrap=S0?b1t:B1t,j0(B4t,j4t)),L0=g4t,W0=(s0(U0,b4t) && (L0=(L0=c0._getNumberValue(U0.dpi,L0)) < K1t?K1t:z3t < L0?z3t:L0),o4t),Y0=(s0(U0,A4t) && (W0=U0.paper?U0.paper.toLowerCase():o4t),Q0t);s0(U0,v4t) && (m0=Y0,N0=(N0=j0(v4t)) && B0(N0),B0=i0(S0={gulim:c0t,gothic:Q0t}),Y0=h0(B0,N0)?S0[N0]:m0);return function(X8){var U0t="Orientation";(Z0 || c0.showMessage(c0.getMessage(k6t)),c0.fileDownloadCheckToken=new Date().getTime(),Q.fileDownloadCheckTimer=setInterval(function(){c0._getCookie(Z6t) == c0.fileDownloadCheckToken && (c0.fileDownloadCheckToken=J3t,c0._finishDownload(E5t));},l3t));var n8=Q._ibsUtil.getFileName,f8=c0._makeColumnTag,n8=u0([[u2t,c0.fileDownloadCheckToken],[r2t,n8(T0,f4t)],[E4t,L0],[U0t,W0]],function(G8){return f8.apply(c0,G8);}),X8=(n8+=c0.IB_DELIMITER_ROW,v0([(function(c8){return (c8=c8 || N3t,v0(c8+=S0t + Y0 + s0t,N0t));})(X8.head || N3t),x0(X8.body || J3t)].join(e9t),R0t,j0t)),n8=[n8,X8].join(e9t);if(Z0)return (c0.hideMessage(),n8);var X8=j0(e4t,c0.Source.Down2Pdf.Url),d8=j0(r4t,N3t),p8=j0(T4t,r5t).toLowerCase();return c0._sendDown(n8,X8,d8,p8,!B1t,E5t,Z0);};},M.GetWKHtml2PDF=function(j8){var Z0t="DebugMode";var m0t="ibleaders/v8";var O0t="https://api.ibleaders.com";function B8(T8,x8){return s8(j8,T8,x8);}var L0t="export/wkhtml2pdf.jsp";function s8(e8,h8,i8){return S8(e8,h8)?E8(e8,h8):J3t != i8?i8:void B1t;}var U8=this,Z8=L0t,t8=[O0t,m0t,Z8].join(a2t),A8=j4t,E8=this.GetFnLib(h5t),v8=this.GetFnLib(R4t),S8=this.GetFnLib(d4t),F8=this.GetFnLib(p4t),u8=this.GetFnLib(G4t),Y8=this.GetFnLib(c4t),a8=this.GetFnLib(U4t),W8=this.GetFnLib(S4t),L8=this.GetFnLib(s4t),O8=this.GetFnLib(N4t);function b8(C8,K8,r8){return l0t + K8 + (r8=J3t != r8?N6t + (r8=Y8(r8)?r8.join(N6t).replace(/\s+/g,N6t):r8):N3t) + M0t + C8 + D0t + K8 + M0t;}(U8._prepareExportSetting(),S8(j8,C4t) || S8(j8,Z0t));var H8,N8,m8=Q0t;S8(j8,v4t) && (H8=m8,N8=(N8=B8(v4t)) && O8(N8),L8=L8(O8={gulim:c0t,gothic:Q0t}),m8=W8(L8,N8)?O8[N8]:H8);return function(D1p){var B0t="File";var A0t=/Down2Pdf\.jsp$/;var W0t="application/x-www-form-urlencoded";var Y0t="PDFName";var b0t="PDFFormat";var u0t="PrintDPI";var t0t="PDFPageSize";var Q3t=96;var F0t="PrintMarginHeight";var a0t="Content-Type";var v0t="PrintMarginWidth";var r1t=40;var E0t="PDFPageOrientation";(U8.fileDownloadCheckToken=new Date().getTime(),Q.fileDownloadCheckTimer=setInterval(function(){U8._getCookie(Z6t) == U8.fileDownloadCheckToken && (U8.fileDownloadCheckToken=J3t,U8._finishDownload(E5t));},l3t));var Q1p=B8(e4t),l1p=(J3t == Q1p && (Q1p=s8(U8.Source.Down2Pdf,h4t,t8),A0t.test(Q1p) && (Q1p=Q1p.replace(A0t,Z8))),B8(r4t,{})),M1p=(F8([{name:Y0t,defaultValue:A8},{name:B0t,defaultValue:A8},{name:b0t,defaultValue:f4t},{name:t0t,defaultValue:W1t},{name:E0t,defaultValue:B1t},{name:v0t,defaultValue:r1t},{name:F0t,defaultValue:r1t},{name:u0t,defaultValue:Q3t}],function(o1p){var V1p=o1p.name;S8(l1p,V1p) || v8(l1p,V1p,o1p.defaultValue);}),b8([(D1p.head,M1p=N3t,b8(M1p+=S0t + m8 + s0t,N0t)),(function(z1p){var I1p=s8(z1p,V0t),q1p=a8([o0t,[z0t,I0t]],function(w1p){u8(w1p) && (w1p=[w1p,w1p]);var J1p=s8(I1p,w1p[B1t]);return J3t == J1p?N3t:(Y8(J1p) && (J1p=J1p.join(N6t)),w1p[b1t] + q0t + J1p + Y9t);});return b8(z1p=(z1p=s8(z1p,R0t,N3t)).length?z1p.replace(new RegExp(k0t,y0t),P0t).replace(new RegExp(n0t,y0t),N6t).replace(new RegExp(X0t,y0t),f0t).replace(new RegExp(U8.Style + d0t,y0t),N3t).replace(new RegExp(U8.Style + p0t,y0t),N3t):z1p,G0t,q1p);})(D1p.body || J3t)].join(e9t),R0t,j0t)),g8=(l1p.Data=M1p,new XMLHttpRequest());(g8.open(r5t.toUpperCase(),Q1p),g8.setRequestHeader(a0t,W0t),g8.responseType=l4t,g8.onload=function(){var H0t=".pdf";var M3t=200;var R1p,P1p;M3t === g8.status && (R1p=g8.response,(P1p=V.createElement(D4t)).href=o.URL.createObjectURL(R1p),P1p.download=l1p.File + H0t,P1p.click());});try{g8.send((function(n1p){var y1p,k1p=N3t;for(y1p in n1p)n1p.hasOwnProperty(y1p) && (B1t < k1p.length && (k1p+=T5t),k1p+=encodeURI(y1p + j3t + n1p[y1p]));return k1p;})(l1p));}catch(X1p){}};},M.SetDown2PdfUrl=function(f1p){(this.Source.Down2Pdf || (this.Source.Down2Pdf={}),this.Source.Down2Pdf.Url=f1p);},M._autoExcelModeCheck=function(d1p,G1p,p1p,U1p,S1p,s1p){var h0t=".txt";var K0t="xls|xlsx|txt|csv";var T0t="xls|xlsx";var i0t=".csv";var x0t="txt|csv";var c1p=!b1t;if((b1t == (G1p=this._getNumberValue(G1p,b1t,B1t,b1t,E1t)) && (c1p=!B1t),void B1t === d1p && (d1p={}),U1p)){if(t1t == G1p || E1t == G1p)if(S1p || E1t != G1p || e0t != typeof JSZip){if(void B1t !== s1p)return !b1t;if(b3t == p1p){if(S1p)return !B1t;this.exportData(d1p);}else F3t == p1p && (-b1t == d1p.fileName.indexOf(h0t) && -b1t == d1p.fileName.indexOf(i0t) && (d1p.fileName=d1p.fileName.concat(h0t)),this.exportData(d1p));}else Q.BIEA && !Q.BIEA10?c1p=!B1t:b3t == p1p?this.exportData(d1p):F3t == p1p && (-b1t == d1p.fileName.indexOf(h0t) && -b1t == d1p.fileName.indexOf(i0t) && (d1p.fileName=d1p.fileName.concat(h0t)),this.exportData(d1p));}else (N3t != (U1p=d1p.fileExt) && void B1t !== U1p || (b3t == p1p?d1p.fileExt=T0t:F3t == p1p?d1p.fileExt=x0t:r0t == p1p && (d1p.fileExt=K0t)),t1t != G1p && E1t != G1p || (E1t == G1p && e0t == typeof JSZip?Q.BIEA && !Q.BIEA10?c1p=!B1t:this.importData(d1p):S1p || b3t != p1p && F3t != p1p && r0t != p1p || this.importData(d1p)));return c1p;},M._boolFormatter=function(L1p,O1p,N1p,j1p){return (b1t == j1p?(y6t == N1p?N1p=b1t:n9t == N1p && (N1p=B1t),N1p=this._getBooleanValue(N1p,B1t)):B1t == j1p && (N1p + N3t == y6t?N1p=y6t:N1p + N3t == n9t && (N1p=n9t)),N1p);},M._checkCrossDomain=function(Z1p){var Q8t="https://";var C0t="localhost";var g0t="http://";var A1p=!b1t,Y1p=C0t,m1p=V.location;return (Z1p && (B1t != Z1p.toLowerCase().indexOf(g0t) && B1t != Z1p.toLowerCase().indexOf(Q8t) || (m1p && (Y1p=m1p.protocol + S9t + m1p.host),((m1p=Z1p.split(a2t))[B1t] + S9t + m1p[t1t]).toLowerCase() != Y1p.toLowerCase() && (A1p=!B1t))),A1p);},M._encodeBase64=function(b1p){var B1p=N3t;return B1p=void B1t !== b1p?btoa(encodeURIComponent(b1p).replace(/%([0-9A-F]{2})/g,function(E1p,t1p){var l8t="0x";return String.fromCharCode(l8t + t1p);})):B1p;},M._exportJson=function(x1p,g1p,r1p,Q3p){var o8t="FontStrike";var q8t="#BackColor";var M8t="FontBold";var w8t="#FontColor";var V8t="FontUnderline";var z8t="Edit";var D8t="FontItalic";var I8t="#Edit";for(var K1p,H1p,F1p,i1p={data:[]},v1p=J3t,W1p=B1t,u1p={},e1p=N3t,T1p=b1t < this.DataRows,h1p=[M8t,D8t,V8t,o8t],a1p=B1t,C1p=h1p.length,v1p=this.getFirstRow(J3t,W1t);v1p;v1p=this.getNextRow(v1p))if(!v1p || f2t !== v1p.id && G2t !== v1p.Name && G7t !== v1p.Name){for((W1p=B1t,K1p=x1p.length);W1p < K1p;W1p++){if((H1p=x1p[W1p],!T1p || v1p.UnitPos == H1p.UnitPos)){if((F1p=H1p.Name,e1p=g1p?this._getCellText(v1p,F1p):this._getCellValue(v1p,F1p),H1p.Name === Q3p && b1t != e1p))break;if((u1p[F1p]=e1p,r1p))for((this._getBooleanValue(v1p[F1p + z8t],b1t) || (u1p[F1p + I8t]=B1t),v1p[F1p + d2t] && (u1p[F1p + q8t]=v1p[F1p + d2t]),v1p[F1p + p2t] && (u1p[F1p + w8t]=v1p[F1p + p2t]),a1p=B1t);a1p < C1p;a1p++)v1p[F1p + h1p[a1p]] && (u1p[F1p + d9t + h1p[a1p]]=b1t);}r1p && (this._getBooleanValue(v1p.RowEdit,b1t) || (u1p.Edit=B1t),v1p.Background && (u1p.BackColor=v1p.Background),v1p.Color && (u1p.FontColor=v1p.Color));}T1p && v1p.UnitPos != this.DataRows - b1t || B1t < Object.keys(u1p).length && (i1p.data.push(u1p),u1p={});}return i1p;},M._exportXml=function(I3p,w3p,J3p){var n8t="</data>";var P8t="<row>";var X8t='<?xml version="1.0" encoding="UTF-8" ?>\r\n';var y8t="</row>";var R8t="<![CDATA[";var k8t="]]>";var J8t="<data>";var q3p,D3p,M3p=[],l3p=J3t,V3p=B1t,o3p=N3t,z3p=b1t < this.DataRows;for((M3p.push(J8t),l3p=this.getFirstRow(J3t,W1t));l3p;l3p=this.getNext(Rowr))if(!l3p || f2t !== l3p.id && G2t !== l3p.Name && G7t !== l3p.Name){for((z3p && B1t != l3p.UnitPos || M3p.push(P8t),V3p=B1t,q3p=I3p.length);V3p < q3p;V3p++)if((D3p=I3p[V3p],!z3p || l3p.UnitPos == D3p.UnitPos)){if((o3p=w3p?this._getCellText(l3p,D3p.Name):this._getCellValue(l3p,D3p.Name),D3p.Name === J3p && b1t != o3p))break;(M3p.push(l0t + D3p.Name + M0t),_ibsUtil.isEmpty(o3p) || M3p.push(R8t + o3p + k8t),M3p.push(D0t + D3p.Name + M0t));}z3p && l3p.UnitPos != this.DataRows - b1t || y8t != M3p[M3p.length - b1t] && M3p.push(y8t);}return (M3p.push(n8t),M3p=X8t + M3p.join(N3t));},M._finishDownload=function(P3p){var d8t="; path=/";var f8t="fileDownloadToken=; expires=";(P3p=P3p || b3t,o.clearInterval(Q.fileDownloadCheckTimer),Q.fileDownloadCheckTimer=J3t,this.hideMessage(),IBSheet.OnDownFinish && IBSheet.OnDownFinish(this,P3p,!B1t),(P3p=new Date()).setDate(P3p.getDate() - b1t),V.cookie=f8t + P3p.toGMTString() + d8t);},M._getAlignByType=function(R3p){var p8t="right";return this._isBooleanType(R3p)?f6t:this._isNumberType(R3p)?p8t:G8t;},M._getBodyData=function(d3p){var m8t="Spanned";var L8t="Align";var j3p,n3p,y3p,p3p,M9p,X3p,t3p,s3p,y9p,H3p,G3p,k3p,v3p=[],F3p=[],O3p=N3t,u3p=N3t,e3p=N3t,S3p=d3p.from,f3p=d3p.cfg,h3p=d3p.sheetDesign,n9p=d3p.isTreeLevel,X9p=d3p.isDownRows,f9p=d3p.isDownRowVisible,Y3p=d3p.rowHeights,b3p=d3p.downColNames,a3p=d3p.downColNamesLength,m3p=d3p.data,Z3p=d3p.p,D9p=d3p.headerRows,K3p=[],V9p=[],o9p=[],z9p=[],E3p=B1t,c3p=[],C3p=[],L3p=B1t,I9p=B1t,q9p=[],A3p=N3t,B3p={},w9p=d3p.isSameDownColAndVisible,N3p=this.getCols(),J9p=this.GetFnLib(c8t),d3p=this.Cols[this.RowIndex || z5t],P9p=this.MergeAllRanges?U8t:c2t,g3p=this.MergeAllRanges?S8t:U2t;if(!d3p.Visible && d3p.Def && s8t === d3p.Def)for(var i3p=B1t;i3p < N3p.length;i3p++)if(N3p[i3p] === (this.RowIndex || z5t)){N3p.splice(i3p,b1t);break;}for((j3p=B1t,y9p=b3p.length);j3p < y9p;j3p++)B3p[b3p[j3p]]=j3p;if(f3p.downSum){if(this.Rows.FormulaRow)for((y3p=this.Rows.FormulaRow,j3p=B1t);j3p < this.DataRows && y3p && y3p.Visible;j3p++){for((B1t == this.FormulaRowPosition && (D9p++,K3p.push(E3p++)),F3p.push(this._getExcelRowHeight(y3p)),b3t == S3p && this._setRowProperty(X3p={},y3p),t3p=[],n3p=B1t);n3p < a3p;n3p++)N8t != (k3p=b3p[n3p]) && (p3p=void B1t === y3p[k3p]?N3t:this._getStringExcel(y3p,k3p,!b1t,f3p,S3p),u3p=this._addCellColor(h3p,y3p,k3p),e0t !== (p3p=F3t == S3p?(p3p + N3t).replace(/\r\n|\n|\r/g,N3t):p3p) && void B1t !== p3p || (p3p=N3t),t3p.push(p3p + u3p),b3t == S3p && (s3p=s2t + (B3p[k3p] + b1t),O3p=this.Cols[k3p].Type,void B1t === this._getNumberValue(p3p) && (O3p=A5t),this._setRowData(X3p,s3p,k3p,p3p,O3p),e3p=w9p?y3p[k3p + U2t]:b1t,X3p[s3p + c2t]=y3p[k3p + c2t],X3p[s3p + U2t]=e3p,X3p[k3p + c2t]=y3p[k3p + c2t],X3p[k3p + U2t]=e3p));(v3p.push(t3p.join(this.IB_DELIMITER_COL)),b3t == S3p && this.ExcelXF.push(X3p),y3p=this.getNextRow(y3p));}B1t < v3p.length && B1t == this.FormulaRowPosition && (m3p[Z3p++]=v3p.join(this.IB_DELIMITER_ROW),m3p[Z3p++]=this.IB_DELIMITER_ROW,Y3p=F3p.concat(Y3p));}if((void B1t !== f3p.ExcludeFooterRow && (f3p.excludeFooterRow=f3p.ExcludeFooterRow),!f3p.excludeFooterRow))for(c3p=this.XF.firstChild;c3p;c3p=c3p.nextSibling)if(f2t != c3p.id){for((F3p.push(this._getExcelRowHeight(c3p)),footerRowData=[],n3p=B1t);n3p < a3p;n3p++)N8t != (k3p=b3p[n3p]) && (L3p=G3p=this._getStringExcel(c3p,k3p,!b1t,f3p,S3p),F3t == S3p && (G3p=(G3p + N3t).replace(/\r\n|\n|\r/g,N3t)),b3t == S3p && (O3p=c3p[k3p + j8t] || this.Cols[k3p].Type,void B1t === this._getNumberValue(G3p) && (O3p=A5t),L3p=(L3p+=b1t == h3p && N3t != (G3p=this._addCellColor(h3p,c3p,k3p))?G3p:this.IB_DELIMITER_COLOR) + (N3t != O3p?O3p=this.IB_DELIMITER_COLOR + O3p:this.IB_DELIMITER_COLOR),L3p+=e0t != (G3p=c3p[k3p + L8t] || c3p.Def.Align || this.Cols[k3p].Align)?this.IB_DELIMITER_COLOR + G3p:this.IB_DELIMITER_COLOR,void B1t !== c3p[k3p + c2t] && (N3t == f3p.downCols || O8t == f3p.downCols) && this.getAttribute(J3t,k3p,m8t) && B1t < c3p[k3p + U2t]?L3p+=this.IB_DELIMITER_COLOR + c3p[k3p + c2t]:L3p+=this.IB_DELIMITER_COLOR,void B1t === (G3p=c3p[k3p + U2t] || c3p.Def[k3p + U2t] || this.Cols[k3p].Span) || N3t != f3p.downCols && O8t != f3p.downCols || !this.getAttribute(y3p,J3t,m8t)?L3p+=this.IB_DELIMITER_COLOR + b1t:L3p+=e3p=this.IB_DELIMITER_COLOR + G3p,G3p=c3p[k3p + w5t] || this.Cols[k3p].LegacyFormat || this.Cols[k3p].Format,void B1t !== (G3p=f5t != O3p || G3p?G3p:this.Cols[k3p].DateFormat || this.Cols[k3p].DataFormat) && N3t != G3p?(B1t <= O3p.indexOf(Z8t) && b1t < (H3p=G3p.split(o6t)).length && d9t == H3p[b1t].charAt(B1t) && (H3p[b1t]=n9t + H3p[b1t].slice(b1t),G3p=H3p.join(o6t)),L3p+=this.IB_DELIMITER_COLOR + G3p):L3p+=this.IB_DELIMITER_COLOR),footerRowData.push(L3p));(C3p.push(footerRowData.join(this.IB_DELIMITER_COL)),I9p++);}var R9p=B1t,d9p=f3p.downRows && f3p.downRows.split(j6t);for((this.ExLoadSEQ=B1t,y3p=this.getFirstRow(J3t,W1t));y3p;y3p=this.getNextRow(y3p))if((f3p.downTreeHide || B1t == f3p.downTreeHide && this._getTreeVisible(y3p)) && (R9p++,!X9p || -b1t < d9p.indexOf(N3t + R9p) || f9p && y3p.Visible))for(var U3p=B1t;U3p < this.DataRows;U3p++)if(!(b1t == f3p.excludeSubSum && G2t === y3p.Name || t1t == f3p.excludeSubSum && y3p.CumulateRow || E1t == f3p.excludeSubSum && (G2t === y3p.Name || y3p.CumulateRow))){for((b3t != S3p && J5t != S3p || Y3p.push(this._getExcelRowHeight(y3p,U3p)),b3t == S3p && (this._setRowProperty(X3p={},y3p,this.GetStatusValue(y3p)),G2t === y3p.Name?V9p.push(E3p++):y3p.CumulateRow?o9p.push(E3p++):E3p++),t3p=new Array(a3p),n3p=B1t);n3p < N3p.length;n3p++){var T3p=B3p[N3p[n3p]];if(!(b3t != S3p || this.MultiRecord && this.MultiRecordShape || this.MergeAllRanges || N3p.length == a3p)){var W3p=y3p[N3p[n3p] + g3p],x3p=W3p;if(!J9p(T3p)){if(b1t < W3p){for(var Q9p=J3t,U3p=B1t;U3p < W3p;U3p++)this.Cols[N3p[n3p + U3p]].Visible?(Q9p=Q9p || U3p,B1t != this.SearchMode || y3p[k3p + U8t] || (X3p[N3p[n3p + U3p] + c2t]=y3p[N3p[n3p] + c2t])):--x3p;X3p[N3p[n3p + Q9p] + U2t]=x3p;}continue;}if(J9p(T3p))if(!w9p && f3p.downCols && O8t != f3p.downCols)X3p[N3p[n3p] + U2t]=b1t;else if(b1t < W3p){for(U3p=n3p;U3p < n3p + W3p;U3p++)void B1t === B3p[N3p[U3p]] && --x3p;X3p[N3p[n3p] + U2t]=x3p;}}(T3p=B3p[N3p[n3p]],p3p=N3t,(k3p=this.MultiRecord && b1t & this.MultiRecordShape?this._DownMultiMap[U3p][n3p]:b3p[T3p]) && N8t != k3p && (p3p=this._getStringExcel(y3p,k3p,!B1t,f3p,S3p),u3p=this._addCellColor(h3p,y3p,k3p),G2t !== !y3p.Name || y3p.CumulateRow || void B1t !== (M9p=Q.OnExportEncryption?Q.OnExportEncryption(this,y3p,k3p,p3p):M9p) && (p3p=M9p),e0t !== p3p && void B1t !== p3p || (p3p=N3t),t3p[this.MultiRecord && b1t & this.MultiRecordShape?n3p:B3p[k3p]]=p3p + u3p,b3t == S3p && (s3p=s2t + ((this.MultiRecord && b1t & this.MultiRecordShape?n3p:B3p[k3p]) + b1t),this._setRowData(X3p,s3p,k3p,p3p,k3p && this.Cols[k3p]?this.Cols[k3p].Type:A5t),J3t != y3p[k3p + (this.MainTag.offsetHeight && this.MainTag.offsetWidth && y3p.Name && G2t == y3p.Name?c2t:P9p)] && (X3p[s3p + c2t]=X3p[k3p + c2t] || y3p[k3p + (this.MainTag.offsetHeight && this.MainTag.offsetWidth && y3p.Name && G2t == y3p.Name?c2t:P9p)],b1t < X3p[s3p + c2t] && J3t == X3p[s3p + U2t] && (X3p[s3p + U2t]=b1t),this.MergeVisibleDom && delete y3p[k3p + U8t]),J3t != y3p[k3p + (this.MainTag.offsetHeight && this.MainTag.offsetWidth && y3p.Name && G2t == y3p.Name?U2t:g3p)] && (X3p[s3p + U2t]=X3p[k3p + U2t] || y3p[k3p + (this.MainTag.offsetHeight && this.MainTag.offsetWidth && y3p.Name && G2t == y3p.Name?U2t:g3p)],b1t < X3p[s3p + U2t] && J3t == X3p[s3p + c2t] && (X3p[s3p + c2t]=b1t),this.MergeVisibleDom && delete y3p[k3p + S8t]),k3p && this.MultiRecord && b1t & this.MultiRecordShape && J3t != this.Cols[k3p].RecordRowSpan && this._DownMultiMap[U3p][n3p] && (X3p[s3p + c2t]=this.Cols[k3p].RecordRowSpan),k3p && this.MultiRecord && b1t & this.MultiRecordShape && J3t != this.Cols[k3p].RecordColSpan && this._DownMultiMap[U3p][n3p] && (X3p[s3p + U2t]=this.Cols[k3p].RecordColSpan)),n9p && this.MainCol == k3p && (t3p[B3p[k3p]]=y3p.Level + u3p)));}(m3p[Z3p++]=t3p.join(this.IB_DELIMITER_COL),m3p[Z3p++]=this.IB_DELIMITER_ROW,b3t == S3p && this.ExcelXB.push(X3p));}if((this.ExLoadSEQ && delete this.ExLoadSEQ,b3t == S3p && f3p.useFormula))for(n3p=B1t;n3p < a3p;n3p++)if((k3p=b3p[n3p],(A3p=this.Cols[k3p].Formula) && B9t == typeof A3p)){for(var r3p,k9p,l9p=this.getColIndex(this.getLastCol());B1t <= l9p;l9p--)if((r3p=this.getColByIndex(l9p)) && -b1t < (k9p=A3p.indexOf(r3p)) && j6t !== A3p.charAt(k9p - b1t)){if((k9p=b3p.indexOf(r3p)) < B1t){A3p=N3t;break;}A3p=A3p.replaceAll(r3p,j6t + r3p + j6t);}A3p && q9p.push({SaveName:k3p,Formula:A3p});}if(B1t < v3p.length && f3p.downSum && B1t != this.FormulaRowPosition)for((m3p[Z3p++]=v3p.join(this.IB_DELIMITER_ROW),m3p[Z3p++]=this.IB_DELIMITER_ROW,Y3p=Y3p.concat(F3p),j3p=B1t);j3p < this.DataRows;j3p++)K3p.push(E3p++);if(B1t < C3p.length)for((m3p[Z3p++]=C3p.join(this.IB_DELIMITER_ROW),m3p[Z3p++]=this.IB_DELIMITER_ROW,Y3p=Y3p.concat(F3p),j3p=B1t);j3p < I9p;j3p++)z9p.push(E3p++);return {p:Z3p,data:m3p,headerRows:D9p,rowHeights:Y3p,footRow:z9p,sumRow:K3p,subSumRow:V9p,cumulateRow:o9p,formulas:q9p};},M._getBooleanValue=function(p9p,U9p){var G9p=U9p,c9p={1:b1t,true:b1t,0:B1t,false:B1t};return (this.BooleanSettingMode?G9p=void B1t === p9p?U9p:p9p && n9t != p9p?b1t:B1t:void B1t !== c9p[p9p=(p9p + N3t).toLowerCase()] && (G9p=c9p[p9p]),G9p);},M._getCCSStylesheetRuleStyle=function(A9p,S9p){var Y8t="cssRules";var A8t="rules";var B8t="initial";var j9p,s9p,Z9p,L9p,N9p,O9p,m9p=N3t;for((S9p=S9p.toLowerCase(),Z9p=V.all?A8t:Y8t,L9p=B1t);L9p < V.styleSheets.length;L9p++){try{s9p=V.styleSheets[L9p][Z9p];}catch(Y9p){continue;}if(s9p)for(N9p=B1t;N9p < s9p.length;N9p++)if(s9p[N9p] && s9p[N9p].selectorText && -b1t != s9p[N9p].selectorText.indexOf(A9p) && s9p[N9p].cssText && -b1t != s9p[N9p].cssText.indexOf(S9p)){for(j9p=s9p[N9p].style;;){if(-b1t == (O9p=S9p.indexOf(V6t)))break;S9p=S9p.substring(B1t,O9p) + S9p[O9p + b1t].toUpperCase() + S9p.substring(O9p + t1t);}j9p[S9p] && B8t != j9p[S9p] && (m9p=j9p[S9p]);}}return m9p;},M._getCellText=function(B9p,E9p){var F8t="Button";var E8t="GroupSumType";var t8t="FooterRow";var v8t="|| |";var t9p,b9p=N3t,F9p=this.getType(B9p,E9p),v9p=Q.get(B9p,E9p) + N3t,u9p=this.GetFnLib(G4t);if(!B9p || !E9p)return b9p;if(b8t !== B9p.Kind && v2t === this.MainCol && this.GroupTreeCols && t8t !== B9p.id && f2t !== B9p.id){if(this.GroupTreeCols[E9p] && !B9p.Def.Group)return N3t;if(B9p.Def.Group && !this.GroupTreeCols[E9p] && !this.getAttribute(B9p,E9p,E8t))return N3t;}return (b8t == B9p.Kind?b9p=m5t == F9p?this.getString(B9p,E9p):this._removeHTMLTag(this.getString(B9p,E9p)):R5t == F9p?b9p=this._getPasswordType(B9p,E9p,v9p):this._isBooleanType(F9p)?(t9p=this.getAttribute(B9p,E9p,y5t),b9p=k5t == F9p && t9p?this.getString(B9p,E9p):this._getBooleanValue(v9p,B1t)):u9p(v9p) && O5t == F9p?b9p=(t9p=v9p.split(v9p.charAt(B1t))).length?(N3t == t9p[b1t] || N3t != t9p[t1t] && J3t != t9p[t1t]?(N3t == t9p[t1t] || J3t == t9p[t1t] || t9p.length < E1t) && (t9p[t1t]=N6t):t9p[t1t]=t9p[b1t],F2t != B9p.Kind?t9p.join(v9p.charAt(B1t)):t9p[t1t]):F2t != B9p.Kind?v8t:N3t:F8t == F9p?b9p=v9p?v9p + N3t:N3t:(b9p=u8t == F9p || Z8t == F9p?v9p:N3t == v9p?N3t:this.getString(B9p,E9p),f2t === B9p.id?(B1t == v9p && void B1t !== this.SumZeroValue && (b9p=this.SumZeroValue),A5t == F9p && (b9p=v9p)):F2t == B9p.Kind && E9p == (this.RowIndex || z5t) && e0t == b9p && (b9p=N3t),this.DataAutoTrim && B9t == typeof b9p && X2t == B9p.Kind && (b9p=this._trim(b9p))),b9p);},M._getCellValue=function(W9p,H9p){var W8t="FormatFix";var T8t="AutoAvg";var h8t="PopupEdit";var r8t="DummyCheck";var e8t="Popup";var x8t="CheckBox";var C8t="ComboEdit";var i8t="AutoSum";var H8t="(ALL)";this.Lang.Format;var h9p,a9p=N3t,i9p=this.getAttribute(W9p,H9p,n5t),e9p=this.getAttribute(W9p,H9p,a8t) || this.getAttribute(W9p,H9p,j8t);if(this.getAttribute(W9p,H9p,W8t))return this._getCellText(W9p,H9p);switch((a9p=this.getValue(W9p,H9p),I5t == W9p.Kind && H8t === (a9p + N3t).toUpperCase() && (a9p=N3t),b8t == W9p.Kind && m5t == this.Cols[H9p].Type && (a9p=this.getString(W9p,H9p)),e9p=k5t == e9p && i9p?y5t:e9p)){case N2t:a9p=this._getStatusTypeCellValue(e9p,W9p,H9p,a9p);break;case A5t:case e8t:case h8t:a9p=this._getTextTypeCellValue(e9p,W9p,H9p,a9p);break;case f5t:(h9p=this.getAttribute(W9p,H9p,q5t) || this.getAttribute(W9p,H9p,w5t) || this.getAttribute(W9p,H9p,d5t) || this.getAttribute(W9p,H9p,u6t) || this.DateFormat || this.DataFormat,B9t == typeof (a9p=Q.dateToString(this.getValue(W9p,H9p),h9p)) && (a9p=this._removeHTMLTag(a9p)));break;case u8t:case Z8t:case i8t:case T8t:a9p=this._getNumberTypeCellValue(e9p,W9p,H9p,a9p);break;case s5t:case x8t:case j2t:case k5t:case r8t:a9p=this._getCheckBoxTypeCellValue(e9p,W9p,H9p,a9p);break;case K8t:case y5t:a9p=this._getComboTypeCellValue(e9p,W9p,H9p,a9p);break;case C8t:a9p=this._getComboEditTypeCellValue(e9p,W9p,H9p,a9p);}return a9p=this.DataAutoTrim && B9t == typeof a9p && X2t == W9p.Kind?IBSheet._ibsUtil.trim(a9p):a9p;},M._getCheckBoxTypeCellValue=function(K9p,x9p,r9p,T9p){(this.getAttribute(x9p,r9p,y5t),this.getAttribute(x9p,r9p,n5t),T9p=T9p?+T9p:B1t);return T9p=B1t === this.GetCellValueMode?this._boolFormatter(x9p,r9p,T9p,B1t):T9p;},M._getColInfo=function(X6p,c6p,U6p){var V1Q="Text|";var g8t="IBTreeLevelCol|";var Q1Q="30|";var o1Q=/Format/i;var D1Q="Lines";var M1Q="[object Function]";var I1Q="Int|";for(var I6p,g9p,Q6p,d6p,p6p,P6p=N3t,R6p=N3t,k6p=N3t,q6p=N3t,w6p=N3t,G6p=N3t,M6p=N3t,D6p=N3t,V6p=N3t,o6p=N3t,y6p=N3t,S6p=X6p.hiddenColumn,s6p=X6p.numberTypeToText,N6p=X6p.allTypeToText,j6p=c6p.length,l6p=N3t,J6p=N3t,f6p=N3t,L6p={Int:b1t,Float:b1t,AutoSum:b1t,AutoAvg:b1t},O6p={Enum:b1t,Combo:b1t,ComboEdit:b1t},m6p={left:b1t,center:b1t,right:b1t},z6p=B1t;z6p < this.DataRows;z6p++){for((g9p=this.Cols,I6p=B1t);I6p < j6p;I6p++){var n6p,C9p=(this.MultiRecord && b1t & this.MultiRecordShape?this._DownMultiMap[z6p]:c6p)[I6p];(B1t == z6p && (P6p+=(C9p && void B1t !== g9p[C9p].Name?g9p[C9p].Name:N3t) + j6t,R6p+=this._getNumberValue(!C9p && this.MultiRecord && b1t & this.MultiRecordShape?this.MultiHeaderColSpan[this.MultiHeaderMap[z6p][I6p]][I6p - this._DownMultiMap[z6p].indexOf(this.MultiHeaderMap[z6p][I6p]) - b1t] + g9p[this.MultiHeaderMap[z6p][I6p]].WidthPad:B1t == g9p[C9p].Visible && g9p[C9p].RelWidth?B1t:g9p[C9p].Width || g9p[C9p].MinWidth || this.MinMidWidth,B1t) + j6t,k6p+=(b1t == S6p?g9p[C9p].Visible:y6t) + j6t,U6p && this.MainCol == C9p && (P6p+=g8t,R6p+=Q1Q,k6p+=l1Q)),q6p+=(C9p && void B1t !== g9p[C9p].SaveName?g9p[C9p].SaveName:C9p && void B1t !== g9p[C9p].Name?g9p[C9p].Name:N3t) + j6t,Q6p=C9p?g9p[C9p].LegacyType || g9p[C9p].Type:N3t,l6p=C9p?g9p[C9p].LegacyFormat || g9p[C9p].Format:N3t,d6p=C9p?g9p[C9p].FormulaRow:N3t,X6p.downRowSpan && (p6p=C9p && !g9p[C9p].ColMerge?n9t:y6t,f6p+=N3t === f6p?p6p:j6t + p6p),B9t != typeof (l6p=f5t != Q6p || l6p?l6p:g9p[C9p].DateFormat || this.DateFormat || g9p[C9p].DataFormat || this.DataFormat)?l6p=(void B1t !== l6p && M1Q !== Object.prototype.toString.call(l6p) && p9t !== Object.prototype.toString.call(l6p) && v9t != typeof l6p && Object.prototype.toString.call(l6p),N3t):A5t != Q6p && D1Q != Q6p && R5t != Q6p && O5t != Q6p && j5t != Q6p || (l6p=N3t),w6p+=m6p[G6p=this.Group && B1t < this.Group.length && (this.GroupMain?this.GroupMain == C9p:this.Group.split(f9t)[B1t] == C9p)?G8t:C9p?(g9p[C9p].Align + N3t).toLowerCase():N3t]?G6p + j6t:this._getAlignByType(Q6p) + j6t,L6p[Q6p]?s6p?(M6p+=V1Q,D6p+=j6t,V6p+=j6t,o6p+=j6t):(M6p+=Q6p + j6t,D6p+=(l6p || N3t) + j6t,n6p=this._getDateFormatPattern(Q6p,l6p),V6p+=(g9p[C9p].OrgFormat || n6p.replace(o1Q,N3t)) + j6t,o6p+=n6p + j6t):N6p && !O6p[Q6p]?(M6p+=V1Q,D6p+=j6t,V6p+=j6t,o6p+=j6t):(M6p+=(y5t == Q6p || k5t == Q6p && g9p[C9p].Enum?K8t:Q6p) + j6t,D6p+=f5t === Q6p?(l6p || N3t) + j6t:(l6p?this.ConvertExcelFormat({type:Q6p,format:l6p}):N3t) + j6t,n6p=this._getDateFormatPattern(Q6p,l6p),V6p+=(C9p && g9p[C9p].OrgFormat?g9p[C9p].OrgFormat:n6p.replace(o1Q,N3t)) + j6t,o6p+=n6p + j6t),J6p+=d6p?d6p + j6t:j6t,U6p && this.MainCol == C9p && (q6p+=g8t,w6p+=z1Q,M6p+=I1Q,D6p+=j6t,V6p+=j6t,o6p+=j6t,J6p+=j6t),y6p+=j6t + (g9p[C9p] && g9p[C9p].DataFormat?g9p[C9p].DataFormat:N3t));}(y6p=y6p.substring(b1t),q6p=q6p.substring(B1t,q6p.length - b1t),w6p=w6p.substring(B1t,w6p.length - b1t),M6p=M6p.substring(B1t,M6p.length - b1t),D6p=D6p.substring(B1t,D6p.length - b1t),V6p=V6p.substring(B1t,V6p.length - b1t),o6p=o6p.substring(B1t,o6p.length - b1t),J6p=J6p.substring(B1t,J6p.length - b1t),b1t < this.DataRows && z6p < this.DataRows - b1t && (q6p+=k3t,w6p+=k3t,M6p+=k3t,D6p+=k3t,V6p+=k3t,o6p+=k3t,y6p+=k3t,J6p+=k3t));}return {name:P6p=P6p.substring(B1t,P6p.length - b1t),width:R6p=R6p.substring(B1t,R6p.length - b1t),visible:k6p=k6p.substring(B1t,k6p.length - b1t),saveName:q6p,align:w6p,type:M6p,format:D6p,orgFormat:V6p,datePattern:o6p,dataFormat:y6p,formulaRow:J6p,colMerge:f6p};},M._getComboEditTypeCellValue=function(u6p,B6p,Z6p,E6p){var v6p,b6p,F6p,A6p=this.getAttribute(B6p,Z6p,n5t),Z6p=this.getAttribute(B6p,Z6p,y5t),Y6p=B1t,t6p=E6p,A6p=A6p && (N3t + A6p).substring(b1t),Z6p=Z6p && (N3t + Z6p).substring(b1t);if(b8t != B6p.Kind && Z6p)for((b6p=Z6p.split(j6t),v6p=A6p.split(j6t),F6p=b6p.length,Y6p=B1t);Y6p < F6p;Y6p++)if(E6p == b6p[Y6p]){t6p=v6p[Y6p];break;}return t6p;},M._getComboTypeCellValue=function(r6p,i6p,a6p,e6p){var T6p,x6p,h6p=B1t,W6p=B1t,H6p=e6p,a6p=(a6p=this.getAttribute(i6p,a6p,n5t)) && (N3t + a6p).substring(b1t);if(b8t != i6p.Kind){if(a6p)for((T6p=(x6p=a6p.split(j6t)).length,W6p=B1t);W6p < T6p;W6p++)if(e6p == x6p[W6p]){(h6p=b1t,H6p=e6p);break;}h6p || (H6p=N3t);}return H6p;},M._getCookie=function(Q2p){var C6p,K6p=B1t,g6p=B1t;Q2p+=j3t;try{for(;K6p <= V.cookie.length;){if((C6p=K6p + Q2p.length,V.cookie.substring(K6p,C6p) == Q2p))return (-b1t == (g6p=V.cookie.indexOf(J0t,C6p)) && (g6p=V.cookie.length),unescape(V.cookie.substring(C6p,g6p)));if(B1t == (K6p=V.cookie.indexOf(N6t,K6p) + b1t))break;}}catch(l2p){}return N3t;},M._getDateFormat=function(D2p){var k1Q="MM/dd";var f1Q="yyyy/MM/dd HH:mm";var n1Q="yyyy/MM/dd HH:mm:ss";var G1Q="HH:mm";var P1Q="yyyy/MM";var q1Q="yyyy/MM/dd";var M2p=q1Q;return (D2p && (w1Q == D2p?M2p=q1Q:J1Q == D2p?M2p=P1Q:R1Q == D2p?M2p=k1Q:y1Q == D2p?M2p=n1Q:X1Q == D2p?M2p=f1Q:d1Q == D2p?M2p=S5t:p1Q == D2p && (M2p=G1Q)),M2p);},M._getDateFormatPattern=function(z2p,V2p){var S1Q=/^y.*d.*M$/;var c1Q="Ymd";var v1Q=/^M.*y.*d.*H.*m.*s$/i;var E1Q=/^y.*d.*M.*H.*m.*s$/i;var u1Q=/^d.*M.*y.*H.*m.*s$/i;var Y1Q=/^M.*d$/;var O1Q="Ym";var W1Q="YmdHm";var a1Q=/^d.*y.*M.*H.*m.*s$/i;var g1Q=/^H.*m$/i;var C1Q="Hm";var i1Q=/^M.*d.*y.*H.*m$/i;var t1Q=/^y.*M.*d.*H.*m.*s$/i;var T1Q=/^d.*M.*y.*H.*m$/i;var j1Q=/^d.*M.*y$/;var N1Q=/^M.*d.*y$/;var F1Q=/^M.*d.*y.*H.*m.*s$/i;var e1Q=/^y.*d.*M.*H.*m$/i;var h1Q=/^M.*y.*d.*H.*m$/i;var L1Q=/^d.*y.*M$/;var A1Q="Md";var U1Q=/^y.*M.*d$/;var r1Q="Hms";var H1Q=/^y.*M.*d.*H.*m$/i;var m1Q=/^y.*M$/;var Z1Q=/^M.*y$/;var K1Q=/^H.*m.*s$/i;var B1Q=/^d.*M$/;var x1Q=/^d.*y.*M.*H.*m$/i;var s1Q=/^M.*y.*d$/;var b1Q="YmdHms";var o2p=N3t;return (z2p && (V2p=f5t !== z2p || V2p?V2p:c1Q) && (c1Q == V2p || B1t <= V2p.search(U1Q) || B1t <= V2p.search(S1Q) || B1t <= V2p.search(s1Q) || B1t <= V2p.search(N1Q) || B1t <= V2p.search(j1Q) || B1t <= V2p.search(L1Q)?o2p=w1Q:O1Q == V2p || B1t <= V2p.search(m1Q) || B1t <= V2p.search(Z1Q)?o2p=J1Q:A1Q == V2p || B1t <= V2p.search(Y1Q) || B1t <= V2p.search(B1Q)?o2p=R1Q:b1Q == V2p || B1t <= V2p.search(t1Q) || B1t <= V2p.search(E1Q) || B1t <= V2p.search(v1Q) || B1t <= V2p.search(F1Q) || B1t <= V2p.search(u1Q) || B1t <= V2p.search(a1Q)?o2p=y1Q:W1Q == V2p || B1t <= V2p.search(H1Q) || B1t <= V2p.search(e1Q) || B1t <= V2p.search(h1Q) || B1t <= V2p.search(i1Q) || B1t <= V2p.search(T1Q) || B1t <= V2p.search(x1Q)?o2p=X1Q:r1Q == V2p || B1t <= V2p.search(K1Q)?o2p=d1Q:(C1Q == V2p || B1t <= V2p.search(g1Q)) && (o2p=p1Q)),o2p);},M._getDefault=function(I2p,q2p,w2p){if(void B1t === I2p || J3t == I2p)return q2p;switch(w2p || typeof q2p){case v9t:return this._getNumberValue(I2p,q2p);case A6t:return this._getNumberValue(I2p,q2p,b1t);case B9t:return B1t == I2p.length?q2p:I2p + N3t;case u9t:return this._getBooleanValue(I2p,q2p);default:return q2p;}},M._getDownColNames=function(P2p){var R2p,n2p,J2p,p2p,G2p,k2p=[],y2p=[],X2p=[],f2p=[],d2p=[];if(N3t != P2p.downCols)for((R2p=B1t,n2p=(k2p=O8t === P2p.downCols?this.getCols(O8t):P2p.downCols.split(j6t)).length);R2p < n2p;R2p++){if(!this.Cols[k2p[R2p]])return [];this.GetColName(k2p[R2p]) && y2p.push(this.GetColName(k2p[R2p]));}else for(J2p=this.GetFirstColA(J3t,t1t);J2p;J2p=this.GetNextColA(J2p))v2t !== J2p && Q3Q !== J2p && this.Cols[J2p].CanExport && y2p.push(J2p);for((k2p=[],P2p.objReturn && (f2p=[],d2p=[]),-b1t == P2p.mode?X2p={Status:b1t,DelCheck:b1t,Result:b1t}:b1t == P2p.mode && (X2p={Status:b1t,DelCheck:b1t}),R2p=B1t,n2p=y2p.length);R2p < n2p;R2p++)(J2p=y2p[R2p]) && (p2p=this.Cols[J2p].LegacyType || this.Cols[J2p].Type,G2p=this.Cols[J2p].Hidden,X2p[p2p] || (-b1t == P2p.mode || t1t == P2p.mode) && G2p || (P2p.objReturn?(f2p[J2p]=this.Cols[J2p],d2p.push(J2p)):k2p.push(J2p)));return (P2p.objReturn && (k2p[B1t]=f2p,k2p[b1t]=d2p),k2p);},M._getHeaderData=function(m2p){var w3Q="TreeLevel";var M3Q="HtmlPrefix";var z3Q="\0";var V3Q="(*)";var q3Q="RecordRowSpan";var l3Q="Required";var D3Q="HtmlPostfix";var I3Q="RecordColSpan";var j2p,s2p,u2p,h2p,U2p,a2p,Y2p=m2p.from,g2p=m2p.cfg,Q7p=m2p.sheetDesign,l7p=m2p.isTreeLevel,M7p=(m2p.isDownRows,m2p.isDownRowVisible,m2p.rowHeights),b2p=m2p.downColNames,W2p=m2p.downColNamesLength,i2p=m2p.data,H2p=m2p.p,T2p=m2p.headerRows,D7p=m2p.isHeaderMerge,A2p={},L2p=this.getCols(),t2p=m2p.isSameDownColAndVisible,x2p=this.Style + l3Q,m2p=this.Cols[this.RowIndex || z5t],r2p=this.GetFnLib(c8t),E2p={};if(!m2p.Visible && m2p.Def && s8t === m2p.Def)for(var v2p=B1t;v2p < L2p.length;v2p++)if(L2p[v2p] === (this.RowIndex || z5t)){L2p.splice(v2p,b1t);break;}for((Z2p=B1t,F2p=b2p.length);Z2p < F2p;Z2p++)A2p[b2p[Z2p]]=Z2p;for(var K2p=B1t != this.SearchMode && t2p?c2t:U8t,C2p=B1t != this.SearchMode && t2p?U2t:S8t,Z2p=B1t,F2p=this.XH.childNodes.length;Z2p < F2p;Z2p++)if(b8t == (s2p=GetNode(this.XH,Z2p)).Kind && s2p.Visible)for(var S2p=B1t;S2p < this.DataRows;S2p++){for((T2p++,b3t != Y2p && J5t != Y2p || M7p.push(this._getExcelRowHeight(s2p,S2p)),b3t == Y2p && this._setRowProperty(U2p={},s2p),a2p=new Array(b2p.length),j2p=B1t);j2p < (this.MultiRecord && this.MultiRecordShape?this.MultiHeaderMap[S2p]:L2p).length;j2p++){var c2p,O2p,N2p;if(!(b3t != Y2p || this.MultiRecord && this.MultiRecordShape || this.MergeAllRanges || L2p.length == W2p)){var B2p=s2p[L2p[j2p] + U2t];if(!r2p(A2p[L2p[j2p]])){if(t2p || W2p == L2p.length){if(B1t < B2p){for(var e2p=J3t,S2p=B1t;S2p < s2p[L2p[j2p] + U2t];S2p++)this.Cols[L2p[j2p + S2p]].Visible?e2p=e2p || S2p:--B2p;U2p[L2p[j2p + e2p] + U2t]=B2p;}}else U2p[L2p[j2p] + U2t]=b1t;continue;}if(r2p(A2p[L2p[j2p]]) && B1t < B2p)if(t2p || W2p == L2p.length){for(S2p=j2p;S2p < j2p + s2p[L2p[j2p] + U2t];S2p++)void B1t === A2p[L2p[S2p]] && --B2p;U2p[L2p[j2p] + U2t]=B2p;}else U2p[L2p[j2p] + U2t]=b1t;}(c2p=A2p[L2p[j2p]],(c2p=this.MultiRecord && b1t & this.MultiRecordShape?this.MultiHeaderMap[S2p][j2p]:b2p[c2p]) && N8t != c2p && (N2p=N3t,g2p.RequiredMark && (O2p=this.Cols,c2p && b1t == O2p[c2p].Required && (D7p?(B1t <= (s2p[c2p + M3Q] + N3t || N3t).indexOf(x2p) || B1t <= (s2p[c2p + D3Q] + N3t || N3t).indexOf(x2p)) && (N2p=V3Q):(O2p=b1t,this.Rows.Filter && (O2p+=b1t),this.Rows.FormulaRow && B1t == this.GetAutoSumPosition() && (O2p+=b1t),Z2p == F2p - O2p && (N2p=V3Q)))),O2p=N3t,c2p && m5t == this.Cols[c2p].Type?O2p+=this._getCellValue(s2p,c2p):O2p=s2p[c2p + o3Q] || this._getCellText(s2p,c2p),c2p && this.MultiRecord && b1t & this.MultiRecordShape && this.MultiHColSpan && this.MultiHColSpan && v9t == typeof this.MultiHColSpanValue[B1t][c2p] && B1t < this.MultiHColSpanValue[S2p][c2p] && (O2p=this.MultiHColSpanTitle[S2p][c2p]),c2p && this.MultiRecord && b1t & this.MultiRecordShape && this.MultiHeaderMerge && (u2p=this.MultiHeaderMergeMap[S2p][j2p],O2p=this._getCellText(s2p,u2p)),F3t == Y2p && (O2p=(O2p + N3t).replace(/\r\n|\n|\r/g,N3t)),h2p=this._addCellColor(Q7p,s2p,c2p),e0t != (O2p=O2p && (O2p + N3t).replace(z3Q,N3t)) && J3t != O2p || (O2p=N3t),a2p[this.MultiRecord && b1t & this.MultiRecordShape?j2p:A2p[c2p]]=O2p + N2p + h2p,b3t == Y2p && (N2p=s2t + ((this.MultiRecord && b1t & this.MultiRecordShape?j2p:A2p[c2p]) + b1t),this.ExcelColsMap[c2p]=N2p,this._setRowData(U2p,N2p,c2p,O2p,this.Cols[c2p].Type),J3t != s2p[c2p + K2p] && (U2p[N2p + c2t]=U2p[c2p + c2t] || s2p[c2p + K2p],b1t < U2p[N2p + c2t] && J3t == U2p[N2p + U2t] && (U2p[N2p + U2t]=b1t),delete s2p[c2p + U8t]),J3t != s2p[c2p + C2p] && (U2p[N2p + U2t]=U2p[c2p + U2t] || s2p[c2p + C2p],b1t < U2p[N2p + U2t] && J3t == U2p[N2p + c2t] && (U2p[N2p + c2t]=b1t),delete s2p[c2p + S8t]),c2p && this.MultiRecord && b1t & this.MultiRecordShape && (this.MultiHColSpan && v9t == typeof this.MultiHColSpanValue[B1t][c2p]?B1t < this.MultiHColSpanValue[S2p][c2p]?(U2p[N2p + U2t]=this.MultiHColSpanValue[S2p][c2p],U2p[N2p]=this.MultiHColSpanTitle[S2p][c2p],E2p[c2p]=!B1t):B1t === this.MultiHColSpanValue[S2p][c2p] && B1t < this.Cols[c2p].RecordRowSpan && E2p[c2p]?(U2p[N2p + c2t]=this.Cols[c2p].RecordRowSpan - S2p,E2p[c2p]=!b1t):this.MultiHColSpanValue[S2p][c2p] < B1t && (U2p[N2p + U2t]=B1t,E2p[c2p]=!B1t):this.MultiHeaderMerge && (u2p != c2p || s2p[c2p + I3Q] || s2p[c2p + q3Q])?(u2p != c2p && (U2p[N2p + U2t]=B1t,U2p[N2p + c2t]=B1t),s2p[c2p + I3Q] && (U2p[N2p + U2t]=s2p[c2p + I3Q]),s2p[c2p + q3Q] && (U2p[N2p + c2t]=s2p[c2p + q3Q])):(J3t != this.Cols[c2p].RecordRowSpan && this._DownMultiMap[S2p][j2p] && (U2p[N2p + c2t]=this.Cols[c2p].RecordRowSpan),J3t != this.Cols[c2p].RecordColSpan && this._DownMultiMap[S2p][j2p] && (U2p[N2p + U2t]=this.Cols[c2p].RecordColSpan)))),l7p && this.MainCol == c2p && (a2p[A2p[c2p]]=w3Q + h2p)));}(i2p[H2p++]=a2p.join(this.IB_DELIMITER_COL),i2p[H2p++]=this.IB_DELIMITER_ROW,b3t == Y2p && this.ExcelXH.push(U2p));}return {p:H2p,headerRows:T2p};},M._getHeaderText=function(w7p){var J7p,R7p,I7p,q7p,V7p=N3t,k7p=w7p.length,P7p=[];if(this.MultiRecord && b1t & this.MultiRecordShape)for(var z7p=B1t;z7p < this.DataRows;z7p++)for(var o7p=B1t;o7p < this.MultiHeaderMap[B1t].length;o7p++)P7p.push(this.MultiHeaderMap[z7p][o7p]);for((z7p=B1t,J7p=this.XH.childNodes.length);z7p < J7p;z7p++)if(b8t == (I7p=GetNode(this.XH,z7p)).Kind){for((o7p=B1t,R7p=k7p);o7p < R7p;o7p++)w7p[o7p]?(q7p=this.Cols[w7p[o7p]].Name,m5t == this.Cols[q7p].Type?V7p+=this._getCellValue(I7p,q7p) + j6t:I7p[q7p + o3Q]?V7p+=I7p[q7p + o3Q] + j6t:V7p+=this._getCellText(I7p,q7p) + j6t):V7p+=this._getCellText(I7p,P7p[o7p]) + j6t;(V7p=V7p.substring(B1t,V7p.length - b1t),z7p < J7p - b1t && (V7p+=k3t));}return V7p;},M._getNumberTypeCellValue=function(X7p,f7p,d7p,y7p){var n7p=parseFloat(y7p);return n7p=isNaN(n7p)?+y7p + N3t == y7p?+y7p:y7p:n7p;},M._getNumberValue=function(p7p,c7p,s7p,U7p,S7p){var G7p=c7p;return (void B1t === p7p || isNaN(p7p) || (G7p=p7p=s7p?parseFloat(p7p):parseInt(p7p,H1t),isNaN(p7p)?G7p=c7p:(void B1t !== U7p && p7p < U7p && (G7p=c7p),void B1t !== S7p && S7p < p7p && (G7p=c7p))),G7p);},M._getPasswordType=function(O7p,m7p,Z7p){var P3Q="Password";var J3Q="StaticPassword";var L7p,N7p=N3t,j7p=B1t;if(B1t == this.getAttribute(O7p,m7p,J3Q))for((j7p=B1t,L7p=Z7p.length);j7p < L7p;j7p++)N7p+=R6t;else N7p=this.getMessage(P3Q);return N7p;},M._getStatusTypeCellValue=function(B7p,b7p,t7p,Y7p){var R3Q="R";var A7p=Y7p;return A7p=({I:b1t,U:b1t,D:b1t})[Y7p]?A7p:R3Q;},M._getTextTypeCellValue=function(F7p,E7p,v7p,u7p){this.getAttribute(E7p,v7p,q5t) || this.getAttribute(E7p,v7p,w5t);return this.getString(E7p,v7p) + N3t;},M._getTitleConfig=function(V5p){var k3Q="0|";for(var l5p,H7p=V5p,C7p=N3t,g7p=N3t,Q5p=N3t,a7p={},e7p=N3t,h7p=N3t,i7p=N3t,T7p=N3t,x7p=N3t,r7p=N3t,K7p=N3t,W7p=B1t,M5p={left:b1t,center:b1t,right:b1t},W7p=B1t,D5p=H7p.length;W7p < D5p;W7p++)(void B1t === H7p[W7p].text && (H7p[W7p].text=N3t),void B1t === H7p[W7p].Text && (H7p[W7p].Text=N3t),C7p+=(H7p[W7p].text || H7p[W7p].Text) + this.IB_DELIMITER_TITLE_BACKSLASH,g7p+=M5p[l5p=((H7p[W7p].align || H7p[W7p].Align) + N3t).toLowerCase()]?l5p + j6t:z1Q,Q5p+=this._getNumberValue(H7p[W7p].height || H7p[W7p].Height,B1t) + j6t,(a7p=H7p[W7p].style || H7p[W7p].Style) && G9t == typeof a7p?(e7p+=this._getBooleanValue(a7p.fontBold || a7p.FontBold,B1t) + j6t,void B1t === a7p.fontName && (a7p.fontName=N3t),void B1t === a7p.FontName && (a7p.FontName=N3t),i7p+=(a7p.fontName || a7p.FontName) + j6t,T7p+=this._getNumberValue(a7p.fontSize || a7p.FontSize,B1t) + j6t,x7p+=this._getBooleanValue(a7p.fontUnderline || a7p.FontUnderline,B1t) + j6t,h7p+=Q._ibsUtil.getWebColor(a7p.fontColor || a7p.FontColor,b1t) + j6t,r7p+=Q._ibsUtil.getWebColor(a7p.backColor || a7p.BackColor,b1t) + j6t,K7p+=this._getBooleanValue(a7p.border || a7p.Border,b1t) + j6t):(e7p+=k3Q,i7p+=j6t,T7p+=k3Q,x7p+=k3Q,h7p+=j6t,r7p+=j6t,K7p+=l1Q));return {text:C7p=C7p.substring(B1t,C7p.length - b1t),align:g7p=g7p.substring(B1t,g7p.length - b1t),height:Q5p=Q5p.substring(B1t,Q5p.length - b1t),fontBold:e7p=e7p.substring(B1t,e7p.length - b1t),fontColor:h7p=h7p.substring(B1t,h7p.length - b1t),fontName:i7p=i7p.substring(B1t,i7p.length - b1t),fontSize:T7p=T7p.substring(B1t,T7p.length - b1t),fontUnderline:x7p=x7p.substring(B1t,x7p.length - b1t),backColor:r7p=r7p.substring(B1t,r7p.length - b1t),border:K7p=K7p.substring(B1t,K7p.length - b1t)};},M._getTreeVisible=function(o5p){var z5p;return !this.MainCol || B1t == o5p.Level || ! !o5p.parentNode && B1t != (z5p=o5p.parentNode).Expanded && B1t != z5p.Visible && this._getTreeVisible(o5p.parentNode);},M._isBooleanType=function(I5p){return ! !({CheckBox:b1t,DelCheck:b1t,DummyCheck:b1t,Radio:b1t})[I5p];},M._isNumberType=function(q5p){return ! !({Int:b1t,Float:b1t,AutoSum:b1t,AutoAvg:b1t})[q5p];},M._makeColumnTag=function(w5p,J5p){return this.MarkupTagSS + w5p + this.MarkupTagSE + J5p + this.MarkupTagES + w5p + this.MarkupTagEE;},M._makeLoadForm=function(c5p,Y5p,U5p,S5p,s5p,m5p,n5p){var v3Q="50";var L3Q="FileExt";var s3Q="submit";var U3Q="absolute";var X3Q="IBSheetLoadExcelForm";var S3Q="-9999";var j3Q="CrossDomain";var E3Q="100";var b3Q='" id="';var t3Q='">';var B3Q='<iframe name="';var O3Q="LoadExcelSheetID";var G3Q="IBSheetLoadTextForm";var Z5p,y5p=N3t,k5p=N3t,X5p=N3t,R5p=J3t,P5p=J3t,f5p=this,d5p=N3t,p5p=N3t,N5p=J3t,j5p=Q.BIEA && !Q.BIEA11,L5p=J3t;if((s5p=this._getNumberValue(s5p,B1t,b1t),this.Source.LoadExcel && this.Source.LoadText)){if((b3t == c5p || r0t == c5p?(p5p=b1t == Q.g_isDirectLoadExcel?(d5p=y3Q,this.Source.DirectLoadExcel.Url=this._getDefault(this.Source.DirectLoadExcel.Url,J2t),this.Source.DirectLoadExcel.Url):(d5p=n3Q,this.Source.LoadExcel.Url=this._getDefault(this.Source.LoadExcel.Url,P2t),this.Source.LoadExcel.Url),y5p=X3Q,k5p=f3Q,X5p=O3t):F3t == c5p && (Q.g_targetTextSheetID=this.id,d5p=d3Q,this.Source.LoadText.Url=this._getDefault(this.Source.LoadText.Url,p3Q),p5p=this.Source.LoadText.Url,y5p=G3Q,k5p=c3Q,X5p=m3t),this._removeForm(y5p),Z5p=p5p,Z5p+=(B1t <= p5p.indexOf(i5t)?T5t:i5t) + x5t + d5p,(R5p=V.createElement(u5t)).method=a5t,R5p.name=y5p,R5p.id=y5p,R5p.encoding=W5t,R5p.enctype=W5t,R5p.target=k5p,R5p.action=Z5p,Q.BChrome || Q.BSafariMac || Q.BSafariWin || Q.BSafari || Q.BOpera || Q.BOpera8?(R5p.style.position=U3Q,R5p.style.left=C5t,R5p.style.top=C5t,R5p.style.width=C5t,R5p.style.height=C5t,R5p.style.zIndex=S3Q):R5p.style.display=Q4t,(P5p=V.createElement(H5t)).type=s3Q,R5p.appendChild(P5p),(P5p=V.createElement(H5t)).type=e5t,P5p.name=N3Q,j5p && !m5p && (S5p=(S5p=(S5p+=this._makeColumnTag(j3Q,y6t)) + this._makeColumnTag(L3Q,U5p)) + this._makeColumnTag(O3Q,Q.g_LoadExcelSheetID.join(k3t))),P5p.value=S5p,R5p.appendChild(P5p),E9t == typeof n5p || G9t == typeof n5p && n5p))for(L5p in n5p)((P5p=V.createElement(H5t)).type=e5t,P5p.name=L5p,P5p.value=n5p[L5p],R5p.appendChild(P5p));if(!j5p && !m5p){if(((P5p=V.createElement(H5t)).type=m3Q,P5p.name=m3Q,P5p.id=X5p,P5p.title=X5p,N5p=P5p,U5p)){for(var A5p=(U5p + N3t).split(j6t),O5p=N3t,G5p=B1t;G5p < A5p.length;G5p++)(B1t < G5p && (O5p+=Z3Q),O5p+=o6t + A5p[G5p].replace(o6t,N3t));P5p.accept=O5p;}(P5p.onchange=function(B5p){var B5p=B5p.target.files[B1t].size,b5p=V3t * s5p * V3t;if(N3t != this.value)return B1t < b5p && b5p < B5p?(f5p.hideMessage(),void f5p.ShowAlert(f5p.getMessage(A3Q,E3t).replace(/%d/g,s5p + Y3Q),v3t)):void f5p._selectFileAction(R5p,c5p,Y5p,U5p,this.value);},R5p.appendChild(P5p));}((P5p=Q.BIEA && !Q.BIEA9?V.createElement(B3Q + k5p + b3Q + k5p + t3Q):V.createElement(K5t)).name=k5p,P5p.id=k5p,P5p.title=k5p,P5p.width=E3Q,P5p.height=v3Q,R5p.appendChild(P5p),V.body.appendChild(R5p),R5p.style.visibility=e5t,o.frames[k5p].name=k5p,j5p || m5p?R5p.submit():(N5p.focus(),N5p.click()));}},M._makeLoadXhr=function(e5p,g5p,h5p,i5p,a5p,T5p,Q4p){var a3Q="text";var u3Q="tempFile";var F3Q="#tempFile";var K5p,v5p=this,W5p=N3t,t5p=N3t,x5p=N3t,F5p={},H5p=new FormData();if((h5p=this._getNumberValue(h5p,B1t,b1t),this.Source.LoadExcel && this.Source.LoadText)){(b3t == e5p?x5p=b1t == Q.g_isDirectLoadExcel?(W5p=y3Q,this.Source.DirectLoadExcel.Url=this._getDefault(this.Source.DirectLoadExcel.Url,J2t),t5p=this.Source.DirectLoadExcel.Url,F5p={".xls":b1t,".xlsx":b1t},t3t):(W5p=n3Q,this.Source.LoadExcel.Url=this._getDefault(this.Source.LoadExcel.Url,P2t),t5p=this.Source.LoadExcel.Url,F5p={".":b1t,".txt":b1t,".csv":b1t},u3t):F3t == e5p?(Q.g_targetTextSheetID=this.id,W5p=d3Q,this.Source.LoadText.Url=this._getDefault(this.Source.LoadText.Url,p3Q),t5p=this.Source.LoadText.Url):r0t == e5p && (F5p={".":b1t,".txt":b1t,".csv":b1t,".xls":b1t,".xlsx":b1t},x5p=u3t),actionUrl=t5p,actionUrl+=(B1t <= t5p.indexOf(i5t)?T5t:i5t) + x5t + W5p,i5p && G9t == typeof i5p && Object.keys(i5p).forEach(function(l4p,M4p){H5p.append(l4p,i5p[l4p]);}),H5p.append(N3Q,g5p),V.querySelector(F3Q) && V.querySelector(F3Q).parentNode.removeChild(V.querySelector(F3Q)));t5p=J3t;if(((t5p=V.createElement(H5t)).type=m3Q,t5p.id=u3Q,t5p.style.display=Q4t,a5p)){for(var C5p=(a5p + N3t).split(j6t),r5p=N3t,E5p=B1t;E5p < C5p.length;E5p++)(B1t < E5p && (r5p+=Z3Q),r5p+=o6t + C5p[E5p].replace(o6t,N3t));t5p.accept=r5p;}(t5p.onchange=function(o4p){var D4p=this.value,z4p=o4p.target.files[B1t].size,V4p=V3t * h5p * V3t;if(N3t != this.value){if(B1t < V4p && V4p < z4p)return (v5p.hideMessage(),void v5p.ShowAlert(v5p.getMessage(A3Q,E3t).replace(/%d/g,h5p + Y3Q),v3t));if(N3t != a5p)for((F5p={},K5p=a5p.split(j6t),E5p=B1t,max=K5p.length);E5p < max;E5p++)F5p[o6t + K5p[E5p]]=b1t;if(N3t != D4p && -b1t < D4p.indexOf(o6t))if((a5p=D4p.substring(D4p.lastIndexOf(o6t),D4p.length).toLowerCase(),F5p[a5p])){(Q.OnLoadFileSelect && Q.OnLoadFileSelect(v5p,e5p,this.value),H5p.append(m3Q,o4p.target.files[B1t]));try{u5p.send(H5p);}catch(I4p){}}else v5p.ShowAlert(v5p.getMessage(x5p,E3t),v3t);}},V.body.appendChild(t5p));var u5p=new XMLHttpRequest();(u5p.open(a5t,actionUrl),T5p && G9t == typeof T5p && Object.keys(T5p).forEach(function(q4p,w4p){u5p.setRequestHeader(q4p,T5p[q4p]);}),u5p.responseType=a3Q,u5p.onload=function(R4p){var W3Q="postMessage";var h1t=13;var h3Q="n";var x1t=20;var e3Q="'";var H3Q="'*');";var J4p=u5p.response;if(Q4p)for(var P4p=B1t;B1t <= P4p;)(w({data:J4p.substring(J4p.indexOf(W3Q,P4p) + h1t,J4p.indexOf(H3Q,P4p) - E1t).replace(/\\'/g,e3Q).replace(/\\n/g,h3Q)}),P4p=J4p.indexOf(H3Q,P4p) < B1t?-b1t:J4p.indexOf(H3Q,P4p) + x1t);else w({data:J4p.substring(J4p.indexOf(W3Q) + h1t,J4p.indexOf(H3Q) - E1t).replace(/\\'/g,e3Q).replace(/\\n/g,h3Q)});},t5p.click());}},M._prepareExportSetting=function(){var K3Q="";var C3Q="";var r3Q="";var T3Q=".jsp";var x3Q="";var g3Q="";for(var d4p=N3t,f4p=(this.Source.Export && B9t == typeof this.Source.Export.Url?((d4p=this.Source.Export.Url.split(a2t))[d4p.length - b1t]=N3t,d4p=d4p.join(a2t)):this.Export && B9t == typeof this.Export.Url && ((d4p=this.Export.Url.split(a2t))[d4p.length - b1t]=N3t,d4p=d4p.join(a2t)),[b5t,n3Q,t5t,d3Q,v5t,i3Q,B5t,y3Q]),n4p=B1t;n4p < f4p.length;n4p++)(this.Source[f4p[n4p]] || (this.Source[f4p[n4p]]={}),this.Source.Export[f4p[n4p] + h4t]?this.Source[f4p[n4p]].Url=this.Source.Export[f4p[n4p] + h4t]:this.Source[f4p[n4p]].Url?this.Source[f4p[n4p]].Url=this.Source[f4p[n4p]].Url:this.Source[f4p[n4p]].Url=N3t == d4p?f4p[n4p] + T3Q:d4p + f4p[n4p] + T3Q);if((this.ImageList=[],this.Down2ExcelBufferInfo || (this.Down2ExcelBufferInfo={}),this.g_LoadExcelBufferCfg || (this.g_LoadExcelBufferCfg={}),this._eventFunctions={},this.MarkupTagDelimiter?(this.MarkupTagSS=this.MarkupTagDelimiter[B1t],this.MarkupTagSE=this.MarkupTagDelimiter[b1t],this.MarkupTagES=this.MarkupTagDelimiter[t1t],this.MarkupTagEE=this.MarkupTagDelimiter[E1t]):(this.MarkupTagSS=l0t,this.MarkupTagSE=M0t,this.MarkupTagES=D0t,this.MarkupTagEE=M0t),this.IB_DELIMITER_ROW=x3Q,this.IB_DELIMITER_COL=r3Q,this.IB_DELIMITER_SHEET=R3t,this.IB_DELIMITER_END=K3Q,this.IB_DELIMITER_TITLE_NEWLINE=K3Q,this.IB_DELIMITER_TITLE_BACKSLASH=r3Q,this.IB_DELIMITER_COLOR=C3Q,this.IB_DELIMITER_TREE_INDENT=g3Q,this.DataRows=this.MultiRecord && b1t & this.MultiRecordShape?this.MultiRecordMax:b1t,this.SearchSync=B1t,this.MultiRecord && b1t & this.MultiRecordShape)){this._DownMultiMap=[];for(var y4p=B1t;y4p < this.DataRows;y4p++){this._DownMultiMap.push([]);for(var k4p=B1t;k4p < this.MultiHeaderMap[B1t].length;k4p++)this._DownMultiMap[y4p][k4p]=this.MultiHeaderMap[y4p][k4p];}for(y4p=B1t;y4p < this.DataRows;y4p++)for(k4p=B1t;k4p < this.MultiHeaderMap[B1t].length;k4p++)if(this._DownMultiMap[y4p][k4p] && b1t < this.Cols[this._DownMultiMap[y4p][k4p]].RecordColSpan && b1t < this.Cols[this._DownMultiMap[y4p][k4p]].RecordRowSpan)for(var X4p=B1t;X4p < this.Cols[this._DownMultiMap[y4p][k4p]].RecordRowSpan;X4p++){for(var p4p=b1t;p4p < this.Cols[this._DownMultiMap[y4p][k4p]].RecordColSpan;p4p++)this._DownMultiMap[y4p + X4p][k4p + p4p]=void B1t;B1t < X4p && (this._DownMultiMap[y4p + X4p][k4p]=void B1t);}else if(this._DownMultiMap[y4p][k4p] && b1t < this.Cols[this._DownMultiMap[y4p][k4p]].RecordColSpan){for(X4p=b1t;X4p < this.Cols[this._DownMultiMap[y4p][k4p]].RecordColSpan;X4p++)this._DownMultiMap[y4p][k4p + X4p]=void B1t;k4p+=this.Cols[this._DownMultiMap[y4p][k4p]].RecordColSpan - b1t;}else if(this._DownMultiMap[y4p][k4p] && b1t < this.Cols[this._DownMultiMap[y4p][k4p]].RecordRowSpan)for(X4p=b1t;X4p < this.Cols[this._DownMultiMap[y4p][k4p]].RecordRowSpan;X4p++)this._DownMultiMap[y4p + X4p][k4p]=void B1t;}},M._removeForm=function(G4p){G4p=V.getElementById(G4p);G4p && (G4p.innerHTML=J3t,V.body.removeChild(G4p));},M._removeHTMLTag=function(c4p,U4p){if(J3t == c4p || B9t != typeof c4p)return N3t;switch(U4p){case b1t:return c4p.replace(/<([^>]*)>/gi,N3t);case t1t:return c4p.replace(/<(\/)?([a-zA-Z]*)(\s[a-zA-Z]*[^>]*)?(\s)*(\/)?>/gi,N3t);default:return c4p.replace(/<(\/)?([a-zA-Z]*)(\s[a-zA-Z]*=[^>]*)?(\s)*(\/)?>/gi,N3t);}},M._selectFileAction=function(Z4p,N4p,B4p,m4p,S4p){var A4p,Y4p,j4p=N3t,L4p=N3t,O4p=B1t,s4p={};if((b3t == N4p?(s4p={".xls":b1t,".xlsx":b1t},j4p=f3Q,L4p=t3t):F3t == N4p?(s4p={".":b1t,".txt":b1t,".csv":b1t},j4p=c3Q,L4p=u3t,S4p.indexOf(o6t) < B1t && (S4p+=o6t)):r0t == N4p && (s4p={".":b1t,".txt":b1t,".csv":b1t,".xls":b1t,".xlsx":b1t},j4p=f3Q,L4p=u3t,S4p.indexOf(o6t) < B1t && (S4p+=o6t)),N3t != m4p))for((s4p={},O4p=B1t,A4p=(Y4p=m4p.split(j6t)).length);O4p < A4p;O4p++)s4p[o6t + Y4p[O4p]]=b1t;N3t != S4p && (-b1t < S4p.indexOf(o6t) && s4p[m4p=S4p.substring(S4p.lastIndexOf(o6t),S4p.length).toLowerCase()]?(F3t != N4p && r0t != N4p || o6t != m4p || (S4p=S4p.substring(B1t,S4p.lastIndexOf(o6t))),Z4p.target=j4p,Z4p.submit(),Q.OnLoadFileSelect && Q.OnLoadFileSelect(this,N4p,S4p)):this.ShowAlert(this.getMessage(L4p,E3t),v3t));},M._setRowData=function(b4p,t4p,E4p,v4p,F4p){(b4p[t4p]=v4p,b4p[t4p + j8t]=F4p,b4p[t4p + S2t]=E4p);},M._setRowProperty=function(u4p,a4p,W4p){(u4p.Kind=a4p.Kind,u4p.id=a4p.id,u4p.UnitPos=a4p.UnitPos,u4p.SubSumRow=G2t === a4p.Name,u4p.CumulateRow=a4p.CumulateRow,u4p.RowMerge=a4p.RowMerge,u4p.Status=W4p);},M._trim=function(H4p){return H4p=(H4p+=N3t).replace(k9t,N3t).replace(y9t,N3t);},M._validInputRow=function(e4p,x4p){var Q9Q="D";var M9Q="S";var D9Q="P";var l9Q="F";var h4p,g4p,i4p=-b1t,T4p=B1t,r4p={},C4p={NoDataRow:b1t,GroupRow:b1t,CountRow:b1t,FillRow:b1t,ToolBar:b1t},K4p=B1t;if(x4p)for((T4p=B1t,g4p=(x4p=x4p.split(j6t)).length);T4p < g4p;T4p++)switch(x4p[T4p]){case p5t:r4p.Header=b1t;break;case Q9Q:r4p.Data=b1t;break;case l9Q:C4p.Filter=b1t;break;case M9Q:break;case D9Q:K4p=b1t;}return (J3t != e4p && G9t == typeof e4p && void B1t !== e4p.Kind?h4p=e4p:(e4p=this._getNumberValue(e4p),isNaN(e4p) || (h4p=this.getRowByIndex(e4p))),h4p && (r4p[(i4p=h4p).Kind] && (i4p=-b1t),C4p[h4p.id] && (i4p=-b1t),K4p && f2t === h4p.id && (i4p=-b1t),K4p && (G2t === h4p.Name || h4p.CumulateRow) && (i4p=-b1t)),i4p);},M.Down2Text=function(l0p){var o9Q="EUC-KR";var I9Q="Down2Text.jsp";var V0p,o0p,z0p,D0p=this,Q0p=Q._ibsUtil.cloneArray(l0p),M0p=(void B1t === Q0p && (Q0p=[]),this._prepareExportSetting(),Q0p && !Q0p.DebugMode && this.showMessage(this.getMessage(k6t)),l0p=this.Down2TextConfig,Q0p.checkBoxOffValue=this._getDefault(void B1t !== Q0p.checkBoxOffValue?Q0p.checkBoxOffValue:Q0p.CheckBoxOffValue,this._getDefault((l0p=void B1t === l0p?{}:l0p).checkBoxOffValue,n9t)),Q0p.checkBoxOnValue=this._getDefault(void B1t !== Q0p.checkBoxOnValue?Q0p.checkBoxOnValue:Q0p.CheckBoxOnValue,this._getDefault(l0p.checkBoxOnValue,y6t)),Q0p.debugMode=this._getDefault(void B1t !== Q0p.debugMode?Q0p.debugMode:Q0p.DebugMode,this._getDefault(l0p.debugMode,!b1t)),Q0p.downCols=this._getDefault(void B1t !== Q0p.downCols?Q0p.downCols:Q0p.DownCols,this._getDefault(l0p.downCols,N3t)),Q0p.downCombo=this._getDefault(void B1t !== Q0p.downCombo?Q0p.downCombo:Q0p.DownCombo,this._getDefault(l0p.downCombo,A5t)).toUpperCase(),Q0p.downHeader=this._getDefault(void B1t !== Q0p.downHeader?Q0p.downHeader:Q0p.DownHeader,this._getDefault(l0p.downHeader,!B1t)),Q0p.downRows=this._getDefault(void B1t !== Q0p.downRows?Q0p.downRows:Q0p.DownRows,this._getDefault(l0p.downRows,N3t)),Q0p.downSum=this._getDefault(void B1t !== Q0p.downSum?Q0p.downSum:Q0p.DownSum,this._getDefault(l0p.downSum,!B1t)),Q0p.downTreeHide=this._getDefault(void B1t !== Q0p.downTreeHide?Q0p.downTreeHide:Q0p.DownTreeHide,this._getDefault(l0p.downTreeHide,! !this.ExcelTreeMode)),Q0p.excludeSubSum=this._getDefault(void B1t !== Q0p.excludeSubSum?Q0p.excludeSubSum:Q0p.ExcludeSubSum,this._getDefault(l0p.excludeSubSum,B1t)),Q0p.extendParam=this._getDefault(void B1t !== Q0p.extendParam?Q0p.extendParam:Q0p.ExtendParam,this._getDefault(l0p.extendParam,N3t)),Q0p.extendParamMethod=this._getDefault(void B1t !== Q0p.extendParamMethod?Q0p.extendParamMethod:Q0p.ExtendParamMethod,this._getDefault(l0p.extendParamMethod,N3t)),Q0p.fileName=this._getDefault(void B1t !== Q0p.fileName?Q0p.fileName:Q0p.FileName,this._getDefault(l0p.fileName,A5t)),Q0p.RequiredMark=this._getDefault((Q0p.RequiredMark,Q0p.RequiredMark),this._getDefault(l0p.RequiredMark,!B1t)),Q0p.multipart=this._getDefault(void B1t !== Q0p.multipart?Q0p.multipart:Q0p.Multipart,this._getDefault(l0p.multipart,!B1t)),Q0p.rowDelim=this._getDefault(void B1t !== Q0p.rowDelim?Q0p.rowDelim:Q0p.RowDelim,this._getDefault(l0p.rowDelim,e9t)),Q0p.sheetName=this._getDefault(void B1t !== Q0p.sheetName?Q0p.sheetName:Q0p.SheetName,this._getDefault(l0p.sheetName,X6t)),Q0p.colLength=this._getDefault(void B1t !== Q0p.colLength?Q0p.colLength:Q0p.ColLength,this._getDefault(l0p.colLength,N3t)),Q0p.colLength2Byte=this._getDefault(void B1t !== Q0p.colLength2Byte?Q0p.colLength2Byte:Q0p.ColLength2Byte,this._getDefault(l0p.colLength2Byte,!B1t)),Q0p.emptyChar=this._getDefault(void B1t !== Q0p.emptyChar?Q0p.emptyChar:Q0p.EmptyChar,this._getDefault(l0p.emptyChar,N6t)),Q0p.fillRight=this._getDefault(void B1t !== Q0p.fillRight?Q0p.fillRight:Q0p.FillRight,this._getDefault(l0p.fillRight,!B1t)),Q0p.cutText=this._getDefault(void B1t !== Q0p.cutText?Q0p.cutText:Q0p.CutText,this._getDefault(l0p.cutText,!b1t)),Q0p.timeout=this._getDefault(void B1t !== Q0p.timeout?Q0p.timeout:Q0p.Timeout,this._getDefault(l0p.timeout,B1t)),Q0p.useXhr=this._getDefault((Q0p.useXhr,Q0p.useXhr),this._getDefault(l0p.useXhr,!b1t)),Q0p.reqHeader=Q0p.reqHeader || l0p.reqHeader,Q0p.sendParam=Q0p.sendParam || l0p.sendParam,Q0p.fileName.toLowerCase().split(o6t,-b1t));if((V9Q == M0p[M0p.length - b1t]?(Q0p.colDelim=this._getDefault(void B1t !== Q0p.colDelim?Q0p.colDelim:Q0p.ColDelim,this._getDefault(l0p.colDelim,f9t)),Q0p.downloadEncoding=this._getDefault(void B1t !== Q0p.downloadEncoding?Q0p.downloadEncoding:Q0p.DownloadEncoding,this._getDefault(l0p.downloadEncoding,o9Q))):(Q0p.colDelim=this._getDefault(void B1t !== Q0p.colDelim?Q0p.colDelim:Q0p.ColDelim,this._getDefault(l0p.colDelim,z9Q)),Q0p.downloadEncoding=this._getDefault(void B1t !== Q0p.downloadEncoding?Q0p.downloadEncoding:Q0p.DownloadEncoding,this._getDefault(l0p.downloadEncoding,N3t))),this._autoExcelModeCheck(Q0p,this.AutoExcelMode,F3t,!B1t,!b1t)))return (N3t != Q0p.downRows && Q0p.downTreeHide && (Q0p.downTreeHide=B1t),Q0p.downRows=j6t + Q0p.downRows + j6t,L6t != (M0p=Q0p.downCols) && (j6t == (M0p=j6t == M0p.substring(B1t,b1t)?M0p.substring(b1t):M0p).substring(M0p.length - b1t) && (M0p=M0p.substring(B1t,M0p.length - b1t)),Q0p.downCols=M0p),N3t != (l0p=Q0p.colLength) && L6t != l0p && (j6t == (l0p=j6t == l0p.substring(B1t,b1t)?l0p.substring(b1t):l0p).substring(l0p.length - b1t) && (l0p=l0p.substring(B1t,l0p.length - b1t)),Q0p.colLength=l0p),void B1t !== this.Source.Down2Text.Url && N3t != this.Source.Down2Text.Url || (this.Source.Down2Text.Url=I9Q),V0p=this.Source.Down2Text.Url,o0p=Q0p.extendParam,z0p=Q0p.extendParamMethod,this._getDown2Text(Q0p,function(I0p){D0p._sendDown(I0p,V0p,o0p,z0p,Q0p.multipart,F3t,Q0p.debugMode,Q0p.timeout,Q0p.useXhr,Q._ibsUtil.getFileName(Q0p.fileName,q9Q),Q0p.sendParam,Q0p.reqHeader);}));setTimeout(function(){D0p.hideMessage();},H1t);},M.GetDown2TextConfig=function(){return this.Down2TextConfig;},M.GetDown2TextUrl=function(){var q0p=N3t;return q0p=this.Source.Down2Text.Url?this.Source.Down2Text.Url:q0p;},M.GetLoadTextConfig=function(){return this.LoadTextConfig || ({});},M.GetLoadTextUrl=function(){var w0p=N3t;return w0p=this.Source.LoadText.Url?this.Source.LoadText.Url:w0p;},M.LoadText=function(J0p){(this.HasLoadedExcelData && delete this.HasLoadedExcelData,this.LoadFileType=F3t);var y0p,n0p,X0p,f0p,J0p=Q._ibsUtil.cloneArray(J0p),P0p={},R0p=N3t,k0p=[],P0p=(void B1t === J0p && (J0p=[]),void B1t !== this.LoadTextConfig && (P0p=this.LoadTextConfig),this._prepareExportSetting(),J0p.append=this._getDefault(void B1t !== J0p.append?J0p.append:J0p.Append,this._getDefault(P0p.append,!b1t)),J0p.fileExt=this._getDefault(void B1t !== J0p.fileExt?J0p.fileExt:J0p.FileExt,this._getDefault(P0p.fileExt,N3t)),J0p.maxFileSize=this._getDefault(void B1t !== J0p.maxFileSize?J0p.maxFileSize:J0p.MaxFileSize,this._getDefault(P0p.maxFileSize,B1t,A6t)),J0p.mode=this._getDefault(void B1t !== J0p.mode?J0p.mode:J0p.Mode,this._getDefault(P0p.mode,Y6t)),J0p.encoding=this._getDefault(void B1t !== J0p.encoding?J0p.encoding:J0p.Encoding,this._getDefault(P0p.encoding,N3t)),J0p.deli=this._getDefault(void B1t !== J0p.deli?J0p.deli:J0p.Deli,this._getDefault(P0p.deli,z9Q)),J0p.colSeparator=this._getDefault(void B1t !== J0p.colSeparator?J0p.colSeparator:J0p.ColSeparator,this._getDefault(P0p.colSeparator,z9Q)),z9Q !== J0p.colSeparator && J0p.colSeparator !== J0p.deli && (J0p.deli=J0p.colSeparator),J0p.colLength=this._getDefault(void B1t !== J0p.colLength?J0p.colLength:J0p.ColLength,this._getDefault(P0p.colLength,N3t)),J0p.colLength2Byte=this._getDefault(void B1t !== J0p.colLength2Byte?J0p.colLength2Byte:J0p.ColLength2Byte,this._getDefault(P0p.colLength2Byte,!B1t)),J0p.emptyChar=this._getDefault(void B1t !== J0p.emptyChar?J0p.emptyChar:J0p.EmptyChar,this._getDefault(P0p.emptyChar,N6t)),J0p.fillRight=this._getDefault(void B1t !== J0p.fillRight?J0p.fillRight:J0p.FillRight,this._getDefault(P0p.fillRight,!B1t)),J0p.hideSeq=v9t == typeof J0p.hideSeq && B1t <= J0p.hideSeq && J0p.hideSeq <= t1t?J0p.hideSeq:t1t,J0p.useXhr=this._getDefault((J0p.useXhr,J0p.useXhr),this._getDefault(P0p.useXhr,!b1t)),J0p.reqHeader=J0p.reqHeader || P0p.reqHeader,J0p.sendParam=J0p.sendParam || P0p.sendParam,J0p.colLength);(N3t != P0p && L6t != P0p && (j6t == (P0p=j6t == P0p.substring(B1t,b1t)?P0p.substring(b1t):P0p).substring(P0p.length - b1t) && (P0p=P0p.substring(B1t,P0p.length - b1t)),J0p.colLength=P0p),void B1t !== J0p.DialogType && (J0p.dialogType=J0p.DialogType),this._uploadDialogDelim=J0p.deli,this._uploadDialogLoadType=J0p.dialogType,this._autoExcelModeCheck(J0p,this.AutoExcelMode,F3t,!b1t,!b1t) && (this.GetLoadColNames(k0p,J0p),P0p=this._getHeaderText(k0p),y0p=(k0p=this._getColInfo(J0p,k0p,!b1t)).name,k0p.saveName,n0p=k0p.type,X0p=k0p.format,f0p=k0p.datePattern,dataFormat=k0p.dataFormat,R0p=(R0p=(R0p=(R0p=(R0p=(R0p=(R0p=(R0p=(R0p=(R0p=(R0p=(R0p=(R0p=(R0p=(R0p=(R0p=(R0p=(R0p=(R0p=(R0p=(R0p+=this._makeColumnTag(B6t,J0p.DateStrictMode?b1t:B1t)) + this._makeColumnTag(T6t,J0p.mode.replace(/ /g,N3t).toUpperCase())) + this._makeColumnTag(w9Q,J0p.deli)) + this._makeColumnTag(b6t,J0p.append?b1t:B1t)) + this._makeColumnTag(E6t,this.SearchMode)) + this._makeColumnTag(v6t,J0p.extendParam)) + this._makeColumnTag(F6t,this.ColCount)) + this._makeColumnTag(u6t,dataFormat)) + this._makeColumnTag(a6t,this.getHeaderRows().length)) + this._makeColumnTag(x6t,void B1t !== this.StatusCol?this.StatusCol:N3t)) + this._makeColumnTag(K6t,y0p)) + this._makeColumnTag(g6t,P0p)) + this._makeColumnTag(Q2t,y0p)) + this._makeColumnTag(l2t,n0p)) + this._makeColumnTag(M2t,X0p)) + this._makeColumnTag(D2t,f0p)) + this._makeColumnTag(J9Q,J0p.encoding)) + this._makeColumnTag(P9Q,J0p.colLength)) + this._makeColumnTag(R9Q,J0p.colLength2Byte?b1t:B1t)) + this._makeColumnTag(k9Q,J0p.emptyChar)) + this._makeColumnTag(y9Q,J0p.fillRight?b1t:B1t),E9t != typeof o.postMessage && G9t != typeof o.postMessage || (R0p+=this._makeColumnTag(k2t,this.id)),J0p.useXhr || J0p.reqHeader && G9t == typeof J0p.reqHeader?this._makeLoadXhr(F3t,R0p,J0p.maxFileSize,J0p.sendParam,J0p.fileExt,J0p.reqHeader):this._makeLoadForm(F3t,!b1t,J0p.fileExt,R0p,J0p.maxFileSize,J0p.serverFile,J0p.sendParam)));},M.SetDown2TextConfig=function(d0p){(this.Down2TextConfig=Q._ibsUtil.cloneArray(d0p),void B1t !== this.Down2TextConfig.downHeader && (y6t === this.Down2TextConfig.downHeader?this.Down2TextConfig.downHeader=!B1t:n9t === this.Down2TextConfig.downHeader && (this.Down2TextConfig.downHeader=!b1t)),void B1t !== this.Down2TextConfig.downSum && (y6t === this.Down2TextConfig.downSum?this.Down2TextConfig.downSum=!B1t:n9t === this.Down2TextConfig.downSum && (this.Down2TextConfig.downSum=!b1t)),void B1t !== this.Down2TextConfig.RequiredMark && (y6t === this.Down2TextConfig.RequiredMark?this.Down2TextConfig.RequiredMark=!B1t:n9t === this.Down2TextConfig.RequiredMark && (this.Down2TextConfig.RequiredMark=!b1t)),void B1t !== this.Down2TextConfig.multipart && (y6t === this.Down2TextConfig.multipart?this.Down2TextConfig.multipart=!B1t:n9t === this.Down2TextConfig.multipart && (this.Down2TextConfig.multipart=!b1t)));},M.SetDown2TextUrl=function(p0p){(this.Source.Down2Text || (this.Source.Down2Text={}),this.Source.Down2Text.Url=p0p);},M.SetLoadTextConfig=function(G0p){(this.LoadTextConfig=Q._ibsUtil.cloneArray(G0p),void B1t !== this.LoadTextConfig.append && (y6t === this.LoadTextConfig.append?this.LoadTextConfig.append=!B1t:n9t === this.LoadTextConfig.append && (this.LoadTextConfig.append=!b1t)));},M.SetLoadTextUrl=function(c0p){(this.Source.LoadText || (this.Source.LoadText={}),this.Source.LoadText.Url=c0p);},M._exportCsv=function(Z0p,Y0p,B0p,b0p,t0p,O0p,E0p){for(var A0p,S0p,L0p=[],U0p=J3t,N0p=B1t,j0p=[],s0p=N3t,m0p=b1t < this.DataRows,U0p=this.getFirstRow(J3t,W1t);U0p;U0p=this.getNextRow(U0p))if(!U0p || f2t !== U0p.id && G2t !== U0p.Name && G7t !== U0p.Name){for((N0p=B1t,A0p=Z0p.length);N0p < A0p;N0p++)if((S0p=Z0p[N0p],!m0p || U0p.UnitPos == S0p.UnitPos)){if((s0p=b1t == t0p && void B1t === S0p.Name?N3t:Y0p?this._getCellText(U0p,S0p.Name):this._getCellValue(U0p,S0p.Name),S0p.Name === E0p && b1t != s0p))break;(void B1t !== O0p && (s0p=s0p.replace(/\r\n/g,O0p).replace(/\n/g,O0p)),j0p.push(s0p));}m0p && U0p.UnitPos != this.DataRows - b1t || B1t < j0p.length && (L0p.push(j0p.join(B0p)),j0p=[]);}return L0p=L0p.join(b0p);},M._getDown2Text=function(F0p,T0p){var X9Q="ColDelim";var n9Q="RowDelim";var d9Q="DownloadEncoding";var i0p,H0p,e0p=[],h0p=this,v0p=N3t,a0p=L6t != F0p.downRows,W0p=[],u0p=(W0p=this.MultiRecord && b1t & this.MultiRecordShape?this._DownMultiMap[B1t]:this._getDownColNames(F0p)).length;return B1t == u0p?(this.hideMessage(),IBSheet.OnDownFinish && IBSheet.OnDownFinish(this,F3t,!b1t),-b1t):(a0p={from:F3t,cfg:F0p,sheetDesign:!b1t,isTreeLevel:B1t,isDownRows:a0p,isDownRowVisible:B1t,rowHeights:[],downColNames:W0p,downColNamesLength:u0p,data:e0p,p:b1t,headerRows:B1t,isHeaderMerge:B1t},F0p.downHeader && (H0p=this._getHeaderData(a0p),a0p.p=H0p.p),b1t != Q.g_isDirectDown2Excel && (H0p=this._getBodyData(a0p)).p,this.fileDownloadCheckToken=new Date().getTime(),Q.fileDownloadCheckTimer=o.setInterval(function(){h0p._getCookie(Z6t) == h0p.fileDownloadCheckToken && (h0p.fileDownloadCheckToken=J3t,h0p._finishDownload(F3t));},l3t),v0p+=this._makeColumnTag(u2t,this.fileDownloadCheckToken),a0p=(u0p=this._getColInfo(F0p,W0p,B1t)).saveName,H0p=u0p.type,W0p=u0p.format,u0p=u0p.orgFormat,(i0p=location.href.substring(location.href.indexOf(S9t) + t1t).split(a2t))[B1t]=N3t,i0p[i0p.length - b1t]=N3t,v0p=(v0p=(v0p=(v0p=(v0p=(v0p=(v0p=(v0p=(v0p=(v0p=(v0p=(v0p=(v0p=(v0p=(v0p=(v0p=(v0p+=this._makeColumnTag(x2t,i0p.join(a2t))) + this._makeColumnTag(r2t,Q._ibsUtil.getFileName(F0p.fileName,q9Q))) + this._makeColumnTag(n9Q,F0p.rowDelim)) + this._makeColumnTag(X9Q,F0p.colDelim)) + this._makeColumnTag(v6t,F0p.extendParam)) + this._makeColumnTag(K6t,a0p)) + this._makeColumnTag(I7t,H0p)) + this._makeColumnTag(q7t,W0p)) + this._makeColumnTag(w7t,u0p)) + this._makeColumnTag(n7t,F0p.downHeader?b1t:B1t)) + this._makeColumnTag(P9Q,F0p.colLength)) + this._makeColumnTag(R9Q,F0p.colLength2Byte?b1t:B1t)) + this._makeColumnTag(k9Q,F0p.emptyChar)) + this._makeColumnTag(y9Q,F0p.fillRight?b1t:B1t)) + this._makeColumnTag(f9Q,F0p.cutText?b1t:B1t)) + this._makeColumnTag(d9Q,F0p.downloadEncoding)) + this.IB_DELIMITER_ROW,e0p[B1t]=v0p,F0p.debugMode?e0p.join(N3t):void (T0p && T0p(e0p.join(N3t))));},M.ExportData=function(x0p){var G9Q="json";var p9Q="xml";var g0p,M8p,D8p,V8p,o8p,Q8p,l8p,z8p,r0p=[],C0p=B1t,K0p=N3t;if(J3t == x0p || void B1t === x0p)return this.InvalidValue;for((g0p=(x0p.type || x0p.Type || N3t).toLowerCase(),V8p=x0p.colDelim || x0p.ColDelim || f9t,o8p=x0p.rowDelim || x0p.RowDelim || s6t,Q8p=void B1t === x0p.mode || void B1t === x0p.Mode?B1t:J3t,Q8p=this._getNumberValue(Q8p,B1t),x0p.Cols=x0p.Cols || x0p.cols,x0p.Cols=void B1t === x0p.Cols?[]:(x0p.Cols + N3t).split(j6t),l8p=this._getBooleanValue(x0p.FormattedText,B1t),z8p=this._getBooleanValue(x0p.StyleProperty,B1t),C0p=B1t,M8p=x0p.Cols.length);C0p < M8p;C0p++)(V9Q == g0p && b1t === Q8p && N3t === x0p.Cols[C0p] && r0p.push({}),-b1t !== (D8p=this.Cols[x0p.Cols[C0p]]) && r0p.push({Name:D8p.Name}));if(B1t === r0p.length)for(K0p in this.Cols)N8t == K0p || Q3Q == K0p || K0p == (this.RowIndex || z5t) && b1t != this.Cols[K0p].Visible || r0p.push({Name:K0p});return p9Q == g0p?this._exportXml(r0p,l8p,x0p.checkCol):G9Q == g0p?this._exportJson(r0p,l8p,z8p,x0p.checkCol):V9Q == g0p?this._exportCsv(r0p,l8p,V8p,o8p,Q8p,x0p.newLine || x0p.NewLine,x0p.checkCol):this.InvalidValue;},M.GetAutoSumPosition=function(){return this.FormulaRowPosition;},M.GetColIndexInfo=function(){var w8p,J8p,q8p=B1t,I8p=B1t,P8p=this.ColNames.length;for((this.ColIndexInfo=[],q8p=B1t);q8p < P8p;q8p++)for((I8p=B1t,J8p=(w8p=this.ColNames[q8p]).length);I8p < J8p;I8p++)N8t !== w8p[I8p] && v2t !== w8p[I8p] && this.ColIndexInfo.push(w8p[I8p]);},M.GetColName=function(R8p){return this.Cols[R8p]?R8p:this.SaveNameInfo[R8p]?this.SaveNameInfo[R8p].ColName:N3t;},M.GetDataRowHeight=function(){return this.RowHeight || this.MinRowHeight;},M.GetExcelRowHeight=function(y8p,p8p){var k8p=this._validInputRow(y8p),y8p=B1t;if(-b1t === k8p)return this.InvalidValue;if(!k8p.Visible)return y8p;if(IBSheet.BIE8Strict && !IBSheet.BIE9Strict && k8p.r1){if(this.MultiRecord && b1t & this.MultiRecordShape && k8p.r1)for(var X8p=k8p.r1.firstChild.firstChild.firstChild.firstChild.firstChild.firstChild.nextSibling,n8p=B1t;X8p;){if(n8p == p8p)return X8p.offsetHeight;(X8p=X8p.nextSibling,n8p++);}for(n8p=B1t;n8p < k8p.r1.childNodes.length;n8p++){var f8p=k8p.r1.childNodes[n8p].offsetHeight,d8p=d8p || f8p;B1t < f8p && f8p < d8p && (d8p=f8p);}y8p=d8p || this.MinRowHeight;}else y8p=(y8p=this.GetRHeight(k8p,p8p)) || this.MinRowHeight;return y8p;},M.GetFirstColA=function(U8p,j8p){for(var L8p=[N8t,Q3Q],S8p=this.ColNames,N8p=this.Cols,O8p=J3t == U8p?(U8p=B1t,S8p.length):B1t == U8p?b1t:b1t == U8p?S8p.length - b1t:(U8p=S8p.length - b1t,S8p.length),s8p=U8p;s8p < O8p;s8p++){for(var G8p=B1t,c8p=S8p[s8p];c8p[G8p] && (-b1t < L8p.indexOf(c8p[G8p]) || !N8p[c8p[G8p]].Visible && t1t != j8p && (!j8p || !N8p[c8p[G8p]].Hidden));G8p++);if(c8p[G8p])return c8p[G8p];}return J3t;},M.GetHeaderBackColor=function(){for(var m8p,Z8p=N3t,A8p=B1t,A8p=B1t;A8p < this.XH.childNodes.length;A8p++)if(b8t == (m8p=GetNode(this.XH,A8p)).Kind){m8p.Background?Z8p=m8p.Background:(m8p=this.getCell(m8p,this.GetFirstColA())) && (m8p=GetStyle(m8p),Z8p=IBSheet._ibsUtil.getWebColor(m8p.backgroundColor));break;}return Z8p=-b1t === Z8p?this.InvalidValue:Z8p;},M.GetHeaderFontColor=function(){var c9Q="HeaderCheck";for(var B8p,E8p,b8p=N3t,t8p=B1t,Y8p=J3t,v8p=!b1t,t8p=B1t;t8p < this.XH.childNodes.length;t8p++)if(b8t == (B8p=GetNode(this.XH,t8p)).Kind){if(B8p.TextColor)b8p=B8p.TextColor;else if(B8p.Def && B8p.Def.TextColor)b8p=B8p.Def.TextColor;else {for((Y8p=this.GetFirstColA(),v8p=s5t == this.Cols[Y8p].Type && this.HeaderCheck || this.getAttribute(B8p,Y8p,c9Q));Y8p && v8p;)(Y8p=this.GetNextColA(Y8p),v8p=s5t == this.Cols[Y8p].Type && this.HeaderCheck || this.getAttribute(B8p,Y8p,c9Q));(E8p=this.getCell(B8p,Y8p)) && (E8p=GetStyle(E8p),b8p=IBSheet._ibsUtil.getWebColor(E8p.color));}break;}return b8p=-b1t === b8p?this.InvalidValue:b8p;},M.GetLoadColNames=function(F8p,u8p){for(col=this.GetFirstColA(J3t,t1t);col;col=this.GetNextColA(col))(u8p.DateStrictMode=this.DateStrictMode || this.Cols[col].DateStrictMode || this.Rows[col + B6t],b1t == u8p.unMatchColHidden?this.Cols[col].Visible && F8p.push(col):col == (this.RowIndex || z5t) && B1t == this.Cols[col].Visible && s8t == this.Cols[col].Def || Q3Q != col && F8p.push(col));},M.GetNextColA=function(e8p){if(!e8p)return J3t;var h8p=this.Cols;if(!h8p[e8p])return J3t;for(var W8p=h8p[e8p].Section,H8p=this.ColNames,a8p=h8p[e8p].Pos + b1t;;){for(;H8p[W8p][a8p] && N8t == H8p[W8p][a8p];)a8p++;if(H8p[W8p][a8p])return H8p[W8p][a8p];if((a8p=B1t,++W8p >= H8p.length))return J3t;}},M.GetOrgType=function(T8p,x8p){if(!T8p || !x8p || T8p.Page)return N3t;var r8p,i8p=T8p[x8p + a8t];return (J3t == (i8p=J3t == i8p && T8p.Def?T8p.Def[x8p + j8t]:i8p) && ((r8p=T8p.Space?this.DefCols.C:this.Cols[x8p]) && (i8p=r8p.LegacyType),I5t != T8p.Kind || CEditTypes[i8p] || N8t == i8p || Q3Q == x8p || (i8p=A5t)),i8p);},M.GetRHeight=function(K8p,l1t){if(!K8p)return B1t;if(this.MultiRecord && b1t & this.MultiRecordShape && K8p.r1)for(var g8p=K8p.r1.firstChild.firstChild.firstChild.firstChild.firstChild.firstChild.nextSibling,Q1t=B1t;g8p;){if(Q1t == l1t)return g8p.offsetHeight;(g8p=g8p.nextSibling,Q1t++);}if(IBSheet.BIE8Strict && !IBSheet.BIE9Strict){if(b8t != K8p.Kind)return K8p.Height || this.RowHeight;if(K8p.r1 && K8p.r1.offsetHeight - this.HeaderRowHeight >= this.HeaderRowHeight)return this.HeaderRowHeight;}if(K8p.r1)return K8p.r1.offsetHeight;var C8p=K8p.Height;return J3t != C8p?C8p:K8p.Page?this.GetPageHeight(K8p):J3t != (C8p=K8p.Def?K8p.Def.Height:C8p)?C8p:this.RowHeight;},M.GetSheetFontName=function(){var U9Q="Dotum";var D1t,M1t=U9Q;return (this.SheetFontName?M1t=this.SheetFontName:(D1t=this.XH.firstChild) && D1t.r1 && (M1t=GetStyle(D1t.r1).fontFamily.replace(/\"/gi,N3t).split(f9t)[B1t]),M1t);},M.GetSheetFontSize=function(){var e1t=12;var S9Q="px";var o1t,V1t=e1t;return (this.SheetFontSize?V1t=this.SheetFontSize:(o1t=this.XH.firstChild) && o1t.r1 && (V1t=GetStyle(o1t.r1).fontSize.replace(S9Q,N3t)),parseInt(V1t,H1t));},M.GetSheetPageLength=function(){var z1t=B1t;return z1t=this.Paging?this.PageLength:z1t;},M.GetStatusValue=function(J1t){var q1t=N3t,w1t=this.StatusCol,P1t=this.DataRows;if(!w1t)return q1t;if(b1t < P1t){for(var I1t=this.GetUnitBaseRow(J1t);I1t;I1t=this.getNextRow(I1t))if(N2t == this.getAttribute(I1t,w1t,j8t)){q1t=I1t[w1t];break;}}else q1t=J1t[w1t] || N3t;return q1t;},M.GetSumBackColor=function(y1t){var k1t=N3t,R1t=this.Rows.FormulaRow;return ((k1t=R1t && R1t.Background || this.SumBackColor) || (R1t=this.getCell(R1t,y1t || this.GetFirstColA())) && (y1t=GetStyle(R1t),k1t=IBSheet._ibsUtil.getWebColor(y1t.backgroundColor)),IBSheet._ibsUtil.getWebColor(k1t));},M.GetTheme=function(){return this.Style;},M.LoadFile=function(n1t){(this.HasLoadedExcelData && delete this.HasLoadedExcelData,this._prepareExportSetting());var G1t,c1t,U1t,S1t,n1t=Q._ibsUtil.cloneArray(n1t),f1t={},d1t={},X1t=N3t,p1t=[],f1t=(Q.g_targetExcelSheetID=this.id,Q.g_isLoadExcelBuffer || (Q.g_LoadExcelSheetID=[]),Q.g_LoadExcelSheetID.push(this.id),void B1t !== this.LoadExcelConfig && (f1t=this.LoadExcelConfig),void B1t !== this.LoadTextConfig && (d1t=this.LoadTextConfig),(n1t=void B1t === n1t?[]:n1t).append=this._getDefault(void B1t !== n1t.append?n1t.append:n1t.Append,this._getDefault(f1t.append,!b1t)),n1t.columnMapping=this._getDefault(void B1t !== n1t.columnMapping?n1t.columnMapping:n1t.ColumnMapping,this._getDefault(f1t.columnMapping,N3t)),n1t.debugMode=this._getDefault(void B1t !== n1t.debugMode?n1t.debugMode:n1t.DebugMode,this._getDefault(f1t.debugMode,!b1t)),n1t.endRow=this._getDefault(void B1t !== n1t.endRow?n1t.endRow:n1t.EndRow,this._getDefault(f1t.endRow,B1t)),n1t.extendParam=this._getDefault(void B1t !== n1t.extendParam?n1t.extendParam:n1t.ExtendParam,this._getDefault(f1t.extendParam,N3t)),n1t.fileExt=this._getDefault(void B1t !== n1t.fileExt?n1t.fileExt:n1t.FileExt,this._getDefault(f1t.fileExt,N3t)),n1t.maxFileSize=this._getDefault(void B1t !== n1t.maxFileSize?n1t.maxFileSize:n1t.MaxFileSize,this._getDefault(f1t.maxFileSize,B1t,A6t),A6t),n1t.merge=this._getDefault(void B1t !== n1t.merge?n1t.merge:n1t.Merge,this._getDefault(f1t.merge,b1t)),n1t.mode=this._getDefault(void B1t !== n1t.mode?n1t.mode:n1t.Mode,this._getDefault(f1t.mode,Y6t)),n1t.serverFile=this._getDefault(void B1t !== n1t.serverFile?n1t.serverFile:n1t.ServerFile,this._getDefault(f1t.serverFile,N3t)),n1t.startCol=this._getDefault(void B1t !== n1t.startCol?n1t.startCol:n1t.StartCol,this._getDefault(f1t.startCol,b1t)),n1t.startRow=this._getDefault(void B1t !== n1t.startRow?n1t.startRow:n1t.StartRow,this._getDefault(f1t.startRow,b1t)),n1t.unMatchColHidden=this._getDefault(void B1t !== n1t.unMatchColHidden?n1t.unMatchColHidden:n1t.UnMatchColHidden,this._getDefault(f1t.unMatchColHidden,N3t)),n1t.useDOM=this._getDefault(void B1t !== n1t.useDOM?n1t.useDOM:n1t.UseDOM,this._getDefault(f1t.useDOM,!b1t)),n1t.workSheetName=this._getDefault(void B1t !== n1t.workSheetName?n1t.workSheetName:n1t.WorkSheetName,this._getDefault(f1t.workSheetName,N3t)),n1t.workSheetNo=this._getDefault(void B1t !== n1t.workSheetNo?n1t.workSheetNo:n1t.WorkSheetNo,this._getDefault(f1t.workSheetNo,b1t)),n1t.encoding=this._getDefault(void B1t !== n1t.encoding?n1t.encoding:n1t.Encoding,this._getDefault(d1t.encoding,N3t)),n1t.deli=this._getDefault(void B1t !== n1t.deli?n1t.deli:n1t.Deli,this._getDefault(d1t.deli,z9Q)),n1t.colSeparator=this._getDefault(void B1t !== n1t.colSeparator?n1t.colSeparator:n1t.ColSeparator,this._getDefault(d1t.colSeparator,z9Q)),z9Q !== n1t.colSeparator && n1t.colSeparator !== n1t.deli && (n1t.deli=n1t.colSeparator),n1t.skipEmptyRow=this._getDefault(void B1t !== n1t.skipEmptyRow?n1t.skipEmptyRow:n1t.SkipEmptyRow,this._getDefault(f1t.skipEmptyRow,!B1t)),n1t.colLength=this._getDefault(void B1t !== n1t.colLength?n1t.colLength:n1t.ColLength,this._getDefault(d1t.colLength,N3t)),n1t.colLength2Byte=this._getDefault(void B1t !== n1t.colLength2Byte?n1t.colLength2Byte:n1t.ColLength2Byte,this._getDefault(d1t.colLength2Byte,!B1t)),n1t.emptyChar=this._getDefault(void B1t !== n1t.emptyChar?n1t.emptyChar:n1t.EmptyChar,this._getDefault(d1t.emptyChar,N6t)),n1t.fillRight=this._getDefault(void B1t !== n1t.fillRight?n1t.fillRight:n1t.FillRight,this._getDefault(d1t.fillRight,!B1t)),n1t.colLength);if((N3t != f1t && L6t != f1t && (j6t == (f1t=j6t == f1t.substring(B1t,b1t)?f1t.substring(b1t):f1t).substring(f1t.length - b1t) && (f1t=f1t.substring(B1t,f1t.length - b1t)),n1t.colLength=f1t),void B1t !== n1t.DialogType && (n1t.dialogType=n1t.DialogType),void B1t !== n1t.Action && (n1t.action=n1t.Action),void B1t !== n1t.LoadAction && (n1t.loadAction=n1t.LoadAction),void B1t !== n1t.DialogTheme && (n1t.dialogTheme=n1t.DialogTheme),void B1t !== n1t.DialogSheetTheme && (n1t.dialogSheetTheme=n1t.DialogSheetTheme),void B1t !== n1t.DisableSheet && (n1t.disableSheet=n1t.DisableSheet),void B1t !== n1t.CallBack && (n1t.callBack=n1t.CallBack),this._uploadDialogDelim=n1t.deli,this._uploadDialogLoadType=n1t.dialogType,n1t.action && E9t == typeof n1t.action?this._uploadDialogAction=n1t.action:this._uploadDialogAction=J3t,n1t.loadAction && E9t == typeof n1t.loadAction?this._uploadDialogLoadFile=n1t.loadAction:this._uploadDialogLoadFile=J3t,n1t.dialogTheme?this._uploadDialogTheme=n1t.dialogTheme:this._uploadDialogTheme=J3t,n1t.dialogSheetTheme?this._uploadDialogSheetTheme=n1t.dialogSheetTheme:this._uploadDialogSheetTheme=J3t,n1t.disableSheet?this._uploadDisableSheet=b1t:this._uploadDisableSheet=J3t,n1t.callBack && E9t == typeof n1t.callBack?this._uploadCallBack=n1t.callBack:this._uploadCallBack=J3t,this._autoExcelModeCheck(n1t,this.AutoExcelMode,r0t,!b1t,!b1t))){if((this.GetLoadColNames(p1t,n1t),d1t=this._getHeaderText(p1t),G1t=(f1t=this._getColInfo(n1t,p1t,!b1t)).name,c1t=f1t.saveName,U1t=f1t.type,S1t=f1t.format,f1t=f1t.datePattern,X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t+=this._makeColumnTag(B6t,n1t.DateStrictMode?b1t:B1t)) + this._makeColumnTag(b6t,n1t.append?b1t:B1t)) + this._makeColumnTag(t6t,n1t.unMatchColHidden)) + this._makeColumnTag(E6t,this.SearchMode)) + this._makeColumnTag(v6t,n1t.extendParam)) + this._makeColumnTag(F6t,p1t.length)) + this._makeColumnTag(a6t,this.getHeaderRows().length)) + this._makeColumnTag(W6t,n1t.startRow)) + this._makeColumnTag(H6t,n1t.endRow)) + this._makeColumnTag(e6t,n1t.startCol)) + this._makeColumnTag(h6t,n1t.workSheetNo)) + this._makeColumnTag(i6t,n1t.workSheetName)) + this._makeColumnTag(T6t,n1t.mode.replace(/ /g,N3t).toUpperCase())) + this._makeColumnTag(x6t,void B1t !== this.StatusCol?this.StatusCol:N3t)) + this._makeColumnTag(r6t,n1t.columnMapping)) + this._makeColumnTag(K6t,G1t)) + this._makeColumnTag(C6t,c1t)) + this._makeColumnTag(g6t,d1t)) + this._makeColumnTag(Q2t,G1t)) + this._makeColumnTag(l2t,U1t)) + this._makeColumnTag(M2t,S1t)) + this._makeColumnTag(D2t,f1t)) + this._makeColumnTag(V2t,this.id)) + this._makeColumnTag(w9Q,n1t.deli)) + this._makeColumnTag(J9Q,n1t.encoding)) + this._makeColumnTag(o2t,n1t.merge)) + this._makeColumnTag(z2t,this.UseJsonAttribute)) + this._makeColumnTag(I2t,n1t.serverFile),p1t=this._getDefault(this.Source.LoadExcel.Url,P2t),p1t=Q._ibsUtil.getFullPath(p1t),X1t+=this._makeColumnTag(R2t,p1t),E9t != typeof o.postMessage && G9t != typeof o.postMessage || (X1t+=this._makeColumnTag(k2t,this.id)),X1t=(X1t=(X1t=(X1t=(X1t=(X1t=(X1t+=this._makeColumnTag(y2t,n1t.useDOM?b1t:B1t)) + this._makeColumnTag(P9Q,n1t.colLength)) + this._makeColumnTag(R9Q,n1t.colLength2Byte?b1t:B1t)) + this._makeColumnTag(k9Q,n1t.emptyChar)) + this._makeColumnTag(y9Q,n1t.fillRight?b1t:B1t)) + this._makeColumnTag(f9Q,n1t.cutText?b1t:B1t)) + this._makeColumnTag(q2t,n1t.skipEmptyRow?b1t:B1t),n1t.debugMode || n1t.DebugMode))return X1t;this._makeLoadForm(r0t,!b1t,n1t.fileExt,X1t,n1t.maxFileSize,n1t.serverFile,n1t.sendParam);}},M.mUnMatchColHidden=function(j1t){for(var N1t=j1t.split(j6t),s1t=b1t;s1t < N1t.length;s1t++)B1t == this.GetColHidden(N1t[s1t]) && this.SetColHidden(N1t[s1t],!B1t);},M.ShowAlert=function(L1t,O1t,Z1t,A1t){var s9Q="Ok";var m1t=this;return this.MessageShowLevel && v3t !== this.MessageShowLevel || v3t === O1t?(this.AlertProgress=b1t,v3t != O1t && IBSheet.OnDebugMsg && IBSheet.OnDebugMsg(this,L1t,O1t),this.ShowMsgMode?Z1t?confirm(L1t)?(this.AlertProgress=B1t,!(this._invalidInputActionProc=B1t)):(this.AlertProgress=B1t,this._invalidInputActionProc=B1t,!b1t):void setTimeout(function(){(alert(L1t),E9t == typeof A1t && A1t(m1t),m1t.AlertProgress=B1t);},F1t):(IBSheet.OnMessage?IBSheet.OnMessage(this,L1t,O1t,Z1t):this.showMessageTime(L1t,B1t,J3t,[s9Q]),this.ConfirmInfo?(this.ConfirmInfo=B1t,this.AlertProgress=B1t,!(this._invalidInputActionProc=B1t)):(this.AlertProgress=B1t,this._invalidInputActionProc=B1t,!b1t))):-b1t;},P=M,(B1t,Q.__.each)([{from:N9Q,to:j9Q},{from:L9Q,to:O9Q},{from:m9Q,to:Z9Q},{from:A9Q,to:Y9Q},{from:B9Q,to:b9Q},{from:t9Q,to:E9Q},{from:v9Q,to:F9Q},{from:u9Q,to:a9Q},{from:W9Q,to:H9Q},{from:e9Q,to:h9Q},{from:i9Q,to:T9Q},{from:x9Q,to:r9Q},{from:K9Q,to:C9Q},{from:g9Q,to:Q6Q},{from:l6Q,to:M6Q},{from:D6Q,to:V6Q},{from:o6Q,to:z6Q},{from:B5t,to:I6Q},{from:b5t,to:q6Q},{from:y3Q,to:w6Q},{from:J6Q,to:P6Q},{from:n3Q,to:R6Q},{from:t5t,to:k6Q},{from:d3Q,to:y6Q},{from:n6Q,to:X6Q},{from:v5t,to:f6Q},{from:i3Q,to:d6Q},{from:p6Q,to:G6Q},{from:c6Q,to:U6Q},{from:S6Q,to:s6Q},{from:N6Q,to:j6Q},{from:L6Q,to:O6Q},{from:m6Q,to:Z6Q},{from:A6Q,to:Y6Q},{from:B6Q,to:b6Q},{from:t6Q,to:E6Q},{from:v6Q,to:F6Q},{from:u6Q,to:a6Q},{from:W6Q,to:H6Q},{from:e6Q,to:h6Q},{from:i6Q,to:T6Q},{from:x6Q,to:r6Q},{from:K6Q,to:C6Q},{from:n2t,to:g6Q},{from:Q2Q,to:l2Q},{from:M2Q,to:D2Q},{from:V2Q,to:o2Q},{from:z2Q,to:I2Q}],function(Y1t){P[Y1t.to]=P[Y1t.from];}));})(window,document);